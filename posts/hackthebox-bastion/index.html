<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="HackTheBox: Bastion" /><meta property="og:locale" content="en" /><meta name="description" content="Recon" /><meta property="og:description" content="Recon" /><link rel="canonical" href="https://megawattsec.com/posts/hackthebox-bastion/" /><meta property="og:url" content="https://megawattsec.com/posts/hackthebox-bastion/" /><meta property="og:site_name" content="MegaWattSec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-08-05T16:16:05-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox: Bastion" /><meta name="twitter:site" content="@megawattsec" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-12T15:06:06-04:00","datePublished":"2019-08-05T16:16:05-04:00","description":"Recon","headline":"HackTheBox: Bastion","mainEntityOfPage":{"@type":"WebPage","@id":"https://megawattsec.com/posts/hackthebox-bastion/"},"url":"https://megawattsec.com/posts/hackthebox-bastion/"}</script><title>HackTheBox: Bastion | MegaWattSec</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="MegaWattSec"><meta name="application-name" content="MegaWattSec"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/jamack_close.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">MegaWattSec</a></div><div class="site-subtitle font-italic">Adventures of a Forever-Newb</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/megawattsec" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/megawattsec" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['megawattsec','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox: Bastion</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackTheBox: Bastion</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/megawattsec">Dustin</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1565036165" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2019-08-05 </em> </span> <span> Updated <em class="timeago" data-ts="1652382366" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-12 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2011 words"> <em>11 min</em> read</span></div></div></div><div class="post-content"><h2 id="recon"><span class="mr-2">Recon</span><a href="#recon" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="port-scan"><span class="mr-2"><strong>Port scan</strong></span><a href="#port-scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img class="alignnone wp-image-73" data-src="/assets/img/2019/07/2019-07-23_16h26_58.png" data-proofer-ignore></p><p>Jumping into this box with a basic NMAP scan shows us a couple of interesting things. First, the SSH server, but that’s pretty normal for HTB boxes. I tried to log into it with anonymous credentials, but that didn’t work out. The most important thing to pick up on from the scan is that it’s likely a Windows machine with NetBIOS and SMB shares, due to the ports 135,139, and 445. Port 135 had several well-known vulnerabilities plague it over the years, so maybe it could be vulnerable to one on this box. Also, there have been vulnerabilities for SMB, like the famous EternalBlue. So we could run some exploit tests against those ports just in case…</p><p> </p><h2 id="initial-foothold"><span class="mr-2">Initial Foothold</span><a href="#initial-foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="exploit-checks"><span class="mr-2"><strong>Exploit Checks</strong></span><a href="#exploit-checks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>I didn’t find anything useful for RPC exploits, but did find some for the EternalBlue SMB exploit.</p><p><img class="alignnone wp-image-79" data-src="/assets/img/2019/07/search_eternalblue.png" data-proofer-ignore></p><p>Then I made another search, this time on “ms17-010”, the vulnerability CVE code.</p><p><img class="alignnone wp-image-81" data-src="/assets/img/2019/08/search_ms17-010.png" data-proofer-ignore></p><p>Then I ran the exploit …</p><p><img class="alignnone wp-image-82" data-src="/assets/img/2019/08/run_ms17-010.png" data-proofer-ignore></p><p>But no dice… the exploit path is probably a bust, so I moved on from wasting any more time on that approach.</p><p> </p><h3 id="smb-guest-access"><span class="mr-2">SMB Guest Access</span><a href="#smb-guest-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Then I tried the easy thing that should have been done first: connect to SMB without credentials.</p><p><img class="alignnone wp-image-84" data-src="/assets/img/2019/08/smb_fileexplorer.png" data-proofer-ignore></p><p>I tried first connecting with the file explorer in kali, but it wouldn’t accept a connection without credentials. So I tried smbmap next.</p><p><img class="alignnone wp-image-85" data-src="/assets/img/2019/08/smb_smbmap.png" data-proofer-ignore></p><p>That also didn’t work, but maybe I was just using it wrong. Either way, I moved on to trying smbclient.</p><p><img class="alignnone wp-image-86" data-src="/assets/img/2019/08/smb_smbclient.png" data-proofer-ignore></p><p>Finally I was getting somewhere, I could see the shares listed on the SMB service!</p><p>So then I used smbclient to log in and went exploring…</p><p><img class="alignnone wp-image-87" data-src="/assets/img/2019/08/smb_explore.png" data-proofer-ignore></p><p>After looking at all the folders, the only interesting one is WindowsImageBackup. Also there is a warning about downloading the entire backup file:</p><p><img class="alignnone wp-image-88" data-src="/assets/img/2019/08/smb_warning.png" data-proofer-ignore></p><p>After digging into the “Backups” share, I found a WindowsImageBackup with two VHD files.</p><p><img class="alignnone wp-image-89" data-src="/assets/img/2019/08/backup_vhd_listing.png" data-proofer-ignore></p><p>I don’t often listen to signs well, so I proceeded to download the VHDs anyway, but it disconnected the session pretty quickly.</p><p><img class="alignnone wp-image-90" data-src="/assets/img/2019/08/backup_disconnect.png" data-proofer-ignore></p><p> </p><h2 id="search-for-user"><span class="mr-2">Search For User</span><a href="#search-for-user" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="getting-into-the-vhd"><span class="mr-2">Getting Into the VHD</span><a href="#getting-into-the-vhd" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Reading just a little in the forums led to a hint from L4mpje that the VHD files can be opened remotely.</p><p>Initial googling led to opening VHD files with native windows disk management, but that wound require making a windows VM, or opening my host machine to a network full of hackers, so I decided to keep searching…</p><p>Eventually found an article explaining how to open VHD files remotely from linux, perfectly fitting the task at hand<br /> <a href="https://medium.com/@klockw3rk/mounting-vhd-file-on-kali-linux-through-remote-share-f2f9542c1f25">https://medium.com/@klockw3rk/mounting-vhd-file-on-kali-linux-through-remote-share-f2f9542c1f25</a></p><p><code class="language-plaintext highlighter-rouge">mount -t cifs //10.10.10.134/Backups /mnt/remote -o ro</code></p><p>That is the command explained in the article above, and it allowed me to mount the remote SMB share to a local folder…</p><p><img class="alignnone wp-image-91" data-src="/assets/img/2019/08/backups_mounted.png" data-proofer-ignore></p><p>… where I could see and access the VHD files directly! Awesome way to do things and I’ll definitely be keeping notes on this method.</p><p>Another cool technique is to seperately mount the VHD files to another folder and explore inside, using the local shell!</p><p>I first opened the smaller VHD, but it turned out to be a system boot partition, so then I opened the larger one to find the next clue.</p><p><img class="alignnone wp-image-92" data-src="/assets/img/2019/08/backups_vhd_opened.png" data-proofer-ignore></p><p> </p><h3 id="extracting-the-secret-sauce"><span class="mr-2">Extracting the Secret Sauce</span><a href="#extracting-the-secret-sauce" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>From here I just explored for a looooong time, looking and prodding at everything.</p><p>Eventually looked into opening the Registry and extracting passwords.</p><p>Tried mimikatz, but it didn’t run in kali well.<br /> Tried a tool to open the registry like a filesystem and poke around, that didn’t work.<br /> Eventually found pwdump from the creddump package that works the best:</p><p><img class="alignnone wp-image-93" data-src="/assets/img/2019/08/vhd_pwdump.png" data-proofer-ignore></p><p>I knew there were some programs for cracking these hashes with dictionary files, hashcat being one I’ve used before and also John the Ripper.</p><p>From reading some of the forums to get hints previously, I noticed people talking about “John”, so I guessed JtR would be the way to go. I wasn’t sure what type of hash to put in, and instead of letting john go through them all I looked up the possibilities and tried some until I got it right.</p><p>To get the available formats for John, use:</p><p><code class="language-plaintext highlighter-rouge">john -list=formats</code></p><p>This is the result of the password cracking:</p><p><img class="alignnone wp-image-94" data-src="/assets/img/2019/08/vhd_john.png" data-proofer-ignore></p><p>Awesome, a user password for L4mpje!!!  bureaulampje</p><p><img class="alignnone wp-image-95" data-src="/assets/img/2019/08/ssh_user.png" data-proofer-ignore></p><p>Using the credentials found in the Registry, I logged into the SSH and the flag is in the Desktop folder.</p><p> </p><h2 id="the-search-for-root"><span class="mr-2">The Search for Root</span><a href="#the-search-for-root" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="first-clues"><span class="mr-2">First Clues</span><a href="#first-clues" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>With the user flag found and a live login to the box, I searched around the files and folders for an hour or more. Just poking and prodding.</p><p>When reading the forum for clues, several people said to look for a program that seems out of place:</p><p><img class="alignnone wp-image-98" data-src="/assets/img/2019/08/ssh_program_files.png" data-proofer-ignore></p><p>Nothing really out of place there, how about the x86 program files:</p><p><img class="alignnone wp-image-99" data-src="/assets/img/2019/08/ssh_x86_program_files.png" data-proofer-ignore></p><p>Bingo! mRemoteNG looks pretty out of place! I’ve used this software before, so I know that it stores connections to things, which necessarily includes the passwords. Maybe there’s some passwords we can retrieve.</p><h3 id="mremoteng"><span class="mr-2">mRemoteNG</span><a href="#mremoteng" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>This is the directory listing for mRemoteNG:</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text">l4mpje@BASTION C:\Program Files (x86)\mRemoteNG&gt;dir                             
 Volume in drive C has no label.                                                
 Volume Serial Number is 0CB3-C487                                              

 Directory of C:\Program Files (x86)\mRemoteNG                                  

22-02-2019  15:01    &lt;DIR&gt;          .                                           
22-02-2019  15:01    &lt;DIR&gt;          ..                                          
18-10-2018  23:31            36.208 ADTree.dll                                  
18-10-2018  23:31           346.992 AxInterop.MSTSCLib.dll                      
18-10-2018  23:31            83.824 AxInterop.WFICALib.dll                      
18-10-2018  23:31         2.243.440 BouncyCastle.Crypto.dll                     
18-10-2018  23:30            71.022 Changelog.txt                               
18-10-2018  23:30             3.224 Credits.txt                                 
22-02-2019  15:01    &lt;DIR&gt;          cs-CZ                                       
22-02-2019  15:01    &lt;DIR&gt;          de                                          
22-02-2019  15:01    &lt;DIR&gt;          el                                          
22-02-2019  15:01    &lt;DIR&gt;          en-US                                       
22-02-2019  15:01    &lt;DIR&gt;          es                                          
22-02-2019  15:01    &lt;DIR&gt;          es-AR                                       
22-02-2019  15:01    &lt;DIR&gt;          Firefox                                     
22-02-2019  15:01    &lt;DIR&gt;          fr                                          
18-10-2018  23:31         1.966.960 Geckofx-Core.dll                            
05-07-2017  01:31         4.482.560 Geckofx-Core.pdb                            
18-10-2018  23:31           143.728 Geckofx-Winforms.dll                        
05-07-2017  01:31           259.584 Geckofx-Winforms.pdb                        
22-02-2019  15:01    &lt;DIR&gt;          Help                                        
22-02-2019  15:01    &lt;DIR&gt;          hu                                          
22-02-2019  15:01    &lt;DIR&gt;          Icons                                       
18-10-2018  23:31           607.088 Interop.MSTSCLib.dll                        
18-10-2018  23:31           131.440 Interop.WFICALib.dll                        
22-02-2019  15:01    &lt;DIR&gt;          it                                          
22-02-2019  15:01    &lt;DIR&gt;          ja-JP                                       
22-02-2019  15:01    &lt;DIR&gt;          ko-KR                                       
07-10-2018  13:21            18.326 License.txt                                 
18-10-2018  23:31           283.504 log4net.dll                                 
18-10-2018  23:31           412.528 MagicLibrary.dll                            
18-10-2018  23:31         1.552.240 mRemoteNG.exe                               
07-10-2018  13:21            28.317 mRemoteNG.exe.config                        
18-10-2018  23:30         2.405.888 mRemoteNG.pdb                               
22-02-2019  15:01    &lt;DIR&gt;          nb-NO                                       
22-02-2019  15:01    &lt;DIR&gt;          nl                                          
18-10-2018  23:31           451.952 ObjectListView.dll                          
22-02-2019  15:01    &lt;DIR&gt;          pl                                          
22-02-2019  15:01    &lt;DIR&gt;          pt                                          
22-02-2019  15:01    &lt;DIR&gt;          pt-BR                                       
07-10-2018  13:21           707.952 PuTTYNG.exe                                 
07-10-2018  13:21               887 Readme.txt                                  
18-10-2018  23:31           415.088 Renci.SshNet.dll                            
22-02-2019  15:01    &lt;DIR&gt;          ru                                          
22-02-2019  15:01    &lt;DIR&gt;          Schemas                                     
22-02-2019  15:01    &lt;DIR&gt;          Themes                                      
22-02-2019  15:01    &lt;DIR&gt;          tr-TR                                       
22-02-2019  15:01    &lt;DIR&gt;          uk                                          
18-10-2018  23:31           152.432 VncSharp.dll                                
18-10-2018  23:31           312.176 WeifenLuo.WinFormsUI.Docking.dll            
18-10-2018  23:31            55.152 WeifenLuo.WinFormsUI.Docking.ThemeVS2003.dll
18-10-2018  23:31           168.816 WeifenLuo.WinFormsUI.Docking.ThemeVS2012.dll
18-10-2018  23:31           217.968 WeifenLuo.WinFormsUI.Docking.ThemeVS2013.dll
18-10-2018  23:31           243.056 WeifenLuo.WinFormsUI.Docking.ThemeVS2015.dll
22-02-2019  15:01    &lt;DIR&gt;          zh-CN                                       
22-02-2019  15:01    &lt;DIR&gt;          zh-TW                                       
              28 File(s)     17.802.352 bytes                                   
              28 Dir(s)  11.376.021.504 bytes free                              </code></pre></figure><p>After looking at the mRemoteNG.exe.config, there wasn’t anyting obviously useful to me. So I looked in the program data folders.</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text">l4mpje@BASTION C:\Program Files (x86)\mRemoteNG&gt;dir C:\ProgramData              
 Volume in drive C has no label.                                                
 Volume Serial Number is 0CB3-C487                                              

 Directory of C:\ProgramData                                                    

16-07-2016  15:23    &lt;DIR&gt;          Comms                                       
22-02-2019  13:36    &lt;DIR&gt;          regid.1991-06.com.microsoft                 
16-07-2016  15:23    &lt;DIR&gt;          SoftwareDistribution                        
25-04-2019  06:08    &lt;DIR&gt;          ssh                                         
12-09-2016  13:37    &lt;DIR&gt;          USOPrivate                                  
12-09-2016  13:37    &lt;DIR&gt;          USOShared                                   
16-04-2019  12:18    &lt;DIR&gt;          VMware                                      
               0 File(s)              0 bytes                                   
               7 Dir(s)  11.374.854.144 bytes free</code></pre></figure><p>Nope, nothing there either.</p><p>And in AppData\Local\mRemoteNG there is only one file, user.config</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml">l4mpje@BASTION C:\Users\L4mpje\AppData\Local\mRemoteNG\mRemoteNG.exe_Url_pjpxdeh
xpaaorqg2thmuhl11a34i3ave\1.76.11.40527&gt;type user.config                        
<span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>                                          
<span class="nt">&lt;configuration&gt;</span>                                                                 
    <span class="nt">&lt;userSettings&gt;</span>                                                              
        <span class="nt">&lt;mRemoteNG.Settings&gt;</span>                                                    
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"MainFormLocation"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>              
                <span class="nt">&lt;value&gt;</span>-8, -8<span class="nt">&lt;/value&gt;</span>                                           
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"MainFormSize"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>                  
                <span class="nt">&lt;value&gt;</span>1040, 744<span class="nt">&lt;/value&gt;</span>                                        
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"MainFormState"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>                 
                <span class="nt">&lt;value&gt;</span>Maximized<span class="nt">&lt;/value&gt;</span>                                        
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"MainFormKiosk"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>                 
                <span class="nt">&lt;value&gt;</span>False<span class="nt">&lt;/value&gt;</span>                                            
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"DoUpgrade"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>                     
                <span class="nt">&lt;value&gt;</span>False<span class="nt">&lt;/value&gt;</span>                                            
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"LoadConsFromCustomLocation"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>    
                <span class="nt">&lt;value&gt;</span>False<span class="nt">&lt;/value&gt;</span>                                            
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"FirstStart"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>                    
                <span class="nt">&lt;value&gt;</span>False<span class="nt">&lt;/value&gt;</span>                                            
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"ResetPanels"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>                   
                <span class="nt">&lt;value&gt;</span>False<span class="nt">&lt;/value&gt;</span>                                            
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"NoReconnect"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>                   
                <span class="nt">&lt;value&gt;</span>False<span class="nt">&lt;/value&gt;</span>                                            
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"ExtAppsTBVisible"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>              
                <span class="nt">&lt;value&gt;</span>False<span class="nt">&lt;/value&gt;</span>                                            
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"ExtAppsTBShowText"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>             
                <span class="nt">&lt;value&gt;</span>True<span class="nt">&lt;/value&gt;</span>                                             
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"ExtAppsTBLocation"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>             
                <span class="nt">&lt;value&gt;</span>3, 25<span class="nt">&lt;/value&gt;</span>                                            
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"ExtAppsTBParentDock"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>           
                <span class="nt">&lt;value&gt;</span>Bottom<span class="nt">&lt;/value&gt;</span>                                           
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"QuickyTBVisible"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>               
                <span class="nt">&lt;value&gt;</span>True<span class="nt">&lt;/value&gt;</span>                                             
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"QuickyTBLocation"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>              
                <span class="nt">&lt;value&gt;</span>3, 24<span class="nt">&lt;/value&gt;</span>                                            
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"QuickyTBParentDock"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>            
                <span class="nt">&lt;value&gt;</span>Top<span class="nt">&lt;/value&gt;</span>                                              
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"ResetToolbars"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>                 
                <span class="nt">&lt;value&gt;</span>False<span class="nt">&lt;/value&gt;</span>                                            
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"CheckForUpdatesAsked"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>          
                <span class="nt">&lt;value&gt;</span>True<span class="nt">&lt;/value&gt;</span>                                             
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"CheckForUpdatesLastCheck"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>      
                <span class="nt">&lt;value&gt;</span>02/22/2019 13:01:46<span class="nt">&lt;/value&gt;</span>                              
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"UpdatePending"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>                 
                <span class="nt">&lt;value&gt;</span>False<span class="nt">&lt;/value&gt;</span>                                            
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"ThemeName"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>                     
                <span class="nt">&lt;value&gt;</span>vs2015light<span class="nt">&lt;/value&gt;</span>                                      
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"PuttySavedSessionsPanel"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>       
                <span class="nt">&lt;value&gt;</span>General<span class="nt">&lt;/value&gt;</span>                                          
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"EncryptionEngine"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>              
                <span class="nt">&lt;value&gt;</span>AES<span class="nt">&lt;/value&gt;</span>                                              
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"EncryptionBlockCipherMode"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>     
                <span class="nt">&lt;value&gt;</span>GCM<span class="nt">&lt;/value&gt;</span>                                              
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"LogFilePath"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>                   
                <span class="nt">&lt;value&gt;</span>C:\Users\L4mpje\AppData\Roaming\mRemoteNG\mRemoteNG.log<span class="nt">&lt;/
value&gt;</span>                                                                          
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"MultiSshToolbarLocation"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>       
                <span class="nt">&lt;value&gt;</span>3, 0<span class="nt">&lt;/value&gt;</span>                                             
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"MultiSshToolbarParentDock"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>     
                <span class="nt">&lt;value&gt;</span>Top<span class="nt">&lt;/value&gt;</span>                                              
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"MultiSshToolbarVisible"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>        
                <span class="nt">&lt;value&gt;</span>False<span class="nt">&lt;/value&gt;</span>                                            
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"MainFormRestoreSize"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>           
                <span class="nt">&lt;value&gt;</span>1040, 610<span class="nt">&lt;/value&gt;</span>                                        
            <span class="nt">&lt;/setting&gt;</span>                                                          
            <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">"MainFormRestoreLocation"</span> <span class="na">serializeAs=</span><span class="s">"String"</span><span class="nt">&gt;</span>       
                <span class="nt">&lt;value&gt;</span>0, 156<span class="nt">&lt;/value&gt;</span>                                           
            <span class="nt">&lt;/setting&gt;</span>                                                          
        <span class="nt">&lt;/mRemoteNG.Settings&gt;</span>                                                   
    <span class="nt">&lt;/userSettings&gt;</span>                                                             
<span class="nt">&lt;/configuration&gt;</span>                                                        </code></pre></figure><p>That gave me the path of the log file, but nothing was really interesting in the log file itself. However, other things were in the AppData folder:</p><figure class="highlight"><pre><code class="language-plain_text" data-lang="plain_text">l4mpje@BASTION C:\Users\L4mpje\AppData\Roaming\mRemoteNG&gt;dir                    
 Volume in drive C has no label.                                                
 Volume Serial Number is 0CB3-C487                                              

 Directory of C:\Users\L4mpje\AppData\Roaming\mRemoteNG                         

22-02-2019  15:03    &lt;DIR&gt;          .                                           
22-02-2019  15:03    &lt;DIR&gt;          ..                                          
22-02-2019  15:03             6.316 confCons.xml                                
22-02-2019  15:02             6.194 confCons.xml.20190222-1402277353.backup     
22-02-2019  15:02             6.206 confCons.xml.20190222-1402339071.backup     
22-02-2019  15:02             6.218 confCons.xml.20190222-1402379227.backup     
22-02-2019  15:02             6.231 confCons.xml.20190222-1403070644.backup     
22-02-2019  15:03             6.319 confCons.xml.20190222-1403100488.backup     
22-02-2019  15:03             6.318 confCons.xml.20190222-1403220026.backup     
22-02-2019  15:03             6.315 confCons.xml.20190222-1403261268.backup     
22-02-2019  15:03             6.316 confCons.xml.20190222-1403272831.backup     
22-02-2019  15:03             6.315 confCons.xml.20190222-1403433299.backup     
22-02-2019  15:03             6.316 confCons.xml.20190222-1403486580.backup     
22-02-2019  15:03                51 extApps.xml                                 
22-02-2019  15:03             5.217 mRemoteNG.log                               
22-02-2019  15:03             2.245 pnlLayout.xml                               
22-02-2019  15:01    &lt;DIR&gt;          Themes                                      
              14 File(s)         76.577 bytes                                   
               3 Dir(s)  11.441.676.288 bytes free</code></pre></figure><p>confCons.xml looked particularly interesting. It was clearly important since it had all those backups.</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml">l4mpje@BASTION C:\Users\L4mpje\AppData\Roaming\mRemoteNG&gt;type confCons.xml      
<span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>                                          
<span class="nt">&lt;mrng:Connections</span> <span class="na">xmlns:mrng=</span><span class="s">"http://mremoteng.org"</span> <span class="na">Name=</span><span class="s">"Connections"</span> <span class="na">Export=</span><span class="s">"f
alse"</span> <span class="na">EncryptionEngine=</span><span class="s">"AES"</span> <span class="na">BlockCipherMode=</span><span class="s">"GCM"</span> <span class="na">KdfIterations=</span><span class="s">"1000"</span> <span class="err">FullFile</span>
<span class="na">Encryption=</span><span class="s">"false"</span> <span class="na">Protected=</span><span class="s">"ZSvKI7j224Gf/twXpaP5G2QFZMLr1iO1f5JKdtIKL6eUg+eWkL
5tKO886au0ofFPW0oop8R8ddXKAx4KK7sAk6AA"</span> <span class="na">ConfVersion=</span><span class="s">"2.6"</span><span class="nt">&gt;</span>                      
    <span class="nt">&lt;Node</span> <span class="na">Name=</span><span class="s">"DC"</span> <span class="na">Type=</span><span class="s">"Connection"</span> <span class="na">Descr=</span><span class="s">""</span> <span class="na">Icon=</span><span class="s">"mRemoteNG"</span> <span class="na">Panel=</span><span class="s">"General"</span> 
<span class="na">Id=</span><span class="s">"500e7d58-662a-44d4-aff0-3a4f547a3fee"</span> <span class="na">Username=</span><span class="s">"Administrator"</span> <span class="na">Domain=</span><span class="s">""</span> <span class="err">Pas</span>
<span class="na">sword=</span><span class="s">"aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7em
f7lWWA10dQKiw=="</span> <span class="na">Hostname=</span><span class="s">"127.0.0.1"</span> <span class="na">Protocol=</span><span class="s">"RDP"</span> <span class="na">PuttySession=</span><span class="s">"Default Setti
ngs"</span> <span class="na">Port=</span><span class="s">"3389"</span> <span class="na">ConnectToConsole=</span><span class="s">"false"</span> <span class="na">UseCredSsp=</span><span class="s">"true"</span> <span class="na">RenderingEngine=</span><span class="s">"IE"</span>
 <span class="na">ICAEncryptionStrength=</span><span class="s">"EncrBasic"</span> <span class="na">RDPAuthenticationLevel=</span><span class="s">"NoAuth"</span> <span class="err">RDPMinutesToI</span>
<span class="na">dleTimeout=</span><span class="s">"0"</span> <span class="na">RDPAlertIdleTimeout=</span><span class="s">"false"</span> <span class="na">LoadBalanceInfo=</span><span class="s">""</span> <span class="na">Colors=</span><span class="s">"Colors16Bi
t"</span> <span class="na">Resolution=</span><span class="s">"FitToWindow"</span> <span class="na">AutomaticResize=</span><span class="s">"true"</span> <span class="na">DisplayWallpaper=</span><span class="s">"false"</span> <span class="err">Disp</span>
<span class="na">layThemes=</span><span class="s">"false"</span> <span class="na">EnableFontSmoothing=</span><span class="s">"false"</span> <span class="na">EnableDesktopComposition=</span><span class="s">"false"</span> <span class="err">C</span>
<span class="na">acheBitmaps=</span><span class="s">"false"</span> <span class="na">RedirectDiskDrives=</span><span class="s">"false"</span> <span class="na">RedirectPorts=</span><span class="s">"false"</span> <span class="err">RedirectPri</span>
<span class="na">nters=</span><span class="s">"false"</span> <span class="na">RedirectSmartCards=</span><span class="s">"false"</span> <span class="na">RedirectSound=</span><span class="s">"DoNotPlay"</span> <span class="na">SoundQuality=</span>
<span class="s">"Dynamic"</span> <span class="na">RedirectKeys=</span><span class="s">"false"</span> <span class="na">Connected=</span><span class="s">"false"</span> <span class="na">PreExtApp=</span><span class="s">""</span> <span class="na">PostExtApp=</span><span class="s">""</span> <span class="err">MacA</span>
<span class="na">ddress=</span><span class="s">""</span> <span class="na">UserField=</span><span class="s">""</span> <span class="na">ExtApp=</span><span class="s">""</span> <span class="na">VNCCompression=</span><span class="s">"CompNone"</span> <span class="na">VNCEncoding=</span><span class="s">"EncHexti
le"</span> <span class="na">VNCAuthMode=</span><span class="s">"AuthVNC"</span> <span class="na">VNCProxyType=</span><span class="s">"ProxyNone"</span> <span class="na">VNCProxyIP=</span><span class="s">""</span> <span class="na">VNCProxyPort=</span><span class="s">"0
"</span> <span class="na">VNCProxyUsername=</span><span class="s">""</span> <span class="na">VNCProxyPassword=</span><span class="s">""</span> <span class="na">VNCColors=</span><span class="s">"ColNormal"</span> <span class="na">VNCSmartSizeMode
=</span><span class="s">"SmartSAspect"</span> <span class="na">VNCViewOnly=</span><span class="s">"false"</span> <span class="na">RDGatewayUsageMethod=</span><span class="s">"Never"</span> <span class="err">RDGatewayHostna</span>
<span class="na">me=</span><span class="s">""</span> <span class="na">RDGatewayUseConnectionCredentials=</span><span class="s">"Yes"</span> <span class="na">RDGatewayUsername=</span><span class="s">""</span> <span class="err">RDGatewayPass</span>
<span class="na">word=</span><span class="s">""</span> <span class="na">RDGatewayDomain=</span><span class="s">""</span> <span class="na">InheritCacheBitmaps=</span><span class="s">"false"</span> <span class="na">InheritColors=</span><span class="s">"false"</span> <span class="err">Inh</span>
<span class="na">eritDescription=</span><span class="s">"false"</span> <span class="na">InheritDisplayThemes=</span><span class="s">"false"</span> <span class="na">InheritDisplayWallpaper=</span><span class="s">"fa
lse"</span> <span class="na">InheritEnableFontSmoothing=</span><span class="s">"false"</span> <span class="na">InheritEnableDesktopComposition=</span><span class="s">"false"</span> 
<span class="na">InheritDomain=</span><span class="s">"false"</span> <span class="na">InheritIcon=</span><span class="s">"false"</span> <span class="na">InheritPanel=</span><span class="s">"false"</span> <span class="na">InheritPassword=</span><span class="s">"
false"</span> <span class="na">InheritPort=</span><span class="s">"false"</span> <span class="na">InheritProtocol=</span><span class="s">"false"</span> <span class="na">InheritPuttySession=</span><span class="s">"false"</span> <span class="err">I</span>
<span class="na">nheritRedirectDiskDrives=</span><span class="s">"false"</span> <span class="na">InheritRedirectKeys=</span><span class="s">"false"</span> <span class="err">InheritRedirectPort</span>
<span class="na">s=</span><span class="s">"false"</span> <span class="na">InheritRedirectPrinters=</span><span class="s">"false"</span> <span class="na">InheritRedirectSmartCards=</span><span class="s">"false"</span> <span class="err">Inhe</span>
<span class="na">ritRedirectSound=</span><span class="s">"false"</span> <span class="na">InheritSoundQuality=</span><span class="s">"false"</span> <span class="na">InheritResolution=</span><span class="s">"false"</span> <span class="err">I</span>
<span class="na">nheritAutomaticResize=</span><span class="s">"false"</span> <span class="na">InheritUseConsoleSession=</span><span class="s">"false"</span> <span class="na">InheritUseCredSsp
=</span><span class="s">"false"</span> <span class="na">InheritRenderingEngine=</span><span class="s">"false"</span> <span class="na">InheritUsername=</span><span class="s">"false"</span> <span class="err">InheritICAEncryp</span>
<span class="na">tionStrength=</span><span class="s">"false"</span> <span class="na">InheritRDPAuthenticationLevel=</span><span class="s">"false"</span> <span class="err">InheritRDPMinutesToId</span>
<span class="na">leTimeout=</span><span class="s">"false"</span> <span class="na">InheritRDPAlertIdleTimeout=</span><span class="s">"false"</span> <span class="na">InheritLoadBalanceInfo=</span><span class="s">"fal
se"</span> <span class="na">InheritPreExtApp=</span><span class="s">"false"</span> <span class="na">InheritPostExtApp=</span><span class="s">"false"</span> <span class="na">InheritMacAddress=</span><span class="s">"false"</span>
 <span class="na">InheritUserField=</span><span class="s">"false"</span> <span class="na">InheritExtApp=</span><span class="s">"false"</span> <span class="na">InheritVNCCompression=</span><span class="s">"false"</span> <span class="err">In</span>
<span class="na">heritVNCEncoding=</span><span class="s">"false"</span> <span class="na">InheritVNCAuthMode=</span><span class="s">"false"</span> <span class="na">InheritVNCProxyType=</span><span class="s">"false"</span> 
<span class="na">InheritVNCProxyIP=</span><span class="s">"false"</span> <span class="na">InheritVNCProxyPort=</span><span class="s">"false"</span> <span class="na">InheritVNCProxyUsername=</span><span class="s">"f
alse"</span> <span class="na">InheritVNCProxyPassword=</span><span class="s">"false"</span> <span class="na">InheritVNCColors=</span><span class="s">"false"</span> <span class="err">InheritVNCSmartSi</span>
<span class="na">zeMode=</span><span class="s">"false"</span> <span class="na">InheritVNCViewOnly=</span><span class="s">"false"</span> <span class="na">InheritRDGatewayUsageMethod=</span><span class="s">"false"</span> <span class="err">In</span>
<span class="na">heritRDGatewayHostname=</span><span class="s">"false"</span> <span class="na">InheritRDGatewayUseConnectionCredentials=</span><span class="s">"false"</span> 
<span class="na">InheritRDGatewayUsername=</span><span class="s">"false"</span> <span class="na">InheritRDGatewayPassword=</span><span class="s">"false"</span> <span class="err">InheritRDGatew</span>
<span class="na">ayDomain=</span><span class="s">"false"</span> <span class="nt">/&gt;</span>                                                             
    <span class="nt">&lt;Node</span> <span class="na">Name=</span><span class="s">"L4mpje-PC"</span> <span class="na">Type=</span><span class="s">"Connection"</span> <span class="na">Descr=</span><span class="s">""</span> <span class="na">Icon=</span><span class="s">"mRemoteNG"</span> <span class="na">Panel=</span><span class="s">"Ge
neral"</span> <span class="na">Id=</span><span class="s">"8d3579b2-e68e-48c1-8f0f-9ee1347c9128"</span> <span class="na">Username=</span><span class="s">"L4mpje"</span> <span class="na">Domain=</span><span class="s">""</span> <span class="err">Pas</span>
<span class="na">sword=</span><span class="s">"yhgmiu5bbuamU3qMUKc/uYDdmbMrJZ/JvR1kYe4Bhiu8bXybLxVnO0U9fKRylI7NcB9QuRsZV
vla8esB"</span> <span class="na">Hostname=</span><span class="s">"192.168.1.75"</span> <span class="na">Protocol=</span><span class="s">"RDP"</span> <span class="na">PuttySession=</span><span class="s">"Default Settings"</span> 
<span class="na">Port=</span><span class="s">"3389"</span> <span class="na">ConnectToConsole=</span><span class="s">"false"</span> <span class="na">UseCredSsp=</span><span class="s">"true"</span> <span class="na">RenderingEngine=</span><span class="s">"IE"</span> <span class="err">ICAE</span>
<span class="na">ncryptionStrength=</span><span class="s">"EncrBasic"</span> <span class="na">RDPAuthenticationLevel=</span><span class="s">"NoAuth"</span> <span class="err">RDPMinutesToIdleTi</span>
<span class="na">meout=</span><span class="s">"0"</span> <span class="na">RDPAlertIdleTimeout=</span><span class="s">"false"</span> <span class="na">LoadBalanceInfo=</span><span class="s">""</span> <span class="na">Colors=</span><span class="s">"Colors16Bit"</span> <span class="err">Re</span>
<span class="na">solution=</span><span class="s">"FitToWindow"</span> <span class="na">AutomaticResize=</span><span class="s">"true"</span> <span class="na">DisplayWallpaper=</span><span class="s">"false"</span> <span class="err">DisplayTh</span>
<span class="na">emes=</span><span class="s">"false"</span> <span class="na">EnableFontSmoothing=</span><span class="s">"false"</span> <span class="na">EnableDesktopComposition=</span><span class="s">"false"</span> <span class="err">CacheB</span>
<span class="na">itmaps=</span><span class="s">"false"</span> <span class="na">RedirectDiskDrives=</span><span class="s">"false"</span> <span class="na">RedirectPorts=</span><span class="s">"false"</span> <span class="na">RedirectPrinters
=</span><span class="s">"false"</span> <span class="na">RedirectSmartCards=</span><span class="s">"false"</span> <span class="na">RedirectSound=</span><span class="s">"DoNotPlay"</span> <span class="na">SoundQuality=</span><span class="s">"Dyna
mic"</span> <span class="na">RedirectKeys=</span><span class="s">"false"</span> <span class="na">Connected=</span><span class="s">"false"</span> <span class="na">PreExtApp=</span><span class="s">""</span> <span class="na">PostExtApp=</span><span class="s">""</span> <span class="err">MacAddres</span>
<span class="na">s=</span><span class="s">""</span> <span class="na">UserField=</span><span class="s">""</span> <span class="na">ExtApp=</span><span class="s">""</span> <span class="na">VNCCompression=</span><span class="s">"CompNone"</span> <span class="na">VNCEncoding=</span><span class="s">"EncHextile"</span> <span class="err">V</span>
<span class="na">NCAuthMode=</span><span class="s">"AuthVNC"</span> <span class="na">VNCProxyType=</span><span class="s">"ProxyNone"</span> <span class="na">VNCProxyIP=</span><span class="s">""</span> <span class="na">VNCProxyPort=</span><span class="s">"0"</span> <span class="err">VNC</span>
<span class="na">ProxyUsername=</span><span class="s">""</span> <span class="na">VNCProxyPassword=</span><span class="s">""</span> <span class="na">VNCColors=</span><span class="s">"ColNormal"</span> <span class="na">VNCSmartSizeMode=</span><span class="s">"Sma
rtSAspect"</span> <span class="na">VNCViewOnly=</span><span class="s">"false"</span> <span class="na">RDGatewayUsageMethod=</span><span class="s">"Never"</span> <span class="na">RDGatewayHostname=</span><span class="s">""</span>
 <span class="na">RDGatewayUseConnectionCredentials=</span><span class="s">"Yes"</span> <span class="na">RDGatewayUsername=</span><span class="s">""</span> <span class="na">RDGatewayPassword=</span>
<span class="s">""</span> <span class="na">RDGatewayDomain=</span><span class="s">""</span> <span class="na">InheritCacheBitmaps=</span><span class="s">"false"</span> <span class="na">InheritColors=</span><span class="s">"false"</span> <span class="err">InheritD</span>
<span class="na">escription=</span><span class="s">"false"</span> <span class="na">InheritDisplayThemes=</span><span class="s">"false"</span> <span class="na">InheritDisplayWallpaper=</span><span class="s">"false"</span> 
<span class="na">InheritEnableFontSmoothing=</span><span class="s">"false"</span> <span class="na">InheritEnableDesktopComposition=</span><span class="s">"false"</span> <span class="err">Inher</span>
<span class="na">itDomain=</span><span class="s">"false"</span> <span class="na">InheritIcon=</span><span class="s">"false"</span> <span class="na">InheritPanel=</span><span class="s">"false"</span> <span class="na">InheritPassword=</span><span class="s">"false
"</span> <span class="na">InheritPort=</span><span class="s">"false"</span> <span class="na">InheritProtocol=</span><span class="s">"false"</span> <span class="na">InheritPuttySession=</span><span class="s">"false"</span> <span class="err">Inheri</span>
<span class="na">tRedirectDiskDrives=</span><span class="s">"false"</span> <span class="na">InheritRedirectKeys=</span><span class="s">"false"</span> <span class="na">InheritRedirectPorts=</span><span class="s">"fa
lse"</span> <span class="na">InheritRedirectPrinters=</span><span class="s">"false"</span> <span class="na">InheritRedirectSmartCards=</span><span class="s">"false"</span> <span class="err">InheritRe</span>
<span class="na">directSound=</span><span class="s">"false"</span> <span class="na">InheritSoundQuality=</span><span class="s">"false"</span> <span class="na">InheritResolution=</span><span class="s">"false"</span> <span class="err">Inheri</span>
<span class="na">tAutomaticResize=</span><span class="s">"false"</span> <span class="na">InheritUseConsoleSession=</span><span class="s">"false"</span> <span class="na">InheritUseCredSsp=</span><span class="s">"fal
se"</span> <span class="na">InheritRenderingEngine=</span><span class="s">"false"</span> <span class="na">InheritUsername=</span><span class="s">"false"</span> <span class="err">InheritICAEncryptionS</span>
<span class="na">trength=</span><span class="s">"false"</span> <span class="na">InheritRDPAuthenticationLevel=</span><span class="s">"false"</span> <span class="err">InheritRDPMinutesToIdleTim</span>
<span class="na">eout=</span><span class="s">"false"</span> <span class="na">InheritRDPAlertIdleTimeout=</span><span class="s">"false"</span> <span class="na">InheritLoadBalanceInfo=</span><span class="s">"false"</span> <span class="err">I</span>
<span class="na">nheritPreExtApp=</span><span class="s">"false"</span> <span class="na">InheritPostExtApp=</span><span class="s">"false"</span> <span class="na">InheritMacAddress=</span><span class="s">"false"</span> <span class="err">Inhe</span>
<span class="na">ritUserField=</span><span class="s">"false"</span> <span class="na">InheritExtApp=</span><span class="s">"false"</span> <span class="na">InheritVNCCompression=</span><span class="s">"false"</span> <span class="err">Inherit</span>
<span class="na">VNCEncoding=</span><span class="s">"false"</span> <span class="na">InheritVNCAuthMode=</span><span class="s">"false"</span> <span class="na">InheritVNCProxyType=</span><span class="s">"false"</span> <span class="err">Inher</span>
<span class="na">itVNCProxyIP=</span><span class="s">"false"</span> <span class="na">InheritVNCProxyPort=</span><span class="s">"false"</span> <span class="na">InheritVNCProxyUsername=</span><span class="s">"false"</span>
 <span class="na">InheritVNCProxyPassword=</span><span class="s">"false"</span> <span class="na">InheritVNCColors=</span><span class="s">"false"</span> <span class="err">InheritVNCSmartSizeMod</span>
<span class="na">e=</span><span class="s">"false"</span> <span class="na">InheritVNCViewOnly=</span><span class="s">"false"</span> <span class="na">InheritRDGatewayUsageMethod=</span><span class="s">"false"</span> <span class="err">Inherit</span>
<span class="na">RDGatewayHostname=</span><span class="s">"false"</span> <span class="na">InheritRDGatewayUseConnectionCredentials=</span><span class="s">"false"</span> <span class="err">Inher</span>
<span class="na">itRDGatewayUsername=</span><span class="s">"false"</span> <span class="na">InheritRDGatewayPassword=</span><span class="s">"false"</span> <span class="err">InheritRDGatewayDom</span>
<span class="na">ain=</span><span class="s">"false"</span> <span class="nt">/&gt;</span>                                                                  
<span class="nt">&lt;/mrng:Connections&gt;</span>                            </code></pre></figure><p>On close inspection I could see there was a connection defined for L4mpje, and another for Administrator. The Administrator password is what we want, but it’s encrypted.</p><p>We’re given encryption details at the beginning of the file. One possible option is to take those details and try to decrypt it. But I don’t want to do that if we can get mRemoteNG to do the decryption for us.</p><p>The forum posts suggested Google had the answers once we discovered which software was out of place. I found that an external command can be made  that will display the decrypted password!!!</p><p>If you download the Zip version instead of installer, everything stays in the same folder, so it’ll be a little easier to manipulate. To get the connection details into mRemoteNG, copy the text that was extracted from the SSH session into an xml file and save it as confCons.xml.</p><p>After copying the text, saving it, and opening mRemoteNG, I got an error:</p><p><img class="alignnone wp-image-100" data-src="/assets/img/2019/08/mremoteng_error.png" data-proofer-ignore><br /> Turns out a straight copy of the text from the shell resulted in data not formed well, so I had to clean up the XML and reload. After that it worked great.</p><p>Then the external tools script could be put in to extract the password.</p><p><img class="alignnone wp-image-101 size-full" data-src="/assets/img/2019/08/mremoteng_showpass.png" data-proofer-ignore></p><p>Admin password found!! With that you can log into the SSH with Administrator and grab the root flag!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/walkthrough/'>Walkthrough</a>, <a href='/categories/hackthebox/'>HackTheBox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/smb/" class="post-tag no-text-decoration" >smb</a> <a href="/tags/vhd/" class="post-tag no-text-decoration" >vhd</a> <a href="/tags/mremoteng/" class="post-tag no-text-decoration" >mRemoteNG</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >Windows</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox: Bastion - MegaWattSec&amp;url=https://megawattsec.com/posts/hackthebox-bastion/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox: Bastion - MegaWattSec&amp;u=https://megawattsec.com/posts/hackthebox-bastion/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://megawattsec.com/posts/hackthebox-bastion/&amp;text=HackTheBox: Bastion - MegaWattSec" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/hackthebox-haystack/">HackTheBox: Haystack</a><li><a href="/posts/hackthebox-craft/">HackTheBox: Craft</a><li><a href="/posts/hackthebox-bastion/">HackTheBox: Bastion</a><li><a href="/posts/hackthebox-jarvis/">HackTheBox: Jarvis</a><li><a href="/posts/hackthebox-swagshop/">HackTheBox: SwagShop</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/perl/">perl</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/anti-csrf/">anti-csrf</a> <a class="post-tag" href="/tags/api/">api</a> <a class="post-tag" href="/tags/cve-2019-9185/">CVE-2019-9185</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/hackthebox-haystack/"><div class="card-body"> <em class="timeago small" data-ts="1569939718" > 2019-10-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox: Haystack</h3><div class="text-muted small"><p> Scans {% highlight plain_text %} Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-01 09:16 EDT Nmap scan report for 10.10.10.115 Host is up, received user-set (0.24s latency). PORT STATE SERVIC...</p></div></div></a></div><div class="card"> <a href="/posts/hackthebox-craft/"><div class="card-body"> <em class="timeago small" data-ts="1575921294" > 2019-12-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox: Craft</h3><div class="text-muted small"><p> Recon and Scans NMAP Here is the output from Nmap, it shows several ports open. {% highlight plain_text %} nmap -n -Pn -sC -sV -p- 10.10.10.110 Starting Nmap 7.80 ( https://nmap.org ) at 2019-...</p></div></div></a></div><div class="card"> <a href="/posts/hackthebox-jarvis/"><div class="card-body"> <em class="timeago small" data-ts="1566223496" > 2019-08-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox: Jarvis</h3><div class="text-muted small"><p> Recon: The website isn’t bare, but most of the links found don’t actually go anywhere. The only page with anything really going on is ‘Rooms’, where you’ll find the links to the rooms are PHP re...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/hackthebox-jarvis/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox: Jarvis</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/megawattsec">Dustin</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/mysql/">mysql</a> <a class="post-tag" href="/tags/perl/">perl</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/anti-csrf/">anti-csrf</a> <a class="post-tag" href="/tags/api/">api</a> <a class="post-tag" href="/tags/cve-2019-9185/">CVE-2019-9185</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
